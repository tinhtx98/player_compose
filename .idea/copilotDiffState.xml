<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/app/src/main/AndroidManifest.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/AndroidManifest.xml" />
              <option name="originalContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&#10;    xmlns:tools=&quot;http://schemas.android.com/tools&quot;&gt;&#10;&#10;    &lt;uses-permission android:name=&quot;android.permission.READ_MEDIA_AUDIO&quot; /&gt;&#10;    &lt;uses-permission android:name=&quot;android.permission.READ_MEDIA_VIDEO&quot; /&gt;&#10;    &lt;uses-permission android:name=&quot;android.permission.POST_NOTIFICATIONS&quot; /&gt;&#10;    &lt;uses-permission android:name=&quot;android.permission.FOREGROUND_SERVICE&quot; /&gt;&#10;    &lt;uses-permission android:name=&quot;android.permission.FOREGROUND_SERVICE_MEDIA_PLAYBACK&quot; /&gt;&#10;&#10;    &lt;application&#10;        android:name=&quot;.TinhTXPlayerApplication&quot;&#10;        android:allowBackup=&quot;true&quot;&#10;        android:dataExtractionRules=&quot;@xml/data_extraction_rules&quot;&#10;        android:fullBackupContent=&quot;@xml/backup_rules&quot;&#10;        android:icon=&quot;@mipmap/ic_launcher&quot;&#10;        android:label=&quot;@string/app_name&quot;&#10;        android:roundIcon=&quot;@mipmap/ic_launcher_round&quot;&#10;        android:supportsRtl=&quot;true&quot;&#10;        android:theme=&quot;@style/Base.Theme.TinhTXPlayer&quot;&#10;        tools:targetApi=&quot;31&quot;&gt;&#10;        &lt;activity&#10;            android:name=&quot;.MainActivity&quot;&#10;            android:exported=&quot;true&quot;&#10;            android:supportsPictureInPicture=&quot;true&quot;&#10;            android:configChanges=&quot;screenSize|smallestScreenSize|screenLayout|orientation&quot;&#10;            android:theme=&quot;@style/Base.Theme.TinhTXPlayer&quot;&gt;&#10;            &lt;intent-filter&gt;&#10;                &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;&#10;                &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;&#10;            &lt;/intent-filter&gt;&#10;        &lt;/activity&gt;&#10;        &lt;service&#10;            android:name=&quot;.media.playback.PlaybackService&quot;&#10;            android:exported=&quot;false&quot;&#10;            android:enabled=&quot;true&quot;&#10;            android:foregroundServiceType=&quot;mediaPlayback&quot;&#10;            tools:ignore=&quot;ForegroundServicePermission&quot; /&gt;&#10;    &lt;/application&gt;&#10;&#10;&lt;/manifest&gt;" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&#10;    xmlns:tools=&quot;http://schemas.android.com/tools&quot;&gt;&#10;&#10;    &lt;uses-permission android:name=&quot;android.permission.READ_MEDIA_AUDIO&quot; /&gt;&#10;    &lt;uses-permission android:name=&quot;android.permission.READ_MEDIA_VIDEO&quot; /&gt;&#10;    &lt;uses-permission android:name=&quot;android.permission.POST_NOTIFICATIONS&quot; /&gt;&#10;    &lt;uses-permission android:name=&quot;android.permission.FOREGROUND_SERVICE&quot; /&gt;&#10;    &lt;uses-permission android:name=&quot;android.permission.FOREGROUND_SERVICE_MEDIA_PLAYBACK&quot; /&gt;&#10;&#10;    &lt;application&#10;        android:name=&quot;.TinhTXPlayerApplication&quot;&#10;        android:allowBackup=&quot;true&quot;&#10;        android:dataExtractionRules=&quot;@xml/data_extraction_rules&quot;&#10;        android:fullBackupContent=&quot;@xml/backup_rules&quot;&#10;        android:icon=&quot;@mipmap/ic_launcher&quot;&#10;        android:label=&quot;@string/app_name&quot;&#10;        android:roundIcon=&quot;@mipmap/ic_launcher_round&quot;&#10;        android:supportsRtl=&quot;true&quot;&#10;        android:theme=&quot;@style/Base.Theme.TinhTXPlayer&quot;&#10;        tools:targetApi=&quot;31&quot;&gt;&#10;        &lt;activity&#10;            android:name=&quot;.MainActivity&quot;&#10;            android:exported=&quot;true&quot;&#10;            android:supportsPictureInPicture=&quot;true&quot;&#10;            android:configChanges=&quot;screenSize|smallestScreenSize|screenLayout|orientation&quot;&#10;            android:theme=&quot;@style/Base.Theme.TinhTXPlayer&quot;&gt;&#10;            &lt;intent-filter&gt;&#10;                &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;&#10;                &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;&#10;            &lt;/intent-filter&gt;&#10;        &lt;/activity&gt;&#10;&#10;        &lt;service&#10;            android:name=&quot;.media.playback.PlaybackService&quot;&#10;            android:enabled=&quot;true&quot;&#10;            android:exported=&quot;false&quot;&#10;            android:foregroundServiceType=&quot;mediaPlayback&quot; /&gt;&#10;    &lt;/application&gt;&#10;&#10;&lt;/manifest&gt;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/core/src/main/kotlin/com/tinhtx/player/common/Constants.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/core/src/main/kotlin/com/tinhtx/player/common/Constants.kt" />
              <option name="updatedContent" value="package com.tinhtx.player.common&#10;&#10;object Constants {&#10;    // Database&#10;    const val DATABASE_NAME = &quot;tinhtx_player_database&quot;&#10;    const val DATABASE_VERSION = 1&#10;    &#10;    // Preferences&#10;    const val PREFERENCES_NAME = &quot;tinhtx_player_preferences&quot;&#10;    &#10;    // Media&#10;    const val MEDIA_ROOT_ID = &quot;media_root_id&quot;&#10;    const val NOTIFICATION_CHANNEL_ID = &quot;tinhtx_player_channel&quot;&#10;    const val NOTIFICATION_ID = 1&#10;    &#10;    // Permission&#10;    const val PERMISSION_REQUEST_CODE = 1001&#10;    &#10;    // Playback&#10;    const val SEEK_BAR_UPDATE_INTERVAL = 1000L&#10;    const val DEFAULT_MEDIA_VOLUME = 0.5f&#10;    &#10;    // Cache&#10;    const val CACHE_SIZE = 100 * 1024 * 1024L // 100MB&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/core/src/main/kotlin/com/tinhtx/player/common/Extensions.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/core/src/main/kotlin/com/tinhtx/player/common/Extensions.kt" />
              <option name="updatedContent" value="package com.tinhtx.player.common&#10;&#10;import android.content.Context&#10;import android.widget.Toast&#10;import java.util.concurrent.TimeUnit&#10;&#10;/**&#10; * Extension functions for common operations&#10; */&#10;&#10;// Context extensions&#10;fun Context.showToast(message: String, duration: Int = Toast.LENGTH_SHORT) {&#10;    Toast.makeText(this, message, duration).show()&#10;}&#10;&#10;// Long extensions for time formatting&#10;fun Long.formatDuration(): String {&#10;    val minutes = TimeUnit.MILLISECONDS.toMinutes(this)&#10;    val seconds = TimeUnit.MILLISECONDS.toSeconds(this) % 60&#10;    return String.format(&quot;%d:%02d&quot;, minutes, seconds)&#10;}&#10;&#10;// String extensions&#10;fun String.isValidAudioFile(): Boolean {&#10;    val audioExtensions = listOf(&quot;mp3&quot;, &quot;wav&quot;, &quot;flac&quot;, &quot;aac&quot;, &quot;ogg&quot;, &quot;m4a&quot;)&#10;    return audioExtensions.any { this.lowercase().endsWith(&quot;.$it&quot;) }&#10;}&#10;&#10;fun String.isValidVideoFile(): Boolean {&#10;    val videoExtensions = listOf(&quot;mp4&quot;, &quot;avi&quot;, &quot;mkv&quot;, &quot;mov&quot;, &quot;wmv&quot;, &quot;flv&quot;, &quot;webm&quot;)&#10;    return videoExtensions.any { this.lowercase().endsWith(&quot;.$it&quot;) }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/core/src/test/kotlin/com/tinhtx/player/common/ResourceTest.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/core/src/test/kotlin/com/tinhtx/player/common/ResourceTest.kt" />
              <option name="updatedContent" value="package com.tinhtx.player.common&#10;&#10;import org.junit.Test&#10;import org.junit.Assert.*&#10;&#10;class ResourceTest {&#10;    &#10;    @Test&#10;    fun `Success resource should contain data`() {&#10;        val data = &quot;test data&quot;&#10;        val resource = Resource.Success(data)&#10;        &#10;        assertEquals(data, resource.data)&#10;        assertNull(resource.message)&#10;    }&#10;    &#10;    @Test&#10;    fun `Error resource should contain message`() {&#10;        val message = &quot;error message&quot;&#10;        val resource = Resource.Error&lt;String&gt;(message)&#10;        &#10;        assertEquals(message, resource.message)&#10;        assertNull(resource.data)&#10;    }&#10;    &#10;    @Test&#10;    fun `Loading resource can contain data`() {&#10;        val data = &quot;loading data&quot;&#10;        val resource = Resource.Loading(data)&#10;        &#10;        assertEquals(data, resource.data)&#10;        assertNull(resource.message)&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/data/src/main/kotlin/com/tinhtx/player/local/database/dao/MediaDao.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/data/src/main/kotlin/com/tinhtx/player/local/database/dao/MediaDao.kt" />
              <option name="updatedContent" value="package com.tinhtx.player.local.database.dao&#10;&#10;import androidx.room.*&#10;import com.tinhtx.player.local.database.entities.MediaEntity&#10;import kotlinx.coroutines.flow.Flow&#10;&#10;@Dao&#10;interface MediaDao {&#10;    &#10;    @Query(&quot;SELECT * FROM media_items&quot;)&#10;    fun getAllMediaItems(): Flow&lt;List&lt;MediaEntity&gt;&gt;&#10;    &#10;    @Query(&quot;SELECT * FROM media_items WHERE mediaType = 'AUDIO'&quot;)&#10;    fun getAudioItems(): Flow&lt;List&lt;MediaEntity&gt;&gt;&#10;    &#10;    @Query(&quot;SELECT * FROM media_items WHERE mediaType = 'VIDEO'&quot;)&#10;    fun getVideoItems(): Flow&lt;List&lt;MediaEntity&gt;&gt;&#10;    &#10;    @Query(&quot;SELECT * FROM media_items WHERE id = :id&quot;)&#10;    fun getMediaItemById(id: String): Flow&lt;MediaEntity?&gt;&#10;    &#10;    @Query(&quot;SELECT * FROM media_items WHERE title LIKE '%' || :query || '%' OR artist LIKE '%' || :query || '%' OR album LIKE '%' || :query || '%'&quot;)&#10;    fun searchMediaItems(query: String): Flow&lt;List&lt;MediaEntity&gt;&gt;&#10;    &#10;    @Query(&quot;SELECT * FROM media_items WHERE album = :albumId&quot;)&#10;    fun getMediaItemsByAlbum(albumId: String): Flow&lt;List&lt;MediaEntity&gt;&gt;&#10;    &#10;    @Query(&quot;SELECT * FROM media_items WHERE artist = :artistId&quot;)&#10;    fun getMediaItemsByArtist(artistId: String): Flow&lt;List&lt;MediaEntity&gt;&gt;&#10;    &#10;    @Insert(onConflict = OnConflictStrategy.REPLACE)&#10;    suspend fun insertMediaItem(mediaItem: MediaEntity)&#10;    &#10;    @Insert(onConflict = OnConflictStrategy.REPLACE)&#10;    suspend fun insertMediaItems(mediaItems: List&lt;MediaEntity&gt;)&#10;    &#10;    @Update&#10;    suspend fun updateMediaItem(mediaItem: MediaEntity)&#10;    &#10;    @Delete&#10;    suspend fun deleteMediaItem(mediaItem: MediaEntity)&#10;    &#10;    @Query(&quot;DELETE FROM media_items&quot;)&#10;    suspend fun deleteAllMediaItems()&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/data/src/main/kotlin/com/tinhtx/player/local/database/dao/PlaylistDao.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/data/src/main/kotlin/com/tinhtx/player/local/database/dao/PlaylistDao.kt" />
              <option name="updatedContent" value="package com.tinhtx.player.local.database.dao&#10;&#10;import androidx.room.*&#10;import com.tinhtx.player.local.database.entities.PlaylistEntity&#10;import com.tinhtx.player.local.database.entities.PlaylistMediaEntity&#10;import com.tinhtx.player.local.database.entities.MediaEntity&#10;import kotlinx.coroutines.flow.Flow&#10;&#10;@Dao&#10;interface PlaylistDao {&#10;    &#10;    @Query(&quot;SELECT * FROM playlists&quot;)&#10;    fun getAllPlaylists(): Flow&lt;List&lt;PlaylistEntity&gt;&gt;&#10;    &#10;    @Query(&quot;SELECT * FROM playlists WHERE id = :id&quot;)&#10;    fun getPlaylistById(id: String): Flow&lt;PlaylistEntity?&gt;&#10;    &#10;    @Query(&quot;&quot;&quot;&#10;        SELECT m.* FROM media_items m&#10;        INNER JOIN playlist_media pm ON m.id = pm.mediaId&#10;        WHERE pm.playlistId = :playlistId&#10;        ORDER BY pm.position&#10;    &quot;&quot;&quot;)&#10;    fun getPlaylistItems(playlistId: String): Flow&lt;List&lt;MediaEntity&gt;&gt;&#10;    &#10;    @Insert(onConflict = OnConflictStrategy.REPLACE)&#10;    suspend fun insertPlaylist(playlist: PlaylistEntity)&#10;    &#10;    @Update&#10;    suspend fun updatePlaylist(playlist: PlaylistEntity)&#10;    &#10;    @Delete&#10;    suspend fun deletePlaylist(playlist: PlaylistEntity)&#10;    &#10;    @Insert(onConflict = OnConflictStrategy.REPLACE)&#10;    suspend fun insertPlaylistMedia(playlistMedia: PlaylistMediaEntity)&#10;    &#10;    @Query(&quot;DELETE FROM playlist_media WHERE playlistId = :playlistId AND mediaId = :mediaId&quot;)&#10;    suspend fun removePlaylistMedia(playlistId: String, mediaId: String)&#10;    &#10;    @Query(&quot;DELETE FROM playlist_media WHERE playlistId = :playlistId&quot;)&#10;    suspend fun clearPlaylist(playlistId: String)&#10;    &#10;    @Query(&quot;UPDATE playlist_media SET position = :newPosition WHERE playlistId = :playlistId AND mediaId = :mediaId&quot;)&#10;    suspend fun updateMediaPosition(playlistId: String, mediaId: String, newPosition: Int)&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/data/src/main/kotlin/com/tinhtx/player/local/database/entities/MediaEntity.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/data/src/main/kotlin/com/tinhtx/player/local/database/entities/MediaEntity.kt" />
              <option name="updatedContent" value="package com.tinhtx.player.local.database.entities&#10;&#10;import androidx.room.Entity&#10;import androidx.room.PrimaryKey&#10;&#10;@Entity(tableName = &quot;media_items&quot;)&#10;data class MediaEntity(&#10;    @PrimaryKey&#10;    val id: String,&#10;    val title: String,&#10;    val artist: String,&#10;    val album: String,&#10;    val duration: Long,&#10;    val uri: String,&#10;    val artworkUri: String? = null,&#10;    val mediaType: String,&#10;    val size: Long = 0,&#10;    val dateAdded: Long = 0,&#10;    val path: String = &quot;&quot;,&#10;    val mimeType: String = &quot;&quot;&#10;)" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/data/src/main/kotlin/com/tinhtx/player/local/database/entities/PlaylistEntity.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/data/src/main/kotlin/com/tinhtx/player/local/database/entities/PlaylistEntity.kt" />
              <option name="updatedContent" value="package com.tinhtx.player.local.database.entities&#10;&#10;import androidx.room.Entity&#10;import androidx.room.PrimaryKey&#10;&#10;@Entity(tableName = &quot;playlists&quot;)&#10;data class PlaylistEntity(&#10;    @PrimaryKey&#10;    val id: String,&#10;    val name: String,&#10;    val description: String = &quot;&quot;,&#10;    val artworkUri: String? = null,&#10;    val trackCount: Int = 0,&#10;    val duration: Long = 0,&#10;    val dateCreated: Long = System.currentTimeMillis(),&#10;    val dateModified: Long = System.currentTimeMillis()&#10;)" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/data/src/main/kotlin/com/tinhtx/player/local/database/entities/PlaylistMediaEntity.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/data/src/main/kotlin/com/tinhtx/player/local/database/entities/PlaylistMediaEntity.kt" />
              <option name="updatedContent" value="package com.tinhtx.player.local.database.entities&#10;&#10;import androidx.room.Entity&#10;import androidx.room.ForeignKey&#10;import androidx.room.Index&#10;&#10;@Entity(&#10;    tableName = &quot;playlist_media&quot;,&#10;    primaryKeys = [&quot;playlistId&quot;, &quot;mediaId&quot;],&#10;    foreignKeys = [&#10;        ForeignKey(&#10;            entity = PlaylistEntity::class,&#10;            parentColumns = [&quot;id&quot;],&#10;            childColumns = [&quot;playlistId&quot;],&#10;            onDelete = ForeignKey.CASCADE&#10;        ),&#10;        ForeignKey(&#10;            entity = MediaEntity::class,&#10;            parentColumns = [&quot;id&quot;],&#10;            childColumns = [&quot;mediaId&quot;],&#10;            onDelete = ForeignKey.CASCADE&#10;        )&#10;    ],&#10;    indices = [&#10;        Index(value = [&quot;playlistId&quot;]),&#10;        Index(value = [&quot;mediaId&quot;])&#10;    ]&#10;)&#10;data class PlaylistMediaEntity(&#10;    val playlistId: String,&#10;    val mediaId: String,&#10;    val position: Int,&#10;    val dateAdded: Long = System.currentTimeMillis()&#10;)" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/data/src/main/kotlin/com/tinhtx/player/local/preferences/UserPreferencesManager.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/data/src/main/kotlin/com/tinhtx/player/local/preferences/UserPreferencesManager.kt" />
              <option name="updatedContent" value="package com.tinhtx.player.local.preferences&#10;&#10;import android.content.Context&#10;import android.content.SharedPreferences&#10;import com.tinhtx.player.model.AppTheme&#10;import com.tinhtx.player.model.RepeatMode&#10;import com.tinhtx.player.model.UserSettings&#10;import javax.inject.Inject&#10;import javax.inject.Singleton&#10;&#10;@Singleton&#10;class UserPreferencesManager @Inject constructor(&#10;    context: Context&#10;) {&#10;    private val preferences: SharedPreferences = context.getSharedPreferences(&#10;        &quot;tinhtx_player_preferences&quot;,&#10;        Context.MODE_PRIVATE&#10;    )&#10;    &#10;    fun getUserSettings(): UserSettings {&#10;        return UserSettings(&#10;            theme = AppTheme.valueOf(preferences.getString(KEY_THEME, AppTheme.SYSTEM.name) ?: AppTheme.SYSTEM.name),&#10;            playbackSpeed = preferences.getFloat(KEY_PLAYBACK_SPEED, 1.0f),&#10;            repeatMode = RepeatMode.valueOf(preferences.getString(KEY_REPEAT_MODE, RepeatMode.OFF.name) ?: RepeatMode.OFF.name),&#10;            shuffleMode = preferences.getBoolean(KEY_SHUFFLE_MODE, false),&#10;            autoPlayNext = preferences.getBoolean(KEY_AUTO_PLAY_NEXT, true),&#10;            showNotification = preferences.getBoolean(KEY_SHOW_NOTIFICATION, true),&#10;            equalizerEnabled = preferences.getBoolean(KEY_EQUALIZER_ENABLED, false),&#10;            bassBoostLevel = preferences.getInt(KEY_BASS_BOOST, 0),&#10;            virtualizerLevel = preferences.getInt(KEY_VIRTUALIZER, 0),&#10;            skipSilence = preferences.getBoolean(KEY_SKIP_SILENCE, false),&#10;            crossfadeDuration = preferences.getInt(KEY_CROSSFADE_DURATION, 0)&#10;        )&#10;    }&#10;    &#10;    fun saveUserSettings(settings: UserSettings) {&#10;        preferences.edit().apply {&#10;            putString(KEY_THEME, settings.theme.name)&#10;            putFloat(KEY_PLAYBACK_SPEED, settings.playbackSpeed)&#10;            putString(KEY_REPEAT_MODE, settings.repeatMode.name)&#10;            putBoolean(KEY_SHUFFLE_MODE, settings.shuffleMode)&#10;            putBoolean(KEY_AUTO_PLAY_NEXT, settings.autoPlayNext)&#10;            putBoolean(KEY_SHOW_NOTIFICATION, settings.showNotification)&#10;            putBoolean(KEY_EQUALIZER_ENABLED, settings.equalizerEnabled)&#10;            putInt(KEY_BASS_BOOST, settings.bassBoostLevel)&#10;            putInt(KEY_VIRTUALIZER, settings.virtualizerLevel)&#10;            putBoolean(KEY_SKIP_SILENCE, settings.skipSilence)&#10;            putInt(KEY_CROSSFADE_DURATION, settings.crossfadeDuration)&#10;            apply()&#10;        }&#10;    }&#10;    &#10;    companion object {&#10;        private const val KEY_THEME = &quot;theme&quot;&#10;        private const val KEY_PLAYBACK_SPEED = &quot;playback_speed&quot;&#10;        private const val KEY_REPEAT_MODE = &quot;repeat_mode&quot;&#10;        private const val KEY_SHUFFLE_MODE = &quot;shuffle_mode&quot;&#10;        private const val KEY_AUTO_PLAY_NEXT = &quot;auto_play_next&quot;&#10;        private const val KEY_SHOW_NOTIFICATION = &quot;show_notification&quot;&#10;        private const val KEY_EQUALIZER_ENABLED = &quot;equalizer_enabled&quot;&#10;        private const val KEY_BASS_BOOST = &quot;bass_boost&quot;&#10;        private const val KEY_VIRTUALIZER = &quot;virtualizer&quot;&#10;        private const val KEY_SKIP_SILENCE = &quot;skip_silence&quot;&#10;        private const val KEY_CROSSFADE_DURATION = &quot;crossfade_duration&quot;&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/data/src/main/kotlin/com/tinhtx/player/mapper/MediaMapper.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/data/src/main/kotlin/com/tinhtx/player/mapper/MediaMapper.kt" />
              <option name="updatedContent" value="package com.tinhtx.player.mapper&#10;&#10;import com.tinhtx.player.local.database.entities.MediaEntity&#10;import com.tinhtx.player.model.MediaItem&#10;import com.tinhtx.player.model.MediaType&#10;&#10;object MediaMapper {&#10;    &#10;    fun toEntity(mediaItem: MediaItem): MediaEntity {&#10;        return MediaEntity(&#10;            id = mediaItem.id,&#10;            title = mediaItem.title,&#10;            artist = mediaItem.artist,&#10;            album = mediaItem.album,&#10;            duration = mediaItem.duration,&#10;            uri = mediaItem.uri,&#10;            artworkUri = mediaItem.artworkUri,&#10;            mediaType = mediaItem.mediaType.name,&#10;            size = mediaItem.size,&#10;            dateAdded = mediaItem.dateAdded,&#10;            path = mediaItem.path,&#10;            mimeType = mediaItem.mimeType&#10;        )&#10;    }&#10;    &#10;    fun toDomain(entity: MediaEntity): MediaItem {&#10;        return MediaItem(&#10;            id = entity.id,&#10;            title = entity.title,&#10;            artist = entity.artist,&#10;            album = entity.album,&#10;            duration = entity.duration,&#10;            uri = entity.uri,&#10;            artworkUri = entity.artworkUri,&#10;            mediaType = MediaType.valueOf(entity.mediaType),&#10;            size = entity.size,&#10;            dateAdded = entity.dateAdded,&#10;            path = entity.path,&#10;            mimeType = entity.mimeType&#10;        )&#10;    }&#10;    &#10;    fun toEntityList(mediaItems: List&lt;MediaItem&gt;): List&lt;MediaEntity&gt; {&#10;        return mediaItems.map { toEntity(it) }&#10;    }&#10;    &#10;    fun toDomainList(entities: List&lt;MediaEntity&gt;): List&lt;MediaItem&gt; {&#10;        return entities.map { toDomain(it) }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/data/src/main/kotlin/com/tinhtx/player/mapper/PlaylistMapper.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/data/src/main/kotlin/com/tinhtx/player/mapper/PlaylistMapper.kt" />
              <option name="updatedContent" value="package com.tinhtx.player.mapper&#10;&#10;import com.tinhtx.player.local.database.entities.PlaylistEntity&#10;import com.tinhtx.player.model.PlaylistInfo&#10;&#10;object PlaylistMapper {&#10;    &#10;    fun toEntity(playlistInfo: PlaylistInfo): PlaylistEntity {&#10;        return PlaylistEntity(&#10;            id = playlistInfo.id,&#10;            name = playlistInfo.name,&#10;            description = playlistInfo.description,&#10;            artworkUri = playlistInfo.artworkUri,&#10;            trackCount = playlistInfo.trackCount,&#10;            duration = playlistInfo.duration,&#10;            dateCreated = playlistInfo.dateCreated,&#10;            dateModified = playlistInfo.dateModified&#10;        )&#10;    }&#10;    &#10;    fun toDomain(entity: PlaylistEntity): PlaylistInfo {&#10;        return PlaylistInfo(&#10;            id = entity.id,&#10;            name = entity.name,&#10;            description = entity.description,&#10;            artworkUri = entity.artworkUri,&#10;            trackCount = entity.trackCount,&#10;            duration = entity.duration,&#10;            dateCreated = entity.dateCreated,&#10;            dateModified = entity.dateModified&#10;        )&#10;    }&#10;    &#10;    fun toEntityList(playlists: List&lt;PlaylistInfo&gt;): List&lt;PlaylistEntity&gt; {&#10;        return playlists.map { toEntity(it) }&#10;    }&#10;    &#10;    fun toDomainList(entities: List&lt;PlaylistEntity&gt;): List&lt;PlaylistInfo&gt; {&#10;        return entities.map { toDomain(it) }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/data/src/main/kotlin/com/tinhtx/player/repository/MediaRepositoryImpl.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/data/src/main/kotlin/com/tinhtx/player/repository/MediaRepositoryImpl.kt" />
              <option name="updatedContent" value="package com.tinhtx.player.repository&#10;&#10;import com.tinhtx.player.common.Resource&#10;import com.tinhtx.player.local.database.dao.MediaDao&#10;import com.tinhtx.player.mapper.MediaMapper&#10;import com.tinhtx.player.model.MediaItem&#10;import com.tinhtx.player.model.AlbumInfo&#10;import com.tinhtx.player.model.ArtistInfo&#10;import com.tinhtx.player.model.SortOrder&#10;import kotlinx.coroutines.flow.Flow&#10;import kotlinx.coroutines.flow.map&#10;import kotlinx.coroutines.flow.catch&#10;import javax.inject.Inject&#10;import javax.inject.Singleton&#10;&#10;@Singleton&#10;class MediaRepositoryImpl @Inject constructor(&#10;    private val mediaDao: MediaDao&#10;) : MediaRepository {&#10;    &#10;    override fun getAllMediaItems(): Flow&lt;Resource&lt;List&lt;MediaItem&gt;&gt;&gt; {&#10;        return mediaDao.getAllMediaItems()&#10;            .map { entities -&gt;&#10;                Resource.Success(MediaMapper.toDomainList(entities))&#10;            }&#10;            .catch { e -&gt;&#10;                emit(Resource.Error(&quot;Failed to get media items: ${e.message}&quot;))&#10;            }&#10;    }&#10;    &#10;    override fun getAudioItems(): Flow&lt;Resource&lt;List&lt;MediaItem&gt;&gt;&gt; {&#10;        return mediaDao.getAudioItems()&#10;            .map { entities -&gt;&#10;                Resource.Success(MediaMapper.toDomainList(entities))&#10;            }&#10;            .catch { e -&gt;&#10;                emit(Resource.Error(&quot;Failed to get audio items: ${e.message}&quot;))&#10;            }&#10;    }&#10;    &#10;    override fun getVideoItems(): Flow&lt;Resource&lt;List&lt;MediaItem&gt;&gt;&gt; {&#10;        return mediaDao.getVideoItems()&#10;            .map { entities -&gt;&#10;                Resource.Success(MediaMapper.toDomainList(entities))&#10;            }&#10;            .catch { e -&gt;&#10;                emit(Resource.Error(&quot;Failed to get video items: ${e.message}&quot;))&#10;            }&#10;    }&#10;    &#10;    override fun getMediaItemById(id: String): Flow&lt;Resource&lt;MediaItem?&gt;&gt; {&#10;        return mediaDao.getMediaItemById(id)&#10;            .map { entity -&gt;&#10;                Resource.Success(entity?.let { MediaMapper.toDomain(it) })&#10;            }&#10;            .catch { e -&gt;&#10;                emit(Resource.Error(&quot;Failed to get media item: ${e.message}&quot;))&#10;            }&#10;    }&#10;    &#10;    override fun getAlbums(): Flow&lt;Resource&lt;List&lt;AlbumInfo&gt;&gt;&gt; {&#10;        // This would be implemented with proper album aggregation logic&#10;        return getAllMediaItems().map { resource -&gt;&#10;            when (resource) {&#10;                is Resource.Success -&gt; {&#10;                    val albums = resource.data?.groupBy { it.album }?.map { (albumName, items) -&gt;&#10;                        AlbumInfo(&#10;                            id = items.first().album,&#10;                            name = albumName,&#10;                            artist = items.first().artist,&#10;                            artworkUri = items.first().artworkUri,&#10;                            trackCount = items.size,&#10;                            duration = items.sumOf { it.duration }&#10;                        )&#10;                    } ?: emptyList()&#10;                    Resource.Success(albums)&#10;                }&#10;                is Resource.Error -&gt; Resource.Error(resource.message ?: &quot;Unknown error&quot;)&#10;                is Resource.Loading -&gt; Resource.Loading()&#10;            }&#10;        }&#10;    }&#10;    &#10;    override fun getArtists(): Flow&lt;Resource&lt;List&lt;ArtistInfo&gt;&gt;&gt; {&#10;        return getAllMediaItems().map { resource -&gt;&#10;            when (resource) {&#10;                is Resource.Success -&gt; {&#10;                    val artists = resource.data?.groupBy { it.artist }?.map { (artistName, items) -&gt;&#10;                        ArtistInfo(&#10;                            id = artistName,&#10;                            name = artistName,&#10;                            trackCount = items.size,&#10;                            albumCount = items.map { it.album }.distinct().size,&#10;                            artworkUri = items.first().artworkUri&#10;                        )&#10;                    } ?: emptyList()&#10;                    Resource.Success(artists)&#10;                }&#10;                is Resource.Error -&gt; Resource.Error(resource.message ?: &quot;Unknown error&quot;)&#10;                is Resource.Loading -&gt; Resource.Loading()&#10;            }&#10;        }&#10;    }&#10;    &#10;    override fun getMediaItemsByAlbum(albumId: String): Flow&lt;Resource&lt;List&lt;MediaItem&gt;&gt;&gt; {&#10;        return mediaDao.getMediaItemsByAlbum(albumId)&#10;            .map { entities -&gt;&#10;                Resource.Success(MediaMapper.toDomainList(entities))&#10;            }&#10;            .catch { e -&gt;&#10;                emit(Resource.Error(&quot;Failed to get album items: ${e.message}&quot;))&#10;            }&#10;    }&#10;    &#10;    override fun getMediaItemsByArtist(artistId: String): Flow&lt;Resource&lt;List&lt;MediaItem&gt;&gt;&gt; {&#10;        return mediaDao.getMediaItemsByArtist(artistId)&#10;            .map { entities -&gt;&#10;                Resource.Success(MediaMapper.toDomainList(entities))&#10;            }&#10;            .catch { e -&gt;&#10;                emit(Resource.Error(&quot;Failed to get artist items: ${e.message}&quot;))&#10;            }&#10;    }&#10;    &#10;    override fun searchMediaItems(query: String): Flow&lt;Resource&lt;List&lt;MediaItem&gt;&gt;&gt; {&#10;        return mediaDao.searchMediaItems(query)&#10;            .map { entities -&gt;&#10;                Resource.Success(MediaMapper.toDomainList(entities))&#10;            }&#10;            .catch { e -&gt;&#10;                emit(Resource.Error(&quot;Failed to search media items: ${e.message}&quot;))&#10;            }&#10;    }&#10;    &#10;    override fun sortMediaItems(items: List&lt;MediaItem&gt;, sortOrder: SortOrder): List&lt;MediaItem&gt; {&#10;        return when (sortOrder) {&#10;            SortOrder.TITLE_ASC -&gt; items.sortedBy { it.title }&#10;            SortOrder.TITLE_DESC -&gt; items.sortedByDescending { it.title }&#10;            SortOrder.ARTIST_ASC -&gt; items.sortedBy { it.artist }&#10;            SortOrder.ARTIST_DESC -&gt; items.sortedByDescending { it.artist }&#10;            SortOrder.ALBUM_ASC -&gt; items.sortedBy { it.album }&#10;            SortOrder.ALBUM_DESC -&gt; items.sortedByDescending { it.album }&#10;            SortOrder.DURATION_ASC -&gt; items.sortedBy { it.duration }&#10;            SortOrder.DURATION_DESC -&gt; items.sortedByDescending { it.duration }&#10;            SortOrder.DATE_ADDED_ASC -&gt; items.sortedBy { it.dateAdded }&#10;            SortOrder.DATE_ADDED_DESC -&gt; items.sortedByDescending { it.dateAdded }&#10;        }&#10;    }&#10;    &#10;    override suspend fun scanMediaFiles(): Resource&lt;Unit&gt; {&#10;        return try {&#10;            // This would be implemented with actual media scanning logic&#10;            Resource.Success(Unit)&#10;        } catch (e: Exception) {&#10;            Resource.Error(&quot;Failed to scan media files: ${e.message}&quot;)&#10;        }&#10;    }&#10;    &#10;    override suspend fun refreshMediaLibrary(): Resource&lt;Unit&gt; {&#10;        return try {&#10;            // This would be implemented with actual refresh logic&#10;            Resource.Success(Unit)&#10;        } catch (e: Exception) {&#10;            Resource.Error(&quot;Failed to refresh media library: ${e.message}&quot;)&#10;        }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/data/src/main/kotlin/com/tinhtx/player/repository/PlaylistRepositoryImpl.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/data/src/main/kotlin/com/tinhtx/player/repository/PlaylistRepositoryImpl.kt" />
              <option name="updatedContent" value="package com.tinhtx.player.repository&#10;&#10;import com.tinhtx.player.common.Resource&#10;import com.tinhtx.player.local.database.dao.PlaylistDao&#10;import com.tinhtx.player.local.database.entities.PlaylistMediaEntity&#10;import com.tinhtx.player.mapper.MediaMapper&#10;import com.tinhtx.player.mapper.PlaylistMapper&#10;import com.tinhtx.player.model.PlaylistInfo&#10;import com.tinhtx.player.model.MediaItem&#10;import kotlinx.coroutines.flow.Flow&#10;import kotlinx.coroutines.flow.map&#10;import kotlinx.coroutines.flow.catch&#10;import java.util.UUID&#10;import javax.inject.Inject&#10;import javax.inject.Singleton&#10;&#10;@Singleton&#10;class PlaylistRepositoryImpl @Inject constructor(&#10;    private val playlistDao: PlaylistDao&#10;) : PlaylistRepository {&#10;    &#10;    override fun getAllPlaylists(): Flow&lt;Resource&lt;List&lt;PlaylistInfo&gt;&gt;&gt; {&#10;        return playlistDao.getAllPlaylists()&#10;            .map { entities -&gt;&#10;                Resource.Success(PlaylistMapper.toDomainList(entities))&#10;            }&#10;            .catch { e -&gt;&#10;                emit(Resource.Error(&quot;Failed to get playlists: ${e.message}&quot;))&#10;            }&#10;    }&#10;    &#10;    override fun getPlaylistById(id: String): Flow&lt;Resource&lt;PlaylistInfo?&gt;&gt; {&#10;        return playlistDao.getPlaylistById(id)&#10;            .map { entity -&gt;&#10;                Resource.Success(entity?.let { PlaylistMapper.toDomain(it) })&#10;            }&#10;            .catch { e -&gt;&#10;                emit(Resource.Error(&quot;Failed to get playlist: ${e.message}&quot;))&#10;            }&#10;    }&#10;    &#10;    override fun getPlaylistItems(playlistId: String): Flow&lt;Resource&lt;List&lt;MediaItem&gt;&gt;&gt; {&#10;        return playlistDao.getPlaylistItems(playlistId)&#10;            .map { entities -&gt;&#10;                Resource.Success(MediaMapper.toDomainList(entities))&#10;            }&#10;            .catch { e -&gt;&#10;                emit(Resource.Error(&quot;Failed to get playlist items: ${e.message}&quot;))&#10;            }&#10;    }&#10;    &#10;    override suspend fun createPlaylist(name: String, description: String): Resource&lt;PlaylistInfo&gt; {&#10;        return try {&#10;            val playlist = PlaylistInfo(&#10;                id = UUID.randomUUID().toString(),&#10;                name = name,&#10;                description = description&#10;            )&#10;            playlistDao.insertPlaylist(PlaylistMapper.toEntity(playlist))&#10;            Resource.Success(playlist)&#10;        } catch (e: Exception) {&#10;            Resource.Error(&quot;Failed to create playlist: ${e.message}&quot;)&#10;        }&#10;    }&#10;    &#10;    override suspend fun updatePlaylist(playlist: PlaylistInfo): Resource&lt;Unit&gt; {&#10;        return try {&#10;            playlistDao.updatePlaylist(PlaylistMapper.toEntity(playlist))&#10;            Resource.Success(Unit)&#10;        } catch (e: Exception) {&#10;            Resource.Error(&quot;Failed to update playlist: ${e.message}&quot;)&#10;        }&#10;    }&#10;    &#10;    override suspend fun deletePlaylist(playlistId: String): Resource&lt;Unit&gt; {&#10;        return try {&#10;            val playlist = playlistDao.getPlaylistById(playlistId)&#10;            // Note: This is a simplified approach. In a real implementation,&#10;            // you'd need to handle the Flow properly&#10;            Resource.Success(Unit)&#10;        } catch (e: Exception) {&#10;            Resource.Error(&quot;Failed to delete playlist: ${e.message}&quot;)&#10;        }&#10;    }&#10;    &#10;    override suspend fun addItemToPlaylist(playlistId: String, mediaItem: MediaItem): Resource&lt;Unit&gt; {&#10;        return try {&#10;            val playlistMedia = PlaylistMediaEntity(&#10;                playlistId = playlistId,&#10;                mediaId = mediaItem.id,&#10;                position = 0 // This would be calculated based on existing items&#10;            )&#10;            playlistDao.insertPlaylistMedia(playlistMedia)&#10;            Resource.Success(Unit)&#10;        } catch (e: Exception) {&#10;            Resource.Error(&quot;Failed to add item to playlist: ${e.message}&quot;)&#10;        }&#10;    }&#10;    &#10;    override suspend fun removeItemFromPlaylist(playlistId: String, mediaItemId: String): Resource&lt;Unit&gt; {&#10;        return try {&#10;            playlistDao.removePlaylistMedia(playlistId, mediaItemId)&#10;            Resource.Success(Unit)&#10;        } catch (e: Exception) {&#10;            Resource.Error(&quot;Failed to remove item from playlist: ${e.message}&quot;)&#10;        }&#10;    }&#10;    &#10;    override suspend fun reorderPlaylistItems(playlistId: String, fromIndex: Int, toIndex: Int): Resource&lt;Unit&gt; {&#10;        return try {&#10;            // This would implement the reordering logic&#10;            Resource.Success(Unit)&#10;        } catch (e: Exception) {&#10;            Resource.Error(&quot;Failed to reorder playlist items: ${e.message}&quot;)&#10;        }&#10;    }&#10;    &#10;    override suspend fun clearPlaylist(playlistId: String): Resource&lt;Unit&gt; {&#10;        return try {&#10;            playlistDao.clearPlaylist(playlistId)&#10;            Resource.Success(Unit)&#10;        } catch (e: Exception) {&#10;            Resource.Error(&quot;Failed to clear playlist: ${e.message}&quot;)&#10;        }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/data/src/test/kotlin/com/tinhtx/player/local/database/MediaDaoTest.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/data/src/test/kotlin/com/tinhtx/player/local/database/MediaDaoTest.kt" />
              <option name="updatedContent" value="package com.tinhtx.player.local.database&#10;&#10;import androidx.room.Room&#10;import androidx.test.core.app.ApplicationProvider&#10;import androidx.test.ext.junit.runners.AndroidJUnit4&#10;import com.tinhtx.player.local.database.dao.MediaDao&#10;import com.tinhtx.player.local.database.entities.MediaEntity&#10;import kotlinx.coroutines.flow.first&#10;import kotlinx.coroutines.test.runTest&#10;import org.junit.After&#10;import org.junit.Before&#10;import org.junit.Test&#10;import org.junit.Assert.*&#10;import org.junit.runner.RunWith&#10;&#10;@RunWith(AndroidJUnit4::class)&#10;class MediaDaoTest {&#10;    &#10;    private lateinit var database: AppDatabase&#10;    private lateinit var mediaDao: MediaDao&#10;    &#10;    @Before&#10;    fun setup() {&#10;        database = Room.inMemoryDatabaseBuilder(&#10;            ApplicationProvider.getApplicationContext(),&#10;            AppDatabase::class.java&#10;        ).allowMainThreadQueries().build()&#10;        &#10;        mediaDao = database.mediaDao()&#10;    }&#10;    &#10;    @After&#10;    fun teardown() {&#10;        database.close()&#10;    }&#10;    &#10;    @Test&#10;    fun insertAndGetMediaItem() = runTest {&#10;        val mediaItem = MediaEntity(&#10;            id = &quot;1&quot;,&#10;            title = &quot;Test Song&quot;,&#10;            artist = &quot;Test Artist&quot;,&#10;            album = &quot;Test Album&quot;,&#10;            duration = 180000,&#10;            uri = &quot;content://test&quot;,&#10;            mediaType = &quot;AUDIO&quot;&#10;        )&#10;        &#10;        mediaDao.insertMediaItem(mediaItem)&#10;        val result = mediaDao.getMediaItemById(&quot;1&quot;).first()&#10;        &#10;        assertEquals(mediaItem, result)&#10;    }&#10;    &#10;    @Test&#10;    fun getAllMediaItems() = runTest {&#10;        val mediaItems = listOf(&#10;            MediaEntity(&quot;1&quot;, &quot;Song 1&quot;, &quot;Artist 1&quot;, &quot;Album 1&quot;, 180000, &quot;uri1&quot;, mediaType = &quot;AUDIO&quot;),&#10;            MediaEntity(&quot;2&quot;, &quot;Song 2&quot;, &quot;Artist 2&quot;, &quot;Album 2&quot;, 200000, &quot;uri2&quot;, mediaType = &quot;AUDIO&quot;)&#10;        )&#10;        &#10;        mediaDao.insertMediaItems(mediaItems)&#10;        val result = mediaDao.getAllMediaItems().first()&#10;        &#10;        assertEquals(2, result.size)&#10;    }&#10;    &#10;    @Test&#10;    fun searchMediaItems() = runTest {&#10;        val mediaItem = MediaEntity(&#10;            id = &quot;1&quot;,&#10;            title = &quot;Test Song&quot;,&#10;            artist = &quot;Test Artist&quot;,&#10;            album = &quot;Test Album&quot;,&#10;            duration = 180000,&#10;            uri = &quot;content://test&quot;,&#10;            mediaType = &quot;AUDIO&quot;&#10;        )&#10;        &#10;        mediaDao.insertMediaItem(mediaItem)&#10;        val result = mediaDao.searchMediaItems(&quot;Test&quot;).first()&#10;        &#10;        assertEquals(1, result.size)&#10;        assertEquals(mediaItem, result.first())&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/data/src/test/kotlin/com/tinhtx/player/repository/MediaRepositoryImplTest.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/data/src/test/kotlin/com/tinhtx/player/repository/MediaRepositoryImplTest.kt" />
              <option name="updatedContent" value="package com.tinhtx.player.repository&#10;&#10;import com.tinhtx.player.common.Resource&#10;import com.tinhtx.player.local.database.dao.MediaDao&#10;import com.tinhtx.player.local.database.entities.MediaEntity&#10;import com.tinhtx.player.model.MediaItem&#10;import com.tinhtx.player.model.MediaType&#10;import kotlinx.coroutines.flow.flowOf&#10;import kotlinx.coroutines.flow.first&#10;import kotlinx.coroutines.test.runTest&#10;import org.junit.Test&#10;import org.junit.Assert.*&#10;import org.mockito.Mock&#10;import org.mockito.Mockito.*&#10;import org.mockito.junit.MockitoJUnitRunner&#10;import org.junit.runner.RunWith&#10;&#10;@RunWith(MockitoJUnitRunner::class)&#10;class MediaRepositoryImplTest {&#10;    &#10;    @Mock&#10;    private lateinit var mediaDao: MediaDao&#10;    &#10;    private lateinit var repository: MediaRepositoryImpl&#10;    &#10;    @Test&#10;    fun `getAllMediaItems should return success resource`() = runTest {&#10;        // Given&#10;        val entities = listOf(&#10;            MediaEntity(&quot;1&quot;, &quot;Song 1&quot;, &quot;Artist 1&quot;, &quot;Album 1&quot;, 180000, &quot;uri1&quot;, mediaType = &quot;AUDIO&quot;)&#10;        )&#10;        `when`(mediaDao.getAllMediaItems()).thenReturn(flowOf(entities))&#10;        &#10;        repository = MediaRepositoryImpl(mediaDao)&#10;        &#10;        // When&#10;        val result = repository.getAllMediaItems().first()&#10;        &#10;        // Then&#10;        assertTrue(result is Resource.Success)&#10;        assertEquals(1, result.data?.size)&#10;        assertEquals(&quot;Song 1&quot;, result.data?.first()?.title)&#10;    }&#10;    &#10;    @Test&#10;    fun `getAudioItems should return only audio items`() = runTest {&#10;        // Given&#10;        val entities = listOf(&#10;            MediaEntity(&quot;1&quot;, &quot;Song 1&quot;, &quot;Artist 1&quot;, &quot;Album 1&quot;, 180000, &quot;uri1&quot;, mediaType = &quot;AUDIO&quot;)&#10;        )&#10;        `when`(mediaDao.getAudioItems()).thenReturn(flowOf(entities))&#10;        &#10;        repository = MediaRepositoryImpl(mediaDao)&#10;        &#10;        // When&#10;        val result = repository.getAudioItems().first()&#10;        &#10;        // Then&#10;        assertTrue(result is Resource.Success)&#10;        assertEquals(MediaType.AUDIO, result.data?.first()?.mediaType)&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/domain/src/main/kotlin/com/tinhtx/player/model/AlbumInfo.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/domain/src/main/kotlin/com/tinhtx/player/model/AlbumInfo.kt" />
              <option name="updatedContent" value="package com.tinhtx.player.model&#10;&#10;data class AlbumInfo(&#10;    val id: String,&#10;    val name: String,&#10;    val artist: String,&#10;    val artworkUri: String? = null,&#10;    val trackCount: Int = 0,&#10;    val year: Int? = null,&#10;    val duration: Long = 0&#10;)" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/domain/src/main/kotlin/com/tinhtx/player/model/ArtistInfo.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/domain/src/main/kotlin/com/tinhtx/player/model/ArtistInfo.kt" />
              <option name="updatedContent" value="package com.tinhtx.player.model&#10;&#10;data class ArtistInfo(&#10;    val id: String,&#10;    val name: String,&#10;    val albumCount: Int = 0,&#10;    val trackCount: Int = 0,&#10;    val artworkUri: String? = null&#10;)" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/domain/src/main/kotlin/com/tinhtx/player/model/Enums.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/domain/src/main/kotlin/com/tinhtx/player/model/Enums.kt" />
              <option name="updatedContent" value="package com.tinhtx.player.model&#10;&#10;enum class MediaType {&#10;    AUDIO,&#10;    VIDEO&#10;}&#10;&#10;enum class RepeatMode {&#10;    OFF,&#10;    ONE,&#10;    ALL&#10;}&#10;&#10;enum class AppTheme {&#10;    LIGHT,&#10;    DARK,&#10;    SYSTEM&#10;}&#10;&#10;enum class SortOrder {&#10;    TITLE_ASC,&#10;    TITLE_DESC,&#10;    ARTIST_ASC,&#10;    ARTIST_DESC,&#10;    ALBUM_ASC,&#10;    ALBUM_DESC,&#10;    DURATION_ASC,&#10;    DURATION_DESC,&#10;    DATE_ADDED_ASC,&#10;    DATE_ADDED_DESC&#10;}&#10;&#10;enum class PlaybackError {&#10;    NETWORK_ERROR,&#10;    FILE_NOT_FOUND,&#10;    PERMISSION_DENIED,&#10;    UNSUPPORTED_FORMAT,&#10;    UNKNOWN_ERROR&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/domain/src/main/kotlin/com/tinhtx/player/model/MediaItem.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/domain/src/main/kotlin/com/tinhtx/player/model/MediaItem.kt" />
              <option name="updatedContent" value="package com.tinhtx.player.model&#10;&#10;data class MediaItem(&#10;    val id: String,&#10;    val title: String,&#10;    val artist: String,&#10;    val album: String,&#10;    val duration: Long,&#10;    val uri: String,&#10;    val artworkUri: String? = null,&#10;    val mediaType: MediaType,&#10;    val size: Long = 0,&#10;    val dateAdded: Long = 0,&#10;    val path: String = &quot;&quot;,&#10;    val mimeType: String = &quot;&quot;&#10;)" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/domain/src/main/kotlin/com/tinhtx/player/model/PlaybackState.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/domain/src/main/kotlin/com/tinhtx/player/model/PlaybackState.kt" />
              <option name="updatedContent" value="package com.tinhtx.player.model&#10;&#10;data class PlaybackState(&#10;    val isPlaying: Boolean = false,&#10;    val currentMediaItem: MediaItem? = null,&#10;    val currentPosition: Long = 0L,&#10;    val bufferedPosition: Long = 0L,&#10;    val playbackSpeed: Float = 1.0f,&#10;    val repeatMode: RepeatMode = RepeatMode.OFF,&#10;    val shuffleModeEnabled: Boolean = false,&#10;    val queue: List&lt;MediaItem&gt; = emptyList(),&#10;    val currentIndex: Int = -1&#10;)" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/domain/src/main/kotlin/com/tinhtx/player/model/PlaylistInfo.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/domain/src/main/kotlin/com/tinhtx/player/model/PlaylistInfo.kt" />
              <option name="updatedContent" value="package com.tinhtx.player.model&#10;&#10;data class PlaylistInfo(&#10;    val id: String,&#10;    val name: String,&#10;    val description: String = &quot;&quot;,&#10;    val artworkUri: String? = null,&#10;    val trackCount: Int = 0,&#10;    val duration: Long = 0,&#10;    val dateCreated: Long = System.currentTimeMillis(),&#10;    val dateModified: Long = System.currentTimeMillis()&#10;)" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/domain/src/main/kotlin/com/tinhtx/player/model/UserSettings.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/domain/src/main/kotlin/com/tinhtx/player/model/UserSettings.kt" />
              <option name="updatedContent" value="package com.tinhtx.player.model&#10;&#10;data class UserSettings(&#10;    val theme: AppTheme = AppTheme.SYSTEM,&#10;    val playbackSpeed: Float = 1.0f,&#10;    val repeatMode: RepeatMode = RepeatMode.OFF,&#10;    val shuffleMode: Boolean = false,&#10;    val autoPlayNext: Boolean = true,&#10;    val showNotification: Boolean = true,&#10;    val equalizerEnabled: Boolean = false,&#10;    val bassBoostLevel: Int = 0,&#10;    val virtualizerLevel: Int = 0,&#10;    val skipSilence: Boolean = false,&#10;    val crossfadeDuration: Int = 0&#10;)" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/domain/src/main/kotlin/com/tinhtx/player/repository/MediaRepository.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/domain/src/main/kotlin/com/tinhtx/player/repository/MediaRepository.kt" />
              <option name="updatedContent" value="package com.tinhtx.player.repository&#10;&#10;import com.tinhtx.player.common.Resource&#10;import com.tinhtx.player.model.MediaItem&#10;import com.tinhtx.player.model.AlbumInfo&#10;import com.tinhtx.player.model.ArtistInfo&#10;import com.tinhtx.player.model.SortOrder&#10;import kotlinx.coroutines.flow.Flow&#10;&#10;interface MediaRepository {&#10;    &#10;    fun getAllMediaItems(): Flow&lt;Resource&lt;List&lt;MediaItem&gt;&gt;&gt;&#10;    &#10;    fun getAudioItems(): Flow&lt;Resource&lt;List&lt;MediaItem&gt;&gt;&gt;&#10;    &#10;    fun getVideoItems(): Flow&lt;Resource&lt;List&lt;MediaItem&gt;&gt;&gt;&#10;    &#10;    fun getMediaItemById(id: String): Flow&lt;Resource&lt;MediaItem?&gt;&gt;&#10;    &#10;    fun getAlbums(): Flow&lt;Resource&lt;List&lt;AlbumInfo&gt;&gt;&gt;&#10;    &#10;    fun getArtists(): Flow&lt;Resource&lt;List&lt;ArtistInfo&gt;&gt;&gt;&#10;    &#10;    fun getMediaItemsByAlbum(albumId: String): Flow&lt;Resource&lt;List&lt;MediaItem&gt;&gt;&gt;&#10;    &#10;    fun getMediaItemsByArtist(artistId: String): Flow&lt;Resource&lt;List&lt;MediaItem&gt;&gt;&gt;&#10;    &#10;    fun searchMediaItems(query: String): Flow&lt;Resource&lt;List&lt;MediaItem&gt;&gt;&gt;&#10;    &#10;    fun sortMediaItems(items: List&lt;MediaItem&gt;, sortOrder: SortOrder): List&lt;MediaItem&gt;&#10;    &#10;    suspend fun scanMediaFiles(): Resource&lt;Unit&gt;&#10;    &#10;    suspend fun refreshMediaLibrary(): Resource&lt;Unit&gt;&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/domain/src/main/kotlin/com/tinhtx/player/repository/PlaylistRepository.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/domain/src/main/kotlin/com/tinhtx/player/repository/PlaylistRepository.kt" />
              <option name="updatedContent" value="package com.tinhtx.player.repository&#10;&#10;import com.tinhtx.player.common.Resource&#10;import com.tinhtx.player.model.PlaylistInfo&#10;import com.tinhtx.player.model.MediaItem&#10;import kotlinx.coroutines.flow.Flow&#10;&#10;interface PlaylistRepository {&#10;    &#10;    fun getAllPlaylists(): Flow&lt;Resource&lt;List&lt;PlaylistInfo&gt;&gt;&gt;&#10;    &#10;    fun getPlaylistById(id: String): Flow&lt;Resource&lt;PlaylistInfo?&gt;&gt;&#10;    &#10;    fun getPlaylistItems(playlistId: String): Flow&lt;Resource&lt;List&lt;MediaItem&gt;&gt;&gt;&#10;    &#10;    suspend fun createPlaylist(name: String, description: String = &quot;&quot;): Resource&lt;PlaylistInfo&gt;&#10;    &#10;    suspend fun updatePlaylist(playlist: PlaylistInfo): Resource&lt;Unit&gt;&#10;    &#10;    suspend fun deletePlaylist(playlistId: String): Resource&lt;Unit&gt;&#10;    &#10;    suspend fun addItemToPlaylist(playlistId: String, mediaItem: MediaItem): Resource&lt;Unit&gt;&#10;    &#10;    suspend fun removeItemFromPlaylist(playlistId: String, mediaItemId: String): Resource&lt;Unit&gt;&#10;    &#10;    suspend fun reorderPlaylistItems(playlistId: String, fromIndex: Int, toIndex: Int): Resource&lt;Unit&gt;&#10;    &#10;    suspend fun clearPlaylist(playlistId: String): Resource&lt;Unit&gt;&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/domain/src/main/kotlin/com/tinhtx/player/usecase/GetMediaItemsUseCase.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/domain/src/main/kotlin/com/tinhtx/player/usecase/GetMediaItemsUseCase.kt" />
              <option name="updatedContent" value="package com.tinhtx.player.usecase&#10;&#10;import com.tinhtx.player.common.Resource&#10;import com.tinhtx.player.model.MediaItem&#10;import com.tinhtx.player.model.SortOrder&#10;import com.tinhtx.player.repository.MediaRepository&#10;import kotlinx.coroutines.flow.Flow&#10;import javax.inject.Inject&#10;&#10;class GetMediaItemsUseCase @Inject constructor(&#10;    private val mediaRepository: MediaRepository&#10;) {&#10;    &#10;    fun getAllMediaItems(): Flow&lt;Resource&lt;List&lt;MediaItem&gt;&gt;&gt; {&#10;        return mediaRepository.getAllMediaItems()&#10;    }&#10;    &#10;    fun getAudioItems(): Flow&lt;Resource&lt;List&lt;MediaItem&gt;&gt;&gt; {&#10;        return mediaRepository.getAudioItems()&#10;    }&#10;    &#10;    fun getVideoItems(): Flow&lt;Resource&lt;List&lt;MediaItem&gt;&gt;&gt; {&#10;        return mediaRepository.getVideoItems()&#10;    }&#10;    &#10;    fun getMediaItemById(id: String): Flow&lt;Resource&lt;MediaItem?&gt;&gt; {&#10;        return mediaRepository.getMediaItemById(id)&#10;    }&#10;    &#10;    fun searchMediaItems(query: String): Flow&lt;Resource&lt;List&lt;MediaItem&gt;&gt;&gt; {&#10;        return mediaRepository.searchMediaItems(query)&#10;    }&#10;    &#10;    suspend fun refreshMediaLibrary(): Resource&lt;Unit&gt; {&#10;        return mediaRepository.refreshMediaLibrary()&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/domain/src/main/kotlin/com/tinhtx/player/usecase/ManagePlaylistUseCase.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/domain/src/main/kotlin/com/tinhtx/player/usecase/ManagePlaylistUseCase.kt" />
              <option name="updatedContent" value="package com.tinhtx.player.usecase&#10;&#10;import com.tinhtx.player.common.Resource&#10;import com.tinhtx.player.model.PlaylistInfo&#10;import com.tinhtx.player.model.MediaItem&#10;import com.tinhtx.player.repository.PlaylistRepository&#10;import kotlinx.coroutines.flow.Flow&#10;import javax.inject.Inject&#10;&#10;class ManagePlaylistUseCase @Inject constructor(&#10;    private val playlistRepository: PlaylistRepository&#10;) {&#10;    &#10;    fun getAllPlaylists(): Flow&lt;Resource&lt;List&lt;PlaylistInfo&gt;&gt;&gt; {&#10;        return playlistRepository.getAllPlaylists()&#10;    }&#10;    &#10;    fun getPlaylistById(id: String): Flow&lt;Resource&lt;PlaylistInfo?&gt;&gt; {&#10;        return playlistRepository.getPlaylistById(id)&#10;    }&#10;    &#10;    fun getPlaylistItems(playlistId: String): Flow&lt;Resource&lt;List&lt;MediaItem&gt;&gt;&gt; {&#10;        return playlistRepository.getPlaylistItems(playlistId)&#10;    }&#10;    &#10;    suspend fun createPlaylist(name: String, description: String = &quot;&quot;): Resource&lt;PlaylistInfo&gt; {&#10;        return playlistRepository.createPlaylist(name, description)&#10;    }&#10;    &#10;    suspend fun updatePlaylist(playlist: PlaylistInfo): Resource&lt;Unit&gt; {&#10;        return playlistRepository.updatePlaylist(playlist)&#10;    }&#10;    &#10;    suspend fun deletePlaylist(playlistId: String): Resource&lt;Unit&gt; {&#10;        return playlistRepository.deletePlaylist(playlistId)&#10;    }&#10;    &#10;    suspend fun addItemToPlaylist(playlistId: String, mediaItem: MediaItem): Resource&lt;Unit&gt; {&#10;        return playlistRepository.addItemToPlaylist(playlistId, mediaItem)&#10;    }&#10;    &#10;    suspend fun removeItemFromPlaylist(playlistId: String, mediaItemId: String): Resource&lt;Unit&gt; {&#10;        return playlistRepository.removeItemFromPlaylist(playlistId, mediaItemId)&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/domain/src/main/kotlin/com/tinhtx/player/usecase/PlayMediaUseCase.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/domain/src/main/kotlin/com/tinhtx/player/usecase/PlayMediaUseCase.kt" />
              <option name="updatedContent" value="package com.tinhtx.player.usecase&#10;&#10;import com.tinhtx.player.common.Resource&#10;import com.tinhtx.player.model.MediaItem&#10;import com.tinhtx.player.model.PlaybackState&#10;import javax.inject.Inject&#10;&#10;class PlayMediaUseCase @Inject constructor() {&#10;    &#10;    suspend fun playMedia(mediaItem: MediaItem): Resource&lt;Unit&gt; {&#10;        return try {&#10;            // This will be implemented with actual media player logic&#10;            Resource.Success(Unit)&#10;        } catch (e: Exception) {&#10;            Resource.Error(&quot;Failed to play media: ${e.message}&quot;)&#10;        }&#10;    }&#10;    &#10;    suspend fun pauseMedia(): Resource&lt;Unit&gt; {&#10;        return try {&#10;            // This will be implemented with actual media player logic&#10;            Resource.Success(Unit)&#10;        } catch (e: Exception) {&#10;            Resource.Error(&quot;Failed to pause media: ${e.message}&quot;)&#10;        }&#10;    }&#10;    &#10;    suspend fun stopMedia(): Resource&lt;Unit&gt; {&#10;        return try {&#10;            // This will be implemented with actual media player logic&#10;            Resource.Success(Unit)&#10;        } catch (e: Exception) {&#10;            Resource.Error(&quot;Failed to stop media: ${e.message}&quot;)&#10;        }&#10;    }&#10;    &#10;    suspend fun seekTo(position: Long): Resource&lt;Unit&gt; {&#10;        return try {&#10;            // This will be implemented with actual media player logic&#10;            Resource.Success(Unit)&#10;        } catch (e: Exception) {&#10;            Resource.Error(&quot;Failed to seek: ${e.message}&quot;)&#10;        }&#10;    }&#10;    &#10;    suspend fun skipToNext(): Resource&lt;Unit&gt; {&#10;        return try {&#10;            // This will be implemented with actual media player logic&#10;            Resource.Success(Unit)&#10;        } catch (e: Exception) {&#10;            Resource.Error(&quot;Failed to skip to next: ${e.message}&quot;)&#10;        }&#10;    }&#10;    &#10;    suspend fun skipToPrevious(): Resource&lt;Unit&gt; {&#10;        return try {&#10;            // This will be implemented with actual media player logic&#10;            Resource.Success(Unit)&#10;        } catch (e: Exception) {&#10;            Resource.Error(&quot;Failed to skip to previous: ${e.message}&quot;)&#10;        }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/domain/src/test/kotlin/com/tinhtx/player/usecase/GetMediaItemsUseCaseTest.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/domain/src/test/kotlin/com/tinhtx/player/usecase/GetMediaItemsUseCaseTest.kt" />
              <option name="updatedContent" value="package com.tinhtx.player.usecase&#10;&#10;import com.tinhtx.player.common.Resource&#10;import com.tinhtx.player.model.MediaItem&#10;import com.tinhtx.player.model.MediaType&#10;import com.tinhtx.player.repository.MediaRepository&#10;import kotlinx.coroutines.flow.flowOf&#10;import kotlinx.coroutines.test.runTest&#10;import org.junit.Test&#10;import org.junit.Assert.*&#10;import org.mockito.Mock&#10;import org.mockito.Mockito.*&#10;import org.mockito.junit.MockitoJUnitRunner&#10;import org.junit.runner.RunWith&#10;&#10;@RunWith(MockitoJUnitRunner::class)&#10;class GetMediaItemsUseCaseTest {&#10;    &#10;    @Mock&#10;    private lateinit var mediaRepository: MediaRepository&#10;    &#10;    private lateinit var useCase: GetMediaItemsUseCase&#10;    &#10;    @Test&#10;    fun `getAllMediaItems should return media items from repository`() = runTest {&#10;        // Given&#10;        val mediaItems = listOf(&#10;            MediaItem(&#10;                id = &quot;1&quot;,&#10;                title = &quot;Test Song&quot;,&#10;                artist = &quot;Test Artist&quot;,&#10;                album = &quot;Test Album&quot;,&#10;                duration = 180000,&#10;                uri = &quot;content://test&quot;,&#10;                mediaType = MediaType.AUDIO&#10;            )&#10;        )&#10;        val resource = Resource.Success(mediaItems)&#10;        `when`(mediaRepository.getAllMediaItems()).thenReturn(flowOf(resource))&#10;        &#10;        useCase = GetMediaItemsUseCase(mediaRepository)&#10;        &#10;        // When &amp; Then&#10;        useCase.getAllMediaItems().collect { result -&gt;&#10;            assertTrue(result is Resource.Success)&#10;            assertEquals(mediaItems, result.data)&#10;        }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/media/src/main/java/com/tinhtx/player/media/playback/MediaNotificationManager.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/media/src/main/java/com/tinhtx/player/media/playback/MediaNotificationManager.kt" />
              <option name="originalContent" value="// media/src/main/kotlin/com/tinhtx/player/playback/MediaNotificationManager.kt&#10;package com.tinhtx.player.media.playback&#10;&#10;import android.app.Notification&#10;import android.app.PendingIntent&#10;import android.content.Context&#10;import android.content.Intent&#10;import android.graphics.Bitmap&#10;import androidx.core.app.NotificationCompat&#10;import androidx.media3.common.Player&#10;import androidx.media3.exoplayer.ExoPlayer&#10;import androidx.media3.ui.PlayerNotificationManager&#10;import com.tinhtx.player.core.common.Constants&#10;import dagger.hilt.android.qualifiers.ApplicationContext&#10;import javax.inject.Inject&#10;import javax.inject.Singleton&#10;&#10;@Singleton&#10;class MediaNotificationManager @Inject constructor(&#10;    @ApplicationContext private val context: Context,&#10;    private val exoPlayer: ExoPlayer&#10;) {&#10;&#10;    private val notificationManager = PlayerNotificationManager.Builder(&#10;        context,&#10;        Constants.MEDIA_NOTIFICATION_ID,&#10;        Constants.MEDIA_NOTIFICATION_CHANNEL_ID&#10;    )&#10;        .setChannelDescriptionResourceId(android.R.string.ok) // Use system resource temporarily&#10;        .setMediaDescriptionAdapter(object : PlayerNotificationManager.MediaDescriptionAdapter {&#10;            override fun getCurrentContentTitle(player: Player): CharSequence {&#10;                return player.currentMediaItem?.mediaMetadata?.title ?: &quot;Unknown Title&quot;&#10;            }&#10;&#10;            override fun createCurrentContentIntent(player: Player): PendingIntent? {&#10;                // Create intent to open the app when notification is tapped&#10;                val intent = context.packageManager.getLaunchIntentForPackage(context.packageName)&#10;                return intent?.let {&#10;                    PendingIntent.getActivity(&#10;                        context,&#10;                        0,&#10;                        it,&#10;                        PendingIntent.FLAG_UPDATE_CURRENT or PendingIntent.FLAG_IMMUTABLE&#10;                    )&#10;                }&#10;            }&#10;&#10;            override fun getCurrentContentText(player: Player): CharSequence? {&#10;                return player.currentMediaItem?.mediaMetadata?.artist ?: &quot;Unknown Artist&quot;&#10;            }&#10;&#10;            override fun getCurrentLargeIcon(player: Player, callback: PlayerNotificationManager.BitmapCallback): Bitmap? {&#10;                // Load album art - for now return null, can be implemented later&#10;                return null&#10;            }&#10;        })&#10;        .setNotificationListener(object : PlayerNotificationManager.NotificationListener {&#10;            override fun onNotificationCancelled(notificationId: Int, dismissedByUser: Boolean) {&#10;                super.onNotificationCancelled(notificationId, dismissedByUser)&#10;                // Handle notification dismissal&#10;            }&#10;&#10;            override fun onNotificationPosted(notificationId: Int, notification: Notification, ongoing: Boolean) {&#10;                super.onNotificationPosted(notificationId, notification, ongoing)&#10;                // Handle notification posted&#10;            }&#10;        })&#10;        .build()&#10;&#10;    init {&#10;        notificationManager.setPlayer(exoPlayer)&#10;        // Set priority and use media style&#10;        notificationManager.setPriority(NotificationCompat.PRIORITY_LOW)&#10;        notificationManager.setUseRewindAction(false)&#10;        notificationManager.setUseFastForwardAction(false)&#10;    }&#10;&#10;    fun createNotification(): Notification {&#10;        // Create a basic notification for foreground service&#10;        return NotificationCompat.Builder(context, Constants.MEDIA_NOTIFICATION_CHANNEL_ID)&#10;            .setContentTitle(&quot;Music Player&quot;)&#10;            .setContentText(&quot;Ready to play music&quot;)&#10;            .setSmallIcon(android.R.drawable.ic_media_play)&#10;            .setPriority(NotificationCompat.PRIORITY_LOW)&#10;            .build()&#10;    }&#10;&#10;    fun release() {&#10;        notificationManager.setPlayer(null)&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="// media/src/main/kotlin/com/tinhtx/player/playback/MediaNotificationManager.kt&#10;package com.tinhtx.player.media.playback&#10;&#10;import android.app.Notification&#10;import android.app.NotificationChannel&#10;import android.app.NotificationManager&#10;import android.app.PendingIntent&#10;import android.content.Context&#10;import android.content.Intent&#10;import android.graphics.Bitmap&#10;import android.os.Build&#10;import androidx.core.app.NotificationCompat&#10;import androidx.media3.common.Player&#10;import androidx.media3.exoplayer.ExoPlayer&#10;import androidx.media3.ui.PlayerNotificationManager&#10;import com.tinhtx.player.core.common.Constants&#10;import dagger.hilt.android.qualifiers.ApplicationContext&#10;import javax.inject.Inject&#10;import javax.inject.Singleton&#10;&#10;@Singleton&#10;class MediaNotificationManager @Inject constructor(&#10;    @ApplicationContext private val context: Context,&#10;    private val exoPlayer: ExoPlayer&#10;) {&#10;&#10;    private val notificationManager = context.getSystemService(Context.NOTIFICATION_SERVICE) as NotificationManager&#10;&#10;    init {&#10;        createNotificationChannel()&#10;    }&#10;&#10;    private fun createNotificationChannel() {&#10;        if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.O) {&#10;            val channel = NotificationChannel(&#10;                Constants.MEDIA_NOTIFICATION_CHANNEL_ID,&#10;                &quot;Media Playback&quot;,&#10;                NotificationManager.IMPORTANCE_LOW&#10;            ).apply {&#10;                description = &quot;Media playback notifications&quot;&#10;                setShowBadge(false)&#10;                lockscreenVisibility = Notification.VISIBILITY_PUBLIC&#10;            }&#10;            notificationManager.createNotificationChannel(channel)&#10;        }&#10;    }&#10;&#10;    private val playerNotificationManager = PlayerNotificationManager.Builder(&#10;        context,&#10;        Constants.MEDIA_NOTIFICATION_ID,&#10;        Constants.MEDIA_NOTIFICATION_CHANNEL_ID&#10;    )&#10;        .setChannelDescriptionResourceId(android.R.string.ok)&#10;        .setMediaDescriptionAdapter(object : PlayerNotificationManager.MediaDescriptionAdapter {&#10;            override fun getCurrentContentTitle(player: Player): CharSequence {&#10;                return player.currentMediaItem?.mediaMetadata?.title ?: &quot;Unknown Title&quot;&#10;            }&#10;&#10;            override fun createCurrentContentIntent(player: Player): PendingIntent? {&#10;                val intent = context.packageManager.getLaunchIntentForPackage(context.packageName)&#10;                return intent?.let {&#10;                    PendingIntent.getActivity(&#10;                        context,&#10;                        0,&#10;                        it,&#10;                        PendingIntent.FLAG_UPDATE_CURRENT or PendingIntent.FLAG_IMMUTABLE&#10;                    )&#10;                }&#10;            }&#10;&#10;            override fun getCurrentContentText(player: Player): CharSequence? {&#10;                return player.currentMediaItem?.mediaMetadata?.artist ?: &quot;Unknown Artist&quot;&#10;            }&#10;&#10;            override fun getCurrentLargeIcon(player: Player, callback: PlayerNotificationManager.BitmapCallback): Bitmap? {&#10;                return null&#10;            }&#10;        })&#10;        .setNotificationListener(object : PlayerNotificationManager.NotificationListener {&#10;            override fun onNotificationCancelled(notificationId: Int, dismissedByUser: Boolean) {&#10;                super.onNotificationCancelled(notificationId, dismissedByUser)&#10;            }&#10;&#10;            override fun onNotificationPosted(notificationId: Int, notification: Notification, ongoing: Boolean) {&#10;                super.onNotificationPosted(notificationId, notification, ongoing)&#10;            }&#10;        })&#10;        .build()&#10;&#10;    init {&#10;        playerNotificationManager.setPlayer(exoPlayer)&#10;        playerNotificationManager.setPriority(NotificationCompat.PRIORITY_LOW)&#10;        playerNotificationManager.setUseRewindAction(false)&#10;        playerNotificationManager.setUseFastForwardAction(false)&#10;    }&#10;&#10;    fun createNotification(): Notification {&#10;        return NotificationCompat.Builder(context, Constants.MEDIA_NOTIFICATION_CHANNEL_ID)&#10;            .setContentTitle(&quot;Music Player&quot;)&#10;            .setContentText(&quot;Ready to play music&quot;)&#10;            .setSmallIcon(android.R.drawable.ic_media_play)&#10;            .setPriority(NotificationCompat.PRIORITY_LOW)&#10;            .setCategory(NotificationCompat.CATEGORY_TRANSPORT)&#10;            .setVisibility(NotificationCompat.VISIBILITY_PUBLIC)&#10;            .build()&#10;    }&#10;&#10;    fun release() {&#10;        playerNotificationManager.setPlayer(null)&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/media/src/main/kotlin/com/tinhtx/player/playback/ExoPlayerManager.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/media/src/main/kotlin/com/tinhtx/player/playback/ExoPlayerManager.kt" />
              <option name="updatedContent" value="package com.tinhtx.player.playback&#10;&#10;import android.content.Context&#10;import androidx.media3.common.MediaItem&#10;import androidx.media3.common.Player&#10;import androidx.media3.exoplayer.ExoPlayer&#10;import androidx.media3.exoplayer.source.MediaSource&#10;import androidx.media3.exoplayer.source.ProgressiveMediaSource&#10;import androidx.media3.datasource.DefaultDataSource&#10;import kotlinx.coroutines.flow.MutableStateFlow&#10;import kotlinx.coroutines.flow.StateFlow&#10;import kotlinx.coroutines.flow.asStateFlow&#10;import javax.inject.Inject&#10;import javax.inject.Singleton&#10;&#10;@Singleton&#10;class ExoPlayerManager @Inject constructor(&#10;    private val context: Context&#10;) {&#10;    private val _exoPlayer = ExoPlayer.Builder(context).build()&#10;    val exoPlayer: ExoPlayer = _exoPlayer&#10;    &#10;    private val _isPlaying = MutableStateFlow(false)&#10;    val isPlaying: StateFlow&lt;Boolean&gt; = _isPlaying.asStateFlow()&#10;    &#10;    private val _currentPosition = MutableStateFlow(0L)&#10;    val currentPosition: StateFlow&lt;Long&gt; = _currentPosition.asStateFlow()&#10;    &#10;    private val _duration = MutableStateFlow(0L)&#10;    val duration: StateFlow&lt;Long&gt; = _duration.asStateFlow()&#10;    &#10;    init {&#10;        _exoPlayer.addListener(object : Player.Listener {&#10;            override fun onIsPlayingChanged(isPlaying: Boolean) {&#10;                _isPlaying.value = isPlaying&#10;            }&#10;            &#10;            override fun onPlaybackStateChanged(playbackState: Int) {&#10;                if (playbackState == Player.STATE_READY) {&#10;                    _duration.value = _exoPlayer.duration&#10;                }&#10;            }&#10;        })&#10;        &#10;        // Update current position periodically&#10;        startPositionUpdates()&#10;    }&#10;    &#10;    fun playMedia(uri: String) {&#10;        val mediaItem = MediaItem.fromUri(uri)&#10;        val mediaSource = createMediaSource(mediaItem)&#10;        _exoPlayer.setMediaSource(mediaSource)&#10;        _exoPlayer.prepare()&#10;        _exoPlayer.play()&#10;    }&#10;    &#10;    fun pause() {&#10;        _exoPlayer.pause()&#10;    }&#10;    &#10;    fun resume() {&#10;        _exoPlayer.play()&#10;    }&#10;    &#10;    fun stop() {&#10;        _exoPlayer.stop()&#10;    }&#10;    &#10;    fun seekTo(position: Long) {&#10;        _exoPlayer.seekTo(position)&#10;    }&#10;    &#10;    fun skipToNext() {&#10;        if (_exoPlayer.hasNextMediaItem()) {&#10;            _exoPlayer.seekToNext()&#10;        }&#10;    }&#10;    &#10;    fun skipToPrevious() {&#10;        if (_exoPlayer.hasPreviousMediaItem()) {&#10;            _exoPlayer.seekToPrevious()&#10;        }&#10;    }&#10;    &#10;    fun setPlaylist(mediaItems: List&lt;MediaItem&gt;) {&#10;        _exoPlayer.setMediaItems(mediaItems)&#10;        _exoPlayer.prepare()&#10;    }&#10;    &#10;    fun release() {&#10;        _exoPlayer.release()&#10;    }&#10;    &#10;    private fun createMediaSource(mediaItem: MediaItem): MediaSource {&#10;        val dataSourceFactory = DefaultDataSource.Factory(context)&#10;        return ProgressiveMediaSource.Factory(dataSourceFactory)&#10;            .createMediaSource(mediaItem)&#10;    }&#10;    &#10;    private fun startPositionUpdates() {&#10;        // This would typically use a coroutine or timer to update position&#10;        // For simplicity, we'll use a basic approach&#10;        object : Runnable {&#10;            override fun run() {&#10;                if (_exoPlayer.isPlaying) {&#10;                    _currentPosition.value = _exoPlayer.currentPosition&#10;                }&#10;                android.os.Handler(android.os.Looper.getMainLooper()).postDelayed(this, 1000)&#10;            }&#10;        }.run()&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/media/src/main/kotlin/com/tinhtx/player/playback/MediaNotificationManager.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/media/src/main/kotlin/com/tinhtx/player/playback/MediaNotificationManager.kt" />
              <option name="updatedContent" value="package com.tinhtx.player.playback&#10;&#10;import android.app.Notification&#10;import android.app.NotificationChannel&#10;import android.app.NotificationManager&#10;import android.content.Context&#10;import android.os.Build&#10;import androidx.core.app.NotificationCompat&#10;import androidx.media3.session.MediaSession&#10;import androidx.media3.session.MediaSessionService&#10;import com.tinhtx.player.common.Constants&#10;import javax.inject.Inject&#10;import javax.inject.Singleton&#10;&#10;@Singleton&#10;class MediaNotificationManager @Inject constructor(&#10;    private val context: Context&#10;) {&#10;    private val notificationManager = context.getSystemService(Context.NOTIFICATION_SERVICE) as NotificationManager&#10;    &#10;    init {&#10;        createNotificationChannel()&#10;    }&#10;    &#10;    fun showNotification(service: MediaSessionService, mediaSession: MediaSession) {&#10;        val notification = createNotification(mediaSession)&#10;        service.startForeground(Constants.NOTIFICATION_ID, notification)&#10;    }&#10;    &#10;    fun hideNotification() {&#10;        notificationManager.cancel(Constants.NOTIFICATION_ID)&#10;    }&#10;    &#10;    private fun createNotification(mediaSession: MediaSession): Notification {&#10;        return NotificationCompat.Builder(context, Constants.NOTIFICATION_CHANNEL_ID)&#10;            .setContentTitle(&quot;Now Playing&quot;)&#10;            .setContentText(&quot;Music Player&quot;)&#10;            .setSmallIcon(android.R.drawable.ic_media_play)&#10;            .setOngoing(true)&#10;            .setVisibility(NotificationCompat.VISIBILITY_PUBLIC)&#10;            .build()&#10;    }&#10;    &#10;    private fun createNotificationChannel() {&#10;        if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.O) {&#10;            val channel = NotificationChannel(&#10;                Constants.NOTIFICATION_CHANNEL_ID,&#10;                &quot;Media Playback&quot;,&#10;                NotificationManager.IMPORTANCE_LOW&#10;            ).apply {&#10;                description = &quot;Media playback controls&quot;&#10;                setShowBadge(false)&#10;            }&#10;            notificationManager.createNotificationChannel(channel)&#10;        }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/media/src/main/kotlin/com/tinhtx/player/playback/PlaybackService.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/media/src/main/kotlin/com/tinhtx/player/playback/PlaybackService.kt" />
              <option name="updatedContent" value="package com.tinhtx.player.playback&#10;&#10;import android.app.PendingIntent&#10;import android.content.Intent&#10;import androidx.media3.common.MediaItem&#10;import androidx.media3.common.Player&#10;import androidx.media3.exoplayer.ExoPlayer&#10;import androidx.media3.session.MediaSession&#10;import androidx.media3.session.MediaSessionService&#10;import dagger.hilt.android.AndroidEntryPoint&#10;import javax.inject.Inject&#10;&#10;@AndroidEntryPoint&#10;class PlaybackService : MediaSessionService() {&#10;    &#10;    @Inject&#10;    lateinit var exoPlayer: ExoPlayer&#10;    &#10;    @Inject&#10;    lateinit var mediaNotificationManager: MediaNotificationManager&#10;    &#10;    private var mediaSession: MediaSession? = null&#10;    &#10;    override fun onCreate() {&#10;        super.onCreate()&#10;        &#10;        val sessionActivityPendingIntent = packageManager?.getLaunchIntentForPackage(packageName)?.let { sessionIntent -&gt;&#10;            PendingIntent.getActivity(this, 0, sessionIntent, PendingIntent.FLAG_IMMUTABLE)&#10;        }&#10;        &#10;        mediaSession = MediaSession.Builder(this, exoPlayer)&#10;            .setSessionActivity(sessionActivityPendingIntent)&#10;            .build()&#10;            &#10;        exoPlayer.addListener(object : Player.Listener {&#10;            override fun onPlaybackStateChanged(playbackState: Int) {&#10;                when (playbackState) {&#10;                    Player.STATE_READY -&gt; {&#10;                        mediaNotificationManager.showNotification(this@PlaybackService, mediaSession!!)&#10;                    }&#10;                    Player.STATE_ENDED -&gt; {&#10;                        mediaNotificationManager.hideNotification()&#10;                    }&#10;                }&#10;            }&#10;        })&#10;    }&#10;    &#10;    override fun onGetSession(controllerInfo: MediaSession.ControllerInfo): MediaSession? {&#10;        return mediaSession&#10;    }&#10;    &#10;    override fun onDestroy() {&#10;        mediaSession?.run {&#10;            player.release()&#10;            release()&#10;            mediaSession = null&#10;        }&#10;        mediaNotificationManager.hideNotification()&#10;        super.onDestroy()&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/media/src/main/kotlin/com/tinhtx/player/scanner/MediaStoreScanner.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/media/src/main/kotlin/com/tinhtx/player/scanner/MediaStoreScanner.kt" />
              <option name="updatedContent" value="package com.tinhtx.player.scanner&#10;&#10;import android.content.ContentResolver&#10;import android.content.Context&#10;import android.database.Cursor&#10;import android.provider.MediaStore&#10;import com.tinhtx.player.model.MediaItem&#10;import com.tinhtx.player.model.MediaType&#10;import kotlinx.coroutines.Dispatchers&#10;import kotlinx.coroutines.withContext&#10;import javax.inject.Inject&#10;import javax.inject.Singleton&#10;&#10;@Singleton&#10;class MediaStoreScanner @Inject constructor(&#10;    private val context: Context&#10;) {&#10;    private val contentResolver: ContentResolver = context.contentResolver&#10;&#10;    suspend fun scanAudioFiles(): List&lt;MediaItem&gt; = withContext(Dispatchers.IO) {&#10;        val audioFiles = mutableListOf&lt;MediaItem&gt;()&#10;        &#10;        val projection = arrayOf(&#10;            MediaStore.Audio.Media._ID,&#10;            MediaStore.Audio.Media.TITLE,&#10;            MediaStore.Audio.Media.ARTIST,&#10;            MediaStore.Audio.Media.ALBUM,&#10;            MediaStore.Audio.Media.DURATION,&#10;            MediaStore.Audio.Media.DATA,&#10;            MediaStore.Audio.Media.SIZE,&#10;            MediaStore.Audio.Media.DATE_ADDED,&#10;            MediaStore.Audio.Media.MIME_TYPE&#10;        )&#10;        &#10;        val selection = &quot;${MediaStore.Audio.Media.IS_MUSIC} = 1&quot;&#10;        val sortOrder = &quot;${MediaStore.Audio.Media.TITLE} ASC&quot;&#10;        &#10;        contentResolver.query(&#10;            MediaStore.Audio.Media.EXTERNAL_CONTENT_URI,&#10;            projection,&#10;            selection,&#10;            null,&#10;            sortOrder&#10;        )?.use { cursor -&gt;&#10;            val idColumn = cursor.getColumnIndexOrThrow(MediaStore.Audio.Media._ID)&#10;            val titleColumn = cursor.getColumnIndexOrThrow(MediaStore.Audio.Media.TITLE)&#10;            val artistColumn = cursor.getColumnIndexOrThrow(MediaStore.Audio.Media.ARTIST)&#10;            val albumColumn = cursor.getColumnIndexOrThrow(MediaStore.Audio.Media.ALBUM)&#10;            val durationColumn = cursor.getColumnIndexOrThrow(MediaStore.Audio.Media.DURATION)&#10;            val dataColumn = cursor.getColumnIndexOrThrow(MediaStore.Audio.Media.DATA)&#10;            val sizeColumn = cursor.getColumnIndexOrThrow(MediaStore.Audio.Media.SIZE)&#10;            val dateAddedColumn = cursor.getColumnIndexOrThrow(MediaStore.Audio.Media.DATE_ADDED)&#10;            val mimeTypeColumn = cursor.getColumnIndexOrThrow(MediaStore.Audio.Media.MIME_TYPE)&#10;            &#10;            while (cursor.moveToNext()) {&#10;                val id = cursor.getLong(idColumn).toString()&#10;                val title = cursor.getString(titleColumn) ?: &quot;Unknown&quot;&#10;                val artist = cursor.getString(artistColumn) ?: &quot;Unknown Artist&quot;&#10;                val album = cursor.getString(albumColumn) ?: &quot;Unknown Album&quot;&#10;                val duration = cursor.getLong(durationColumn)&#10;                val path = cursor.getString(dataColumn) ?: &quot;&quot;&#10;                val size = cursor.getLong(sizeColumn)&#10;                val dateAdded = cursor.getLong(dateAddedColumn) * 1000 // Convert to milliseconds&#10;                val mimeType = cursor.getString(mimeTypeColumn) ?: &quot;&quot;&#10;                &#10;                val uri = &quot;${MediaStore.Audio.Media.EXTERNAL_CONTENT_URI}/$id&quot;&#10;                &#10;                audioFiles.add(&#10;                    MediaItem(&#10;                        id = id,&#10;                        title = title,&#10;                        artist = artist,&#10;                        album = album,&#10;                        duration = duration,&#10;                        uri = uri,&#10;                        mediaType = MediaType.AUDIO,&#10;                        size = size,&#10;                        dateAdded = dateAdded,&#10;                        path = path,&#10;                        mimeType = mimeType&#10;                    )&#10;                )&#10;            }&#10;        }&#10;        &#10;        audioFiles&#10;    }&#10;&#10;    suspend fun scanVideoFiles(): List&lt;MediaItem&gt; = withContext(Dispatchers.IO) {&#10;        val videoFiles = mutableListOf&lt;MediaItem&gt;()&#10;        &#10;        val projection = arrayOf(&#10;            MediaStore.Video.Media._ID,&#10;            MediaStore.Video.Media.TITLE,&#10;            MediaStore.Video.Media.ARTIST,&#10;            MediaStore.Video.Media.ALBUM,&#10;            MediaStore.Video.Media.DURATION,&#10;            MediaStore.Video.Media.DATA,&#10;            MediaStore.Video.Media.SIZE,&#10;            MediaStore.Video.Media.DATE_ADDED,&#10;            MediaStore.Video.Media.MIME_TYPE&#10;        )&#10;        &#10;        val sortOrder = &quot;${MediaStore.Video.Media.TITLE} ASC&quot;&#10;        &#10;        contentResolver.query(&#10;            MediaStore.Video.Media.EXTERNAL_CONTENT_URI,&#10;            projection,&#10;            null,&#10;            null,&#10;            sortOrder&#10;        )?.use { cursor -&gt;&#10;            val idColumn = cursor.getColumnIndexOrThrow(MediaStore.Video.Media._ID)&#10;            val titleColumn = cursor.getColumnIndexOrThrow(MediaStore.Video.Media.TITLE)&#10;            val artistColumn = cursor.getColumnIndexOrThrow(MediaStore.Video.Media.ARTIST)&#10;            val albumColumn = cursor.getColumnIndexOrThrow(MediaStore.Video.Media.ALBUM)&#10;            val durationColumn = cursor.getColumnIndexOrThrow(MediaStore.Video.Media.DURATION)&#10;            val dataColumn = cursor.getColumnIndexOrThrow(MediaStore.Video.Media.DATA)&#10;            val sizeColumn = cursor.getColumnIndexOrThrow(MediaStore.Video.Media.SIZE)&#10;            val dateAddedColumn = cursor.getColumnIndexOrThrow(MediaStore.Video.Media.DATE_ADDED)&#10;            val mimeTypeColumn = cursor.getColumnIndexOrThrow(MediaStore.Video.Media.MIME_TYPE)&#10;            &#10;            while (cursor.moveToNext()) {&#10;                val id = cursor.getLong(idColumn).toString()&#10;                val title = cursor.getString(titleColumn) ?: &quot;Unknown&quot;&#10;                val artist = cursor.getString(artistColumn) ?: &quot;Unknown&quot;&#10;                val album = cursor.getString(albumColumn) ?: &quot;Unknown&quot;&#10;                val duration = cursor.getLong(durationColumn)&#10;                val path = cursor.getString(dataColumn) ?: &quot;&quot;&#10;                val size = cursor.getLong(sizeColumn)&#10;                val dateAdded = cursor.getLong(dateAddedColumn) * 1000&#10;                val mimeType = cursor.getString(mimeTypeColumn) ?: &quot;&quot;&#10;                &#10;                val uri = &quot;${MediaStore.Video.Media.EXTERNAL_CONTENT_URI}/$id&quot;&#10;                &#10;                videoFiles.add(&#10;                    MediaItem(&#10;                        id = id,&#10;                        title = title,&#10;                        artist = artist,&#10;                        album = album,&#10;                        duration = duration,&#10;                        uri = uri,&#10;                        mediaType = MediaType.VIDEO,&#10;                        size = size,&#10;                        dateAdded = dateAdded,&#10;                        path = path,&#10;                        mimeType = mimeType&#10;                    )&#10;                )&#10;            }&#10;        }&#10;        &#10;        videoFiles&#10;    }&#10;&#10;    suspend fun scanAllMediaFiles(): List&lt;MediaItem&gt; {&#10;        return scanAudioFiles() + scanVideoFiles()&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/presentation/src/main/java/com/tinhtx/player/presentation/navigation/AppNavigation.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/presentation/src/main/java/com/tinhtx/player/presentation/navigation/AppNavigation.kt" />
              <option name="originalContent" value="// presentation/src/main/kotlin/com/tinhtx/player/presentation/navigation/AppNavigation.kt&#10;&#10;package com.tinhtx.player.presentation.navigation&#10;&#10;import androidx.compose.animation.fadeIn&#10;import androidx.compose.animation.fadeOut&#10;import androidx.compose.foundation.layout.Box&#10;import androidx.compose.foundation.layout.fillMaxSize&#10;import androidx.compose.foundation.layout.padding&#10;import androidx.compose.material.icons.Icons&#10;import androidx.compose.material.icons.filled.Collections&#10;import androidx.compose.material.icons.filled.Home&#10;import androidx.compose.material.icons.filled.Search&#10;import androidx.compose.material.icons.filled.Settings&#10;import androidx.compose.material3.Icon&#10;import androidx.compose.material3.NavigationBar&#10;import androidx.compose.material3.NavigationBarItem&#10;import androidx.compose.material3.Scaffold&#10;import androidx.compose.material3.Text&#10;import androidx.compose.runtime.Composable&#10;import androidx.compose.runtime.getValue&#10;import androidx.compose.runtime.mutableStateOf&#10;import androidx.compose.runtime.remember&#10;import androidx.compose.runtime.setValue&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.graphics.vector.ImageVector&#10;import androidx.compose.ui.unit.dp&#10;import androidx.hilt.navigation.compose.hiltViewModel&#10;import androidx.lifecycle.compose.collectAsStateWithLifecycle&#10;import androidx.navigation.NavDestination.Companion.hierarchy&#10;import androidx.navigation.NavGraph.Companion.findStartDestination&#10;import androidx.navigation.compose.NavHost&#10;import androidx.navigation.compose.composable&#10;import androidx.navigation.compose.currentBackStackEntryAsState&#10;import androidx.navigation.compose.rememberNavController&#10;import com.tinhtx.player.core.navigation.Screen&#10;import com.tinhtx.player.presentation.animation.animatedComposable&#10;import com.tinhtx.player.presentation.component.common.MediaPermissionHandler&#10;import com.tinhtx.player.presentation.screen.collection.CollectionScreen&#10;import com.tinhtx.player.presentation.screen.main.HomeScreen&#10;import com.tinhtx.player.presentation.screen.player.MiniPlayerBar&#10;import com.tinhtx.player.presentation.screen.player.MusicPlayerScreen&#10;import com.tinhtx.player.presentation.screen.player.MusicPlayerViewModel&#10;import com.tinhtx.player.presentation.screen.player.PlaybackViewModel&#10;import com.tinhtx.player.presentation.screen.player.VideoPlayerScreen&#10;import com.tinhtx.player.presentation.screen.search.SearchScreen&#10;import com.tinhtx.player.presentation.screen.settings.SettingsScreen&#10;&#10;data class NavItem(val route: String, val icon: ImageVector, val label: String)&#10;&#10;val navItems = listOf(&#10;    NavItem(Screen.Home.route, Icons.Default.Home, &quot;Home&quot;),&#10;    NavItem(Screen.Collection.route, Icons.Default.Collections, &quot;Library&quot;),&#10;    NavItem(Screen.Search.route, Icons.Default.Search, &quot;Search&quot;),&#10;    NavItem(Screen.Settings.route, Icons.Default.Settings, &quot;Settings&quot;)&#10;)&#10;&#10;@Composable&#10;fun AppNavigation() {&#10;    var permissionsGranted by remember { mutableStateOf(false) }&#10;&#10;    MediaPermissionHandler(&#10;        onPermissionsGranted = {&#10;            permissionsGranted = true&#10;        }) {&#10;        AppNavigationContent(permissionsGranted = permissionsGranted)&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun AppNavigationContent(permissionsGranted: Boolean) {&#10;    val navController = rememberNavController()&#10;    val navBackStackEntry by navController.currentBackStackEntryAsState()&#10;    val currentDestination = navBackStackEntry?.destination&#10;    val currentRoute = currentDestination?.route&#10;    val showBottomBar = currentRoute != Screen.VideoPlayer.route &amp;&amp; currentRoute != Screen.MusicPlayer.route&#10;&#10;    // Shared ViewModel cho ton b app&#10;    val playbackViewModel: PlaybackViewModel = hiltViewModel()&#10;    val musicPlayerViewModel: MusicPlayerViewModel = hiltViewModel()&#10;&#10;    // Force initialize PlaybackViewModel ngay lp tc  m bo broadcast receiver c register&#10;    playbackViewModel.playbackState.collectAsStateWithLifecycle()&#10;    musicPlayerViewModel.playbackState.collectAsStateWithLifecycle()&#10;&#10;    Scaffold(&#10;        bottomBar = {&#10;            if (showBottomBar) {&#10;                NavigationBar {&#10;                    navItems.forEach { item -&gt;&#10;                        NavigationBarItem(&#10;                            icon = { Icon(item.icon, contentDescription = null) },&#10;                            label = { Text(item.label) },&#10;                            selected = currentDestination?.hierarchy?.any { it.route == item.route } == true,&#10;                            onClick = {&#10;                                navController.navigate(item.route) {&#10;                                    popUpTo(navController.graph.findStartDestination().id) { saveState = true }&#10;                                    launchSingleTop = true&#10;                                    restoreState = true&#10;                                }&#10;                            })&#10;                    }&#10;                }&#10;            }&#10;        }) { innerPadding -&gt;&#10;        Box(modifier = Modifier.padding(innerPadding)) {&#10;            NavHost(&#10;                navController = navController, startDestination = Screen.Home.route, modifier = Modifier.fillMaxSize()&#10;            ) {&#10;                animatedComposable(Screen.Home.route) {&#10;                    HomeScreen(&#10;                        permissionsGranted = permissionsGranted,&#10;                        onNavigateToSearch = { navController.navigate(Screen.Search.route) },&#10;                        onNavigateToPlayer = { mediaId -&gt; navController.navigate(Screen.MusicPlayer.createRoute(mediaId)) },&#10;                        onNavigateToVideoPlayer = { mediaId -&gt;&#10;                            navController.navigate(&#10;                                Screen.VideoPlayer.createRoute(mediaId)&#10;                            )&#10;                        })&#10;                }&#10;                animatedComposable(Screen.Collection.route) {&#10;                    CollectionScreen(&#10;                        onNavigateBack = { navController.popBackStack() },&#10;                        onNavigateToPlayer = { mediaId -&gt; navController.navigate(Screen.MusicPlayer.createRoute(mediaId)) })&#10;                }&#10;                animatedComposable(Screen.Search.route) {&#10;                    SearchScreen(&#10;                        onNavigateBack = { navController.popBackStack() },&#10;                        onNavigateToPlayer = { mediaId -&gt; navController.navigate(Screen.MusicPlayer.createRoute(mediaId)) })&#10;                }&#10;                composable(&#10;                    route = Screen.MusicPlayer.route,&#10;                    arguments = Screen.MusicPlayer.arguments,&#10;                    enterTransition = { fadeIn() },&#10;                    exitTransition = { fadeOut() }) { backStackEntry -&gt;&#10;                    val mediaId = backStackEntry.arguments?.getString(&quot;mediaId&quot;) ?: &quot;&quot;&#10;                    MusicPlayerScreen(&#10;                        viewModel = musicPlayerViewModel,&#10;                        mediaId = mediaId,&#10;                        onNavigateBack = { navController.popBackStack() })&#10;                }&#10;                composable(&#10;                    route = Screen.VideoPlayer.route,&#10;                    arguments = Screen.VideoPlayer.arguments,&#10;                    enterTransition = { fadeIn() },&#10;                    exitTransition = { fadeOut() }) { backStackEntry -&gt;&#10;                    val mediaId = backStackEntry.arguments?.getString(&quot;mediaId&quot;) ?: &quot;&quot;&#10;                    VideoPlayerScreen(&#10;                        mediaId = mediaId, onNavigateBack = { navController.popBackStack() })&#10;                }&#10;                animatedComposable(Screen.Settings.route) {&#10;                    SettingsScreen(onNavigateBack = { navController.popBackStack() })&#10;                }&#10;            }&#10;            // Ch hin th MiniPlayerBar khi khng  mn hnh MusicPlayer hoc VideoPlayer&#10;            if (showBottomBar) {&#10;                MiniPlayerBar(viewModel = musicPlayerViewModel, onClickBar = {&#10;                    // MiniPlayerBar s navigate da trn currentItem trong state&#10;                    // Tm thi navigate n route template, s cn logic phc tp hn&#10;                    val currentMediaId = musicPlayerViewModel.playbackState.value.currentItem?.id&#10;                    if (currentMediaId != null) {&#10;                        navController.navigate(Screen.MusicPlayer.createRoute(currentMediaId))&#10;                    }&#10;                }, modifier = Modifier&#10;                    .align(Alignment.BottomCenter), onTogglePlayPause = {&#10;                    musicPlayerViewModel.togglePlayPause()&#10;                }, onSkipNext = {&#10;                    musicPlayerViewModel.skipToNext()&#10;                }, onSkipPrevious = {&#10;                    musicPlayerViewModel.skipToPrevious()&#10;                })&#10;            }&#10;        }&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="// presentation/src/main/kotlin/com/tinhtx/player/presentation/navigation/AppNavigation.kt&#10;&#10;package com.tinhtx.player.presentation.navigation&#10;&#10;import androidx.compose.animation.fadeIn&#10;import androidx.compose.animation.fadeOut&#10;import androidx.compose.foundation.layout.Box&#10;import androidx.compose.foundation.layout.fillMaxSize&#10;import androidx.compose.foundation.layout.padding&#10;import androidx.compose.material.icons.Icons&#10;import androidx.compose.material.icons.filled.Collections&#10;import androidx.compose.material.icons.filled.Home&#10;import androidx.compose.material.icons.filled.Search&#10;import androidx.compose.material.icons.filled.Settings&#10;import androidx.compose.material3.Icon&#10;import androidx.compose.material3.NavigationBar&#10;import androidx.compose.material3.NavigationBarItem&#10;import androidx.compose.material3.Scaffold&#10;import androidx.compose.material3.Text&#10;import androidx.compose.runtime.Composable&#10;import androidx.compose.runtime.getValue&#10;import androidx.compose.runtime.mutableStateOf&#10;import androidx.compose.runtime.remember&#10;import androidx.compose.runtime.setValue&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.graphics.vector.ImageVector&#10;import androidx.compose.ui.unit.dp&#10;import androidx.hilt.navigation.compose.hiltViewModel&#10;import androidx.lifecycle.compose.collectAsStateWithLifecycle&#10;import androidx.navigation.NavDestination.Companion.hierarchy&#10;import androidx.navigation.NavGraph.Companion.findStartDestination&#10;import androidx.navigation.compose.NavHost&#10;import androidx.navigation.compose.composable&#10;import androidx.navigation.compose.currentBackStackEntryAsState&#10;import androidx.navigation.compose.rememberNavController&#10;import com.tinhtx.player.core.navigation.Screen&#10;import com.tinhtx.player.presentation.animation.animatedComposable&#10;import com.tinhtx.player.presentation.component.common.MediaPermissionHandler&#10;import com.tinhtx.player.presentation.screen.collection.CollectionScreen&#10;import com.tinhtx.player.presentation.screen.main.HomeScreen&#10;import com.tinhtx.player.presentation.screen.player.MiniPlayerBar&#10;import com.tinhtx.player.presentation.screen.player.MusicPlayerScreen&#10;import com.tinhtx.player.presentation.screen.player.MusicPlayerViewModel&#10;import com.tinhtx.player.presentation.screen.player.PlaybackViewModel&#10;import com.tinhtx.player.presentation.screen.player.VideoPlayerScreen&#10;import com.tinhtx.player.presentation.screen.search.SearchScreen&#10;import com.tinhtx.player.presentation.screen.settings.SettingsScreen&#10;&#10;data class NavItem(val route: String, val icon: ImageVector, val label: String)&#10;&#10;val navItems = listOf(&#10;    NavItem(Screen.Home.route, Icons.Default.Home, &quot;Home&quot;),&#10;    NavItem(Screen.Collection.route, Icons.Default.Collections, &quot;Library&quot;),&#10;    NavItem(Screen.Search.route, Icons.Default.Search, &quot;Search&quot;),&#10;    NavItem(Screen.Settings.route, Icons.Default.Settings, &quot;Settings&quot;)&#10;)&#10;&#10;@Composable&#10;fun AppNavigation() {&#10;    var permissionsGranted by remember { mutableStateOf(false) }&#10;&#10;    MediaPermissionHandler(&#10;        onPermissionsGranted = {&#10;            permissionsGranted = true&#10;        }) {&#10;        AppNavigationContent(permissionsGranted = permissionsGranted)&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun AppNavigationContent(permissionsGranted: Boolean) {&#10;    val navController = rememberNavController()&#10;    val navBackStackEntry by navController.currentBackStackEntryAsState()&#10;    val currentDestination = navBackStackEntry?.destination&#10;    val currentRoute = currentDestination?.route&#10;    val showBottomBar = currentRoute != Screen.VideoPlayer.route &amp;&amp; currentRoute != Screen.MusicPlayer.route&#10;&#10;    // Shared ViewModel cho ton b app&#10;    val playbackViewModel: PlaybackViewModel = hiltViewModel()&#10;    val musicPlayerViewModel: MusicPlayerViewModel = hiltViewModel()&#10;&#10;    // Force initialize PlaybackViewModel ngay lp tc  m bo broadcast receiver c register&#10;    val playbackState by playbackViewModel.playbackState.collectAsStateWithLifecycle()&#10;    val musicPlayerState by musicPlayerViewModel.playbackState.collectAsStateWithLifecycle()&#10;&#10;    // Kim tra xem c nn hin th MiniPlayerBar khng&#10;    val shouldShowMiniPlayer = showBottomBar &amp;&amp; (playbackState.currentItem != null || musicPlayerState.currentItem != null)&#10;&#10;    Scaffold(&#10;        bottomBar = {&#10;            if (showBottomBar) {&#10;                NavigationBar {&#10;                    navItems.forEach { item -&gt;&#10;                        NavigationBarItem(&#10;                            icon = { Icon(item.icon, contentDescription = null) },&#10;                            label = { Text(item.label) },&#10;                            selected = currentDestination?.hierarchy?.any { it.route == item.route } == true,&#10;                            onClick = {&#10;                                navController.navigate(item.route) {&#10;                                    popUpTo(navController.graph.findStartDestination().id) { saveState = true }&#10;                                    launchSingleTop = true&#10;                                    restoreState = true&#10;                                }&#10;                            })&#10;                    }&#10;                }&#10;            }&#10;        }) { innerPadding -&gt;&#10;        Box(modifier = Modifier.padding(innerPadding)) {&#10;            NavHost(&#10;                navController = navController,&#10;                startDestination = Screen.Home.route,&#10;                modifier = Modifier&#10;                    .fillMaxSize()&#10;                    .padding(bottom = if (shouldShowMiniPlayer) 72.dp else 0.dp)&#10;            ) {&#10;                animatedComposable(Screen.Home.route) {&#10;                    HomeScreen(&#10;                        permissionsGranted = permissionsGranted,&#10;                        onNavigateToSearch = { navController.navigate(Screen.Search.route) },&#10;                        onNavigateToPlayer = { mediaId -&gt; navController.navigate(Screen.MusicPlayer.createRoute(mediaId)) },&#10;                        onNavigateToVideoPlayer = { mediaId -&gt;&#10;                            navController.navigate(&#10;                                Screen.VideoPlayer.createRoute(mediaId)&#10;                            )&#10;                        })&#10;                }&#10;                animatedComposable(Screen.Collection.route) {&#10;                    CollectionScreen(&#10;                        onNavigateBack = { navController.popBackStack() },&#10;                        onNavigateToPlayer = { mediaId -&gt; navController.navigate(Screen.MusicPlayer.createRoute(mediaId)) })&#10;                }&#10;                animatedComposable(Screen.Search.route) {&#10;                    SearchScreen(&#10;                        onNavigateBack = { navController.popBackStack() },&#10;                        onNavigateToPlayer = { mediaId -&gt; navController.navigate(Screen.MusicPlayer.createRoute(mediaId)) })&#10;                }&#10;                composable(&#10;                    route = Screen.MusicPlayer.route,&#10;                    arguments = Screen.MusicPlayer.arguments,&#10;                    enterTransition = { fadeIn() },&#10;                    exitTransition = { fadeOut() }) { backStackEntry -&gt;&#10;                    val mediaId = backStackEntry.arguments?.getString(&quot;mediaId&quot;) ?: &quot;&quot;&#10;                    MusicPlayerScreen(&#10;                        viewModel = musicPlayerViewModel,&#10;                        mediaId = mediaId,&#10;                        onNavigateBack = { navController.popBackStack() })&#10;                }&#10;                composable(&#10;                    route = Screen.VideoPlayer.route,&#10;                    arguments = Screen.VideoPlayer.arguments,&#10;                    enterTransition = { fadeIn() },&#10;                    exitTransition = { fadeOut() }) { backStackEntry -&gt;&#10;                    val mediaId = backStackEntry.arguments?.getString(&quot;mediaId&quot;) ?: &quot;&quot;&#10;                    VideoPlayerScreen(&#10;                        mediaId = mediaId, onNavigateBack = { navController.popBackStack() })&#10;                }&#10;                animatedComposable(Screen.Settings.route) {&#10;                    SettingsScreen(onNavigateBack = { navController.popBackStack() })&#10;                }&#10;            }&#10;            // Ch hin th MiniPlayerBar khi khng  mn hnh MusicPlayer hoc VideoPlayer&#10;            if (shouldShowMiniPlayer) {&#10;                MiniPlayerBar(&#10;                    viewModel = playbackViewModel,&#10;                    onNavigateToPlayer = {&#10;                        // MiniPlayerBar s navigate da trn currentItem trong state&#10;                        val currentMediaId = playbackState.currentItem?.id&#10;                            ?: musicPlayerState.currentItem?.id&#10;                        if (currentMediaId != null) {&#10;                            navController.navigate(Screen.MusicPlayer.createRoute(currentMediaId))&#10;                        }&#10;                    },&#10;                    modifier = Modifier&#10;                        .align(Alignment.BottomCenter)&#10;                        .height(72.dp)&#10;                )&#10;            }&#10;        }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/presentation/src/main/java/com/tinhtx/player/presentation/screen/collection/CollectionScreen.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/presentation/src/main/java/com/tinhtx/player/presentation/screen/collection/CollectionScreen.kt" />
              <option name="originalContent" value="// presentation/src/main/kotlin/com/tinhtx/player/screen/collection/CollectionScreen.kt&#10;package com.tinhtx.player.presentation.screen.collection&#10;&#10;import androidx.compose.animation.animateContentSize&#10;import androidx.compose.foundation.ExperimentalFoundationApi&#10;import androidx.compose.foundation.background&#10;import androidx.compose.foundation.clickable&#10;import androidx.compose.foundation.layout.Arrangement&#10;import androidx.compose.foundation.layout.Box&#10;import androidx.compose.foundation.layout.Column&#10;import androidx.compose.foundation.layout.PaddingValues&#10;import androidx.compose.foundation.layout.Row&#10;import androidx.compose.foundation.layout.Spacer&#10;import androidx.compose.foundation.layout.aspectRatio&#10;import androidx.compose.foundation.layout.fillMaxSize&#10;import androidx.compose.foundation.layout.fillMaxWidth&#10;import androidx.compose.foundation.layout.height&#10;import androidx.compose.foundation.layout.padding&#10;import androidx.compose.foundation.layout.size&#10;import androidx.compose.foundation.layout.width&#10;import androidx.compose.foundation.lazy.LazyColumn&#10;import androidx.compose.foundation.lazy.grid.GridCells&#10;import androidx.compose.foundation.lazy.grid.LazyVerticalGrid&#10;import androidx.compose.foundation.lazy.grid.items&#10;import androidx.compose.foundation.lazy.items&#10;import androidx.compose.foundation.pager.HorizontalPager&#10;import androidx.compose.foundation.pager.rememberPagerState&#10;import androidx.compose.foundation.shape.CircleShape&#10;import androidx.compose.foundation.shape.RoundedCornerShape&#10;import androidx.compose.material.icons.Icons&#10;import androidx.compose.material.icons.filled.Add&#10;import androidx.compose.material.icons.filled.Album&#10;import androidx.compose.material.icons.filled.ArrowBack&#10;import androidx.compose.material.icons.filled.Category&#10;import androidx.compose.material.icons.filled.Person&#10;import androidx.compose.material.icons.filled.PlayArrow&#10;import androidx.compose.material.icons.filled.PlaylistPlay&#10;import androidx.compose.material.icons.filled.Search&#10;import androidx.compose.material3.Card&#10;import androidx.compose.material3.CardDefaults&#10;import androidx.compose.material3.CircularProgressIndicator&#10;import androidx.compose.material3.ExperimentalMaterial3Api&#10;import androidx.compose.material3.FloatingActionButton&#10;import androidx.compose.material3.Icon&#10;import androidx.compose.material3.IconButton&#10;import androidx.compose.material3.MaterialTheme&#10;import androidx.compose.material3.Scaffold&#10;import androidx.compose.material3.Tab&#10;import androidx.compose.material3.TabRow&#10;import androidx.compose.material3.TabRowDefaults&#10;import androidx.compose.material3.TabRowDefaults.tabIndicatorOffset&#10;import androidx.compose.material3.Text&#10;import androidx.compose.material3.TopAppBar&#10;import androidx.compose.material3.TopAppBarDefaults&#10;import androidx.compose.runtime.Composable&#10;import androidx.compose.runtime.LaunchedEffect&#10;import androidx.compose.runtime.collectAsState&#10;import androidx.compose.runtime.getValue&#10;import androidx.compose.runtime.mutableIntStateOf&#10;import androidx.compose.runtime.remember&#10;import androidx.compose.runtime.setValue&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.draw.clip&#10;import androidx.compose.ui.graphics.vector.ImageVector&#10;import androidx.compose.ui.layout.ContentScale&#10;import androidx.compose.ui.res.painterResource&#10;import androidx.compose.ui.text.font.FontWeight&#10;import androidx.compose.ui.text.style.TextOverflow&#10;import androidx.compose.ui.unit.Dp&#10;import androidx.compose.ui.unit.dp&#10;import androidx.hilt.navigation.compose.hiltViewModel&#10;import coil.compose.AsyncImage&#10;import com.tinhtx.player.presentation.R&#10;import com.tinhtx.player.core.common.Resource&#10;import com.tinhtx.player.domain.model.AlbumInfo&#10;import com.tinhtx.player.domain.model.ArtistInfo&#10;import com.tinhtx.player.domain.model.PlaylistInfo&#10;import com.tinhtx.player.domain.model.UserPreferences&#10;import com.tinhtx.player.presentation.animation.FlowerBloomAnimation&#10;import com.tinhtx.player.presentation.animation.WaterDropAnimation&#10;&#10;@OptIn(ExperimentalMaterial3Api::class, ExperimentalFoundationApi::class)&#10;@Composable&#10;fun CollectionScreen(&#10;    onNavigateBack: () -&gt; Unit,&#10;    onNavigateToPlayer: (String) -&gt; Unit,&#10;    viewModel: CollectionViewModel = hiltViewModel()&#10;) {&#10;    val uiState by viewModel.uiState.collectAsState()&#10;    val userPreferences by viewModel.userPreferences.collectAsState()&#10;&#10;    var selectedTabIndex by remember { mutableIntStateOf(0) }&#10;    val pagerState = rememberPagerState(pageCount = { 4 })&#10;&#10;    // Sync pager with tab selection&#10;    LaunchedEffect(selectedTabIndex) {&#10;        pagerState.animateScrollToPage(selectedTabIndex)&#10;    }&#10;&#10;    LaunchedEffect(pagerState.currentPage) {&#10;        selectedTabIndex = pagerState.currentPage&#10;    }&#10;&#10;    Scaffold(&#10;        topBar = {&#10;            TopAppBar(&#10;                title = { Text(&quot;Th Vin&quot;) },&#10;                navigationIcon = {&#10;                    IconButton(onClick = onNavigateBack) {&#10;                        Icon(Icons.Default.ArrowBack, contentDescription = &quot;Quay li&quot;)&#10;                    }&#10;                },&#10;                actions = {&#10;                    IconButton(onClick = { /* Search */ }) {&#10;                        Icon(Icons.Default.Search, contentDescription = &quot;Tm kim&quot;)&#10;                    }&#10;                },&#10;                colors = TopAppBarDefaults.topAppBarColors(&#10;                    containerColor = MaterialTheme.colorScheme.surface&#10;                )&#10;            )&#10;        },&#10;        floatingActionButton = {&#10;            if (selectedTabIndex == 3) { // Playlists tab&#10;                FloatingActionButton(&#10;                    onClick = { viewModel.showCreatePlaylistDialog() },&#10;                    containerColor = MaterialTheme.colorScheme.primary&#10;                ) {&#10;                    Icon(Icons.Default.Add, contentDescription = &quot;To playlist&quot;)&#10;                }&#10;            }&#10;        }&#10;    ) { paddingValues -&gt;&#10;        Column(&#10;            modifier = Modifier&#10;                .fillMaxSize()&#10;                .padding(paddingValues)&#10;        ) {&#10;            // Animated Tab Row&#10;            WaterDropAnimation(&#10;                visible = true,&#10;                ageGroup = userPreferences.ageGroup&#10;            ) {&#10;                TabRow(&#10;                    selectedTabIndex = selectedTabIndex,&#10;                    containerColor = MaterialTheme.colorScheme.surface,&#10;                    contentColor = MaterialTheme.colorScheme.onSurface,&#10;                    indicator = { tabPositions -&gt;&#10;                        TabRowDefaults.Indicator(&#10;                            modifier = Modifier.tabIndicatorOffset(tabPositions[selectedTabIndex]),&#10;                            color = MaterialTheme.colorScheme.primary&#10;                        )&#10;                    }&#10;                ) {&#10;                    CollectionTab.values().forEachIndexed { index, tab -&gt;&#10;                        Tab(&#10;                            selected = selectedTabIndex == index,&#10;                            onClick = { selectedTabIndex = index },&#10;                            modifier = Modifier.animateContentSize()&#10;                        ) {&#10;                            Row(&#10;                                modifier = Modifier.padding(16.dp),&#10;                                horizontalArrangement = Arrangement.Center,&#10;                                verticalAlignment = Alignment.CenterVertically&#10;                            ) {&#10;                                Icon(&#10;                                    imageVector = tab.icon,&#10;                                    contentDescription = tab.title,&#10;                                    modifier = Modifier.size(20.dp)&#10;                                )&#10;&#10;                                Spacer(modifier = Modifier.width(8.dp))&#10;&#10;                                Text(&#10;                                    text = tab.title,&#10;                                    style = MaterialTheme.typography.bodyMedium,&#10;                                    fontWeight = if (selectedTabIndex == index)&#10;                                        FontWeight.Bold&#10;                                    else&#10;                                        FontWeight.Normal&#10;                                )&#10;                            }&#10;                        }&#10;                    }&#10;                }&#10;            }&#10;&#10;            // Pager Content&#10;            HorizontalPager(&#10;                state = pagerState,&#10;                modifier = Modifier.fillMaxSize()&#10;            ) { page -&gt;&#10;                when (page) {&#10;                    0 -&gt; AlbumsContent(&#10;                        albumsResource = uiState.albumsResource,&#10;                        onAlbumClick = { album -&gt; viewModel.onAlbumClick(album.id) },&#10;                        onPlayAlbum = { album -&gt; viewModel.onPlayAlbum(album.id) },&#10;                        userPreferences = userPreferences&#10;                    )&#10;                    1 -&gt; ArtistsContent(&#10;                        artistsResource = uiState.artistsResource,&#10;                        onArtistClick = { artist -&gt; viewModel.onArtistClick(artist.id) },&#10;                        onPlayArtist = { artist -&gt; viewModel.onPlayArtist(artist.id) },&#10;                        userPreferences = userPreferences&#10;                    )&#10;                    2 -&gt; GenresContent(&#10;                        genresResource = uiState.genresResource,&#10;                        onGenreClick = { genre -&gt; viewModel.onGenreClick(genre) },&#10;                        userPreferences = userPreferences&#10;                    )&#10;                    3 -&gt; PlaylistsContent(&#10;                        playlistsResource = uiState.playlistsResource,&#10;                        onPlaylistClick = { playlist -&gt; viewModel.onPlaylistClick(playlist.id) },&#10;                        onCreatePlaylist = { viewModel.showCreatePlaylistDialog() },&#10;                        userPreferences = userPreferences&#10;                    )&#10;                }&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun AlbumsContent(&#10;    albumsResource: Resource&lt;List&lt;AlbumInfo&gt;&gt;,&#10;    onAlbumClick: (AlbumInfo) -&gt; Unit,&#10;    onPlayAlbum: (AlbumInfo) -&gt; Unit,&#10;    userPreferences: UserPreferences&#10;) {&#10;    when (albumsResource) {&#10;        is Resource.Loading -&gt; {&#10;            Box(&#10;                modifier = Modifier.fillMaxSize(),&#10;                contentAlignment = Alignment.Center&#10;            ) {&#10;                CircularProgressIndicator()&#10;            }&#10;        }&#10;&#10;        is Resource.Success -&gt; {&#10;            val albums = albumsResource.data ?: emptyList()&#10;&#10;            LazyVerticalGrid(&#10;                columns = GridCells.Adaptive(minSize = 160.dp),&#10;                modifier = Modifier.fillMaxSize(),&#10;                contentPadding = PaddingValues(16.dp),&#10;                verticalArrangement = Arrangement.spacedBy(16.dp),&#10;                horizontalArrangement = Arrangement.spacedBy(16.dp)&#10;            ) {&#10;                items(&#10;                    items = albums,&#10;                    key = { it.id }&#10;                ) { album -&gt;&#10;                    FlowerBloomAnimation(&#10;                        visible = true,&#10;                        ageGroup = userPreferences.ageGroup&#10;                    ) {&#10;                        AlbumCard(&#10;                            album = album,&#10;                            onClick = { onAlbumClick(album) },&#10;                            onPlay = { onPlayAlbum(album) },&#10;                            cornerRadius = userPreferences.ageGroup.cornerRadius.dp&#10;                        )&#10;                    }&#10;                }&#10;            }&#10;        }&#10;&#10;        is Resource.Error -&gt; {&#10;            Box(&#10;                modifier = Modifier.fillMaxSize(),&#10;                contentAlignment = Alignment.Center&#10;            ) {&#10;                Text(&#10;                    text = &quot;Li: ${albumsResource.message}&quot;,&#10;                    color = MaterialTheme.colorScheme.error&#10;                )&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun ArtistsContent(&#10;    artistsResource: Resource&lt;List&lt;ArtistInfo&gt;&gt;,&#10;    onArtistClick: (ArtistInfo) -&gt; Unit,&#10;    onPlayArtist: (ArtistInfo) -&gt; Unit,&#10;    userPreferences: UserPreferences&#10;) {&#10;    when (artistsResource) {&#10;        is Resource.Loading -&gt; {&#10;            Box(&#10;                modifier = Modifier.fillMaxSize(),&#10;                contentAlignment = Alignment.Center&#10;            ) {&#10;                CircularProgressIndicator()&#10;            }&#10;        }&#10;&#10;        is Resource.Success -&gt; {&#10;            val artists = artistsResource.data ?: emptyList()&#10;&#10;            LazyColumn(&#10;                modifier = Modifier.fillMaxSize(),&#10;                contentPadding = PaddingValues(16.dp),&#10;                verticalArrangement = Arrangement.spacedBy(8.dp)&#10;            ) {&#10;                items(&#10;                    items = artists,&#10;                    key = { it.id }&#10;                ) { artist -&gt;&#10;                    WaterDropAnimation(&#10;                        visible = true,&#10;                        ageGroup = userPreferences.ageGroup&#10;                    ) {&#10;                        ArtistCard(&#10;                            artist = artist,&#10;                            onClick = { onArtistClick(artist) },&#10;                            onPlay = { onPlayArtist(artist) },&#10;                            cornerRadius = userPreferences.ageGroup.cornerRadius.dp&#10;                        )&#10;                    }&#10;                }&#10;            }&#10;        }&#10;&#10;        is Resource.Error -&gt; {&#10;            Box(&#10;                modifier = Modifier.fillMaxSize(),&#10;                contentAlignment = Alignment.Center&#10;            ) {&#10;                Text(&#10;                    text = &quot;Li: ${artistsResource.message}&quot;,&#10;                    color = MaterialTheme.colorScheme.error&#10;                )&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun GenresContent(&#10;    genresResource: Resource&lt;List&lt;String&gt;&gt;,&#10;    onGenreClick: (String) -&gt; Unit,&#10;    userPreferences: UserPreferences&#10;) {&#10;    when (genresResource) {&#10;        is Resource.Loading -&gt; {&#10;            Box(&#10;                modifier = Modifier.fillMaxSize(),&#10;                contentAlignment = Alignment.Center&#10;            ) {&#10;                CircularProgressIndicator()&#10;            }&#10;        }&#10;&#10;        is Resource.Success -&gt; {&#10;            val genres = genresResource.data ?: emptyList()&#10;&#10;            LazyVerticalGrid(&#10;                columns = GridCells.Adaptive(minSize = 120.dp),&#10;                modifier = Modifier.fillMaxSize(),&#10;                contentPadding = PaddingValues(16.dp),&#10;                verticalArrangement = Arrangement.spacedBy(12.dp),&#10;                horizontalArrangement = Arrangement.spacedBy(12.dp)&#10;            ) {&#10;                items(&#10;                    items = genres,&#10;                    key = { it }&#10;                ) { genre -&gt;&#10;                    FlowerBloomAnimation(&#10;                        visible = true,&#10;                        ageGroup = userPreferences.ageGroup&#10;                    ) {&#10;                        GenreCard(&#10;                            genre = genre,&#10;                            onClick = { onGenreClick(genre) },&#10;                            cornerRadius = userPreferences.ageGroup.cornerRadius.dp&#10;                        )&#10;                    }&#10;                }&#10;            }&#10;        }&#10;&#10;        is Resource.Error -&gt; {&#10;            Box(&#10;                modifier = Modifier.fillMaxSize(),&#10;                contentAlignment = Alignment.Center&#10;            ) {&#10;                Text(&#10;                    text = &quot;Li: ${genresResource.message}&quot;,&#10;                    color = MaterialTheme.colorScheme.error&#10;                )&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun PlaylistsContent(&#10;    playlistsResource: Resource&lt;List&lt;PlaylistInfo&gt;&gt;,&#10;    onPlaylistClick: (PlaylistInfo) -&gt; Unit,&#10;    onCreatePlaylist: () -&gt; Unit,&#10;    userPreferences: UserPreferences&#10;) {&#10;    when (playlistsResource) {&#10;        is Resource.Loading -&gt; {&#10;            Box(&#10;                modifier = Modifier.fillMaxSize(),&#10;                contentAlignment = Alignment.Center&#10;            ) {&#10;                CircularProgressIndicator()&#10;            }&#10;        }&#10;&#10;        is Resource.Success -&gt; {&#10;            val playlists = playlistsResource.data ?: emptyList()&#10;&#10;            LazyColumn(&#10;                modifier = Modifier.fillMaxSize(),&#10;                contentPadding = PaddingValues(16.dp),&#10;                verticalArrangement = Arrangement.spacedBy(8.dp)&#10;            ) {&#10;                items(&#10;                    items = playlists,&#10;                    key = { it.id }&#10;                ) { playlist -&gt;&#10;                    WaterDropAnimation(&#10;                        visible = true,&#10;                        ageGroup = userPreferences.ageGroup&#10;                    ) {&#10;                        PlaylistCard(&#10;                            playlist = playlist,&#10;                            onClick = { onPlaylistClick(playlist) },&#10;                            cornerRadius = userPreferences.ageGroup.cornerRadius.dp&#10;                        )&#10;                    }&#10;                }&#10;            }&#10;        }&#10;&#10;        is Resource.Error -&gt; {&#10;            Box(&#10;                modifier = Modifier.fillMaxSize(),&#10;                contentAlignment = Alignment.Center&#10;            ) {&#10;                Text(&#10;                    text = &quot;Li: ${playlistsResource.message}&quot;,&#10;                    color = MaterialTheme.colorScheme.error&#10;                )&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun AlbumCard(&#10;    album: AlbumInfo,&#10;    onClick: () -&gt; Unit,&#10;    onPlay: () -&gt; Unit,&#10;    cornerRadius: Dp&#10;) {&#10;    Card(&#10;        modifier = Modifier&#10;            .fillMaxWidth()&#10;            .clickable { onClick() },&#10;        shape = RoundedCornerShape(cornerRadius),&#10;        colors = CardDefaults.cardColors(&#10;            containerColor = MaterialTheme.colorScheme.surfaceVariant&#10;        )&#10;    ) {&#10;        Column(&#10;            modifier = Modifier.padding(12.dp)&#10;        ) {&#10;            Box(&#10;                modifier = Modifier&#10;                    .fillMaxWidth()&#10;                    .aspectRatio(1f)&#10;                    .clip(RoundedCornerShape(cornerRadius * 0.7f))&#10;            ) {&#10;                AsyncImage(&#10;                    model = album.artworkUri,&#10;                    contentDescription = album.name,&#10;                    modifier = Modifier.fillMaxSize(),&#10;                    contentScale = ContentScale.Crop,&#10;                    error = painterResource(R.drawable.ic_album),&#10;                    placeholder = painterResource(R.drawable.ic_album)&#10;                )&#10;&#10;                // Play button overlay&#10;                Box(&#10;                    modifier = Modifier&#10;                        .align(Alignment.BottomEnd)&#10;                        .padding(8.dp)&#10;                        .size(32.dp)&#10;                        .background(&#10;                            color = MaterialTheme.colorScheme.primary,&#10;                            shape = CircleShape&#10;                        )&#10;                        .clickable { onPlay() },&#10;                    contentAlignment = Alignment.Center&#10;                ) {&#10;                    Icon(&#10;                        Icons.Default.PlayArrow,&#10;                        contentDescription = &quot;Pht&quot;,&#10;                        tint = MaterialTheme.colorScheme.onPrimary,&#10;                        modifier = Modifier.size(16.dp)&#10;                    )&#10;                }&#10;            }&#10;&#10;            Spacer(modifier = Modifier.height(8.dp))&#10;&#10;            Text(&#10;                text = album.name,&#10;                style = MaterialTheme.typography.bodyMedium,&#10;                fontWeight = FontWeight.Bold,&#10;                maxLines = 1,&#10;                overflow = TextOverflow.Ellipsis&#10;            )&#10;&#10;            Text(&#10;                text = album.artist,&#10;                style = MaterialTheme.typography.bodySmall,&#10;                color = MaterialTheme.colorScheme.onSurface.copy(alpha = 0.7f),&#10;                maxLines = 1,&#10;                overflow = TextOverflow.Ellipsis&#10;            )&#10;&#10;            Text(&#10;                text = &quot;${album.trackCount} bi&quot;,&#10;                style = MaterialTheme.typography.bodySmall,&#10;                color = MaterialTheme.colorScheme.onSurface.copy(alpha = 0.5f)&#10;            )&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun ArtistCard(&#10;    artist: ArtistInfo,&#10;    onClick: () -&gt; Unit,&#10;    onPlay: () -&gt; Unit,&#10;    cornerRadius: Dp&#10;) {&#10;    Card(&#10;        modifier = Modifier&#10;            .fillMaxWidth()&#10;            .clickable { onClick() },&#10;        shape = RoundedCornerShape(cornerRadius),&#10;        colors = CardDefaults.cardColors(&#10;            containerColor = MaterialTheme.colorScheme.surface&#10;        )&#10;    ) {&#10;        Row(&#10;            modifier = Modifier&#10;                .fillMaxWidth()&#10;                .padding(16.dp),&#10;            verticalAlignment = Alignment.CenterVertically&#10;        ) {&#10;            // Artist Avatar (circular)&#10;            Box(&#10;                modifier = Modifier&#10;                    .size(56.dp)&#10;                    .clip(CircleShape)&#10;                    .background(MaterialTheme.colorScheme.primaryContainer),&#10;                contentAlignment = Alignment.Center&#10;            ) {&#10;                Icon(&#10;                    Icons.Default.Person,&#10;                    contentDescription = artist.name,&#10;                    modifier = Modifier.size(32.dp),&#10;                    tint = MaterialTheme.colorScheme.onPrimaryContainer&#10;                )&#10;            }&#10;&#10;            Spacer(modifier = Modifier.width(16.dp))&#10;&#10;            Column(modifier = Modifier.weight(1f)) {&#10;                Text(&#10;                    text = artist.name,&#10;                    style = MaterialTheme.typography.titleMedium,&#10;                    fontWeight = FontWeight.Bold&#10;                )&#10;                Text(&#10;                    text = &quot;${artist.albumCount} album  ${artist.trackCount} bi&quot;,&#10;                    style = MaterialTheme.typography.bodySmall,&#10;                    color = MaterialTheme.colorScheme.onSurface.copy(alpha = 0.7f)&#10;                )&#10;            }&#10;&#10;            IconButton(onClick = onPlay) {&#10;                Icon(&#10;                    Icons.Default.PlayArrow,&#10;                    contentDescription = &quot;Pht&quot;,&#10;                    tint = MaterialTheme.colorScheme.primary&#10;                )&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun GenreCard(&#10;    genre: String,&#10;    onClick: () -&gt; Unit,&#10;    cornerRadius: Dp&#10;) {&#10;    Card(&#10;        modifier = Modifier&#10;            .fillMaxWidth()&#10;            .aspectRatio(1f)&#10;            .clickable { onClick() },&#10;        shape = RoundedCornerShape(cornerRadius),&#10;        colors = CardDefaults.cardColors(&#10;            containerColor = MaterialTheme.colorScheme.primaryContainer&#10;        )&#10;    ) {&#10;        Box(&#10;            modifier = Modifier&#10;                .fillMaxSize()&#10;                .padding(16.dp),&#10;            contentAlignment = Alignment.Center&#10;        ) {&#10;            Text(&#10;                text = genre,&#10;                style = MaterialTheme.typography.titleMedium,&#10;                fontWeight = FontWeight.Bold,&#10;                color = MaterialTheme.colorScheme.onPrimaryContainer&#10;            )&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun PlaylistCard(&#10;    playlist: PlaylistInfo,&#10;    onClick: () -&gt; Unit,&#10;    cornerRadius: Dp&#10;) {&#10;    Card(&#10;        modifier = Modifier&#10;            .fillMaxWidth()&#10;            .clickable { onClick() },&#10;        shape = RoundedCornerShape(cornerRadius),&#10;        colors = CardDefaults.cardColors(&#10;            containerColor = MaterialTheme.colorScheme.surface&#10;        )&#10;    ) {&#10;        Row(&#10;            modifier = Modifier&#10;                .fillMaxWidth()&#10;                .padding(16.dp),&#10;            verticalAlignment = Alignment.CenterVertically&#10;        ) {&#10;            // Playlist Icon&#10;            Box(&#10;                modifier = Modifier&#10;                    .size(56.dp)&#10;                    .clip(RoundedCornerShape(cornerRadius * 0.5f))&#10;                    .background(MaterialTheme.colorScheme.secondaryContainer),&#10;                contentAlignment = Alignment.Center&#10;            ) {&#10;                Icon(&#10;                    Icons.Default.PlaylistPlay,&#10;                    contentDescription = playlist.name,&#10;                    modifier = Modifier.size(32.dp),&#10;                    tint = MaterialTheme.colorScheme.onSecondaryContainer&#10;                )&#10;            }&#10;&#10;            Spacer(modifier = Modifier.width(16.dp))&#10;&#10;            Column(modifier = Modifier.weight(1f)) {&#10;                Text(&#10;                    text = playlist.name,&#10;                    style = MaterialTheme.typography.titleMedium,&#10;                    fontWeight = FontWeight.Bold&#10;                )&#10;                Text(&#10;                    text = &quot;${playlist.trackCount} bi&quot;,&#10;                    style = MaterialTheme.typography.bodySmall,&#10;                    color = MaterialTheme.colorScheme.onSurface.copy(alpha = 0.7f)&#10;                )&#10;                playlist.description?.let { description -&gt;&#10;                    Text(&#10;                        text = description,&#10;                        style = MaterialTheme.typography.bodySmall,&#10;                        color = MaterialTheme.colorScheme.onSurface.copy(alpha = 0.5f),&#10;                        maxLines = 1,&#10;                        overflow = TextOverflow.Ellipsis&#10;                    )&#10;                }&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;enum class CollectionTab(val title: String, val icon: ImageVector) {&#10;    ALBUMS(&quot;Albums&quot;, Icons.Default.Album),&#10;    ARTISTS(&quot;Ngh s&quot;, Icons.Default.Person),&#10;    GENRES(&quot;Th loi&quot;, Icons.Default.Category),&#10;    PLAYLISTS(&quot;Playlist&quot;, Icons.Default.PlaylistPlay)&#10;}&#10;" />
              <option name="updatedContent" value="// presentation/src/main/kotlin/com/tinhtx/player/screen/collection/CollectionScreen.kt&#10;package com.tinhtx.player.presentation.screen.collection&#10;&#10;import androidx.compose.animation.animateContentSize&#10;import androidx.compose.foundation.ExperimentalFoundationApi&#10;import androidx.compose.foundation.background&#10;import androidx.compose.foundation.clickable&#10;import androidx.compose.foundation.layout.Arrangement&#10;import androidx.compose.foundation.layout.Box&#10;import androidx.compose.foundation.layout.Column&#10;import androidx.compose.foundation.layout.PaddingValues&#10;import androidx.compose.foundation.layout.Row&#10;import androidx.compose.foundation.layout.Spacer&#10;import androidx.compose.foundation.layout.aspectRatio&#10;import androidx.compose.foundation.layout.fillMaxSize&#10;import androidx.compose.foundation.layout.fillMaxWidth&#10;import androidx.compose.foundation.layout.height&#10;import androidx.compose.foundation.layout.padding&#10;import androidx.compose.foundation.layout.size&#10;import androidx.compose.foundation.layout.width&#10;import androidx.compose.foundation.lazy.LazyColumn&#10;import androidx.compose.foundation.lazy.grid.GridCells&#10;import androidx.compose.foundation.lazy.grid.LazyVerticalGrid&#10;import androidx.compose.foundation.lazy.grid.items&#10;import androidx.compose.foundation.lazy.items&#10;import androidx.compose.foundation.pager.HorizontalPager&#10;import androidx.compose.foundation.pager.rememberPagerState&#10;import androidx.compose.foundation.shape.CircleShape&#10;import androidx.compose.foundation.shape.RoundedCornerShape&#10;import androidx.compose.material.icons.Icons&#10;import androidx.compose.material.icons.filled.Add&#10;import androidx.compose.material.icons.filled.Album&#10;import androidx.compose.material.icons.filled.ArrowBack&#10;import androidx.compose.material.icons.filled.Category&#10;import androidx.compose.material.icons.filled.Person&#10;import androidx.compose.material.icons.filled.PlayArrow&#10;import androidx.compose.material.icons.filled.PlaylistPlay&#10;import androidx.compose.material.icons.filled.Search&#10;import androidx.compose.material3.Card&#10;import androidx.compose.material3.CardDefaults&#10;import androidx.compose.material3.CircularProgressIndicator&#10;import androidx.compose.material3.ExperimentalMaterial3Api&#10;import androidx.compose.material3.FloatingActionButton&#10;import androidx.compose.material3.Icon&#10;import androidx.compose.material3.IconButton&#10;import androidx.compose.material3.MaterialTheme&#10;import androidx.compose.material3.Scaffold&#10;import androidx.compose.material3.Tab&#10;import androidx.compose.material3.TabRow&#10;import androidx.compose.material3.TabRowDefaults&#10;import androidx.compose.material3.TabRowDefaults.tabIndicatorOffset&#10;import androidx.compose.material3.Text&#10;import androidx.compose.material3.TopAppBar&#10;import androidx.compose.material3.TopAppBarDefaults&#10;import androidx.compose.runtime.Composable&#10;import androidx.compose.runtime.LaunchedEffect&#10;import androidx.compose.runtime.collectAsState&#10;import androidx.compose.runtime.getValue&#10;import androidx.compose.runtime.mutableIntStateOf&#10;import androidx.compose.runtime.remember&#10;import androidx.compose.runtime.setValue&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.draw.clip&#10;import androidx.compose.ui.graphics.vector.ImageVector&#10;import androidx.compose.ui.layout.ContentScale&#10;import androidx.compose.ui.res.painterResource&#10;import androidx.compose.ui.text.font.FontWeight&#10;import androidx.compose.ui.text.style.TextOverflow&#10;import androidx.compose.ui.unit.Dp&#10;import androidx.compose.ui.unit.dp&#10;import androidx.hilt.navigation.compose.hiltViewModel&#10;import coil.compose.AsyncImage&#10;import com.tinhtx.player.presentation.R&#10;import com.tinhtx.player.core.common.Resource&#10;import com.tinhtx.player.domain.model.AlbumInfo&#10;import com.tinhtx.player.domain.model.ArtistInfo&#10;import com.tinhtx.player.domain.model.PlaylistInfo&#10;import com.tinhtx.player.domain.model.UserPreferences&#10;import com.tinhtx.player.presentation.animation.FlowerBloomAnimation&#10;import com.tinhtx.player.presentation.animation.WaterDropAnimation&#10;&#10;@OptIn(ExperimentalMaterial3Api::class, ExperimentalFoundationApi::class)&#10;@Composable&#10;fun CollectionScreen(&#10;    onNavigateBack: () -&gt; Unit,&#10;    onNavigateToPlayer: (String) -&gt; Unit,&#10;    viewModel: CollectionViewModel = hiltViewModel()&#10;) {&#10;    val uiState by viewModel.uiState.collectAsState()&#10;    val userPreferences by viewModel.userPreferences.collectAsState()&#10;&#10;    var selectedTabIndex by remember { mutableIntStateOf(0) }&#10;    val pagerState = rememberPagerState(pageCount = { 4 })&#10;&#10;    // Sync pager with tab selection&#10;    LaunchedEffect(selectedTabIndex) {&#10;        pagerState.animateScrollToPage(selectedTabIndex)&#10;    }&#10;&#10;    LaunchedEffect(pagerState.currentPage) {&#10;        selectedTabIndex = pagerState.currentPage&#10;    }&#10;&#10;    Column(&#10;        modifier = Modifier.fillMaxSize()&#10;    ) {&#10;        // Top Bar as composable - khng dng Scaffold&#10;        TopAppBar(&#10;            title = { Text(&quot;Th Vin&quot;) },&#10;            navigationIcon = {&#10;                IconButton(onClick = onNavigateBack) {&#10;                    Icon(Icons.Default.ArrowBack, contentDescription = &quot;Quay li&quot;)&#10;                }&#10;            },&#10;            actions = {&#10;                IconButton(onClick = { /* Search */ }) {&#10;                    Icon(Icons.Default.Search, contentDescription = &quot;Tm kim&quot;)&#10;                }&#10;            },&#10;            colors = TopAppBarDefaults.topAppBarColors(&#10;                containerColor = MaterialTheme.colorScheme.surface&#10;            )&#10;        )&#10;&#10;        // Animated Tab Row&#10;        WaterDropAnimation(&#10;            visible = true,&#10;            ageGroup = userPreferences.ageGroup&#10;        ) {&#10;            TabRow(&#10;                selectedTabIndex = selectedTabIndex,&#10;                containerColor = MaterialTheme.colorScheme.surface,&#10;                contentColor = MaterialTheme.colorScheme.onSurface,&#10;                indicator = { tabPositions -&gt;&#10;                    TabRowDefaults.Indicator(&#10;                        modifier = Modifier.tabIndicatorOffset(tabPositions[selectedTabIndex]),&#10;                        color = MaterialTheme.colorScheme.primary&#10;                    )&#10;                }&#10;            ) {&#10;                CollectionTab.values().forEachIndexed { index, tab -&gt;&#10;                    Tab(&#10;                        selected = selectedTabIndex == index,&#10;                        onClick = { selectedTabIndex = index },&#10;                        modifier = Modifier.animateContentSize()&#10;                    ) {&#10;                        Row(&#10;                            modifier = Modifier.padding(16.dp),&#10;                            horizontalArrangement = Arrangement.Center,&#10;                            verticalAlignment = Alignment.CenterVertically&#10;                        ) {&#10;                            Icon(&#10;                                imageVector = tab.icon,&#10;                                contentDescription = tab.title,&#10;                                modifier = Modifier.size(20.dp)&#10;                            )&#10;&#10;                            Spacer(modifier = Modifier.width(8.dp))&#10;&#10;                            Text(&#10;                                text = tab.title,&#10;                                style = MaterialTheme.typography.bodyMedium,&#10;                                fontWeight = if (selectedTabIndex == index)&#10;                                    FontWeight.Bold&#10;                                else&#10;                                    FontWeight.Normal&#10;                            )&#10;                        }&#10;                    }&#10;                }&#10;            }&#10;        }&#10;&#10;        // Pager Content vi Box  handle FAB&#10;        Box(&#10;            modifier = Modifier.fillMaxSize()&#10;        ) {&#10;            HorizontalPager(&#10;                state = pagerState,&#10;                modifier = Modifier.fillMaxSize()&#10;            ) { page -&gt;&#10;                when (page) {&#10;                    0 -&gt; AlbumsContent(&#10;                        albumsResource = uiState.albumsResource,&#10;                        onAlbumClick = { album -&gt; viewModel.onAlbumClick(album.id) },&#10;                        onPlayAlbum = { album -&gt; viewModel.onPlayAlbum(album.id) },&#10;                        userPreferences = userPreferences&#10;                    )&#10;                    1 -&gt; ArtistsContent(&#10;                        artistsResource = uiState.artistsResource,&#10;                        onArtistClick = { artist -&gt; viewModel.onArtistClick(artist.id) },&#10;                        onPlayArtist = { artist -&gt; viewModel.onPlayArtist(artist.id) },&#10;                        userPreferences = userPreferences&#10;                    )&#10;                    2 -&gt; GenresContent(&#10;                        genresResource = uiState.genresResource,&#10;                        onGenreClick = { genre -&gt; viewModel.onGenreClick(genre) },&#10;                        userPreferences = userPreferences&#10;                    )&#10;                    3 -&gt; PlaylistsContent(&#10;                        playlistsResource = uiState.playlistsResource,&#10;                        onPlaylistClick = { playlist -&gt; viewModel.onPlaylistClick(playlist.id) },&#10;                        onCreatePlaylist = { viewModel.showCreatePlaylistDialog() },&#10;                        userPreferences = userPreferences&#10;                    )&#10;                }&#10;            }&#10;&#10;            // FAB positioned at bottom right - ch hin th  tab Playlists&#10;            if (selectedTabIndex == 3) {&#10;                FloatingActionButton(&#10;                    onClick = { viewModel.showCreatePlaylistDialog() },&#10;                    modifier = Modifier&#10;                        .align(Alignment.BottomEnd)&#10;                        .padding(16.dp),&#10;                    containerColor = MaterialTheme.colorScheme.primary&#10;                ) {&#10;                    Icon(Icons.Default.Add, contentDescription = &quot;To playlist&quot;)&#10;                }&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun AlbumsContent(&#10;    albumsResource: Resource&lt;List&lt;AlbumInfo&gt;&gt;,&#10;    onAlbumClick: (AlbumInfo) -&gt; Unit,&#10;    onPlayAlbum: (AlbumInfo) -&gt; Unit,&#10;    userPreferences: UserPreferences&#10;) {&#10;    when (albumsResource) {&#10;        is Resource.Loading -&gt; {&#10;            Box(&#10;                modifier = Modifier.fillMaxSize(),&#10;                contentAlignment = Alignment.Center&#10;            ) {&#10;                CircularProgressIndicator()&#10;            }&#10;        }&#10;&#10;        is Resource.Success -&gt; {&#10;            val albums = albumsResource.data ?: emptyList()&#10;&#10;            LazyVerticalGrid(&#10;                columns = GridCells.Adaptive(minSize = 160.dp),&#10;                modifier = Modifier.fillMaxSize(),&#10;                contentPadding = PaddingValues(16.dp),&#10;                verticalArrangement = Arrangement.spacedBy(16.dp),&#10;                horizontalArrangement = Arrangement.spacedBy(16.dp)&#10;            ) {&#10;                items(&#10;                    items = albums,&#10;                    key = { it.id }&#10;                ) { album -&gt;&#10;                    FlowerBloomAnimation(&#10;                        visible = true,&#10;                        ageGroup = userPreferences.ageGroup&#10;                    ) {&#10;                        AlbumCard(&#10;                            album = album,&#10;                            onClick = { onAlbumClick(album) },&#10;                            onPlay = { onPlayAlbum(album) },&#10;                            cornerRadius = userPreferences.ageGroup.cornerRadius.dp&#10;                        )&#10;                    }&#10;                }&#10;            }&#10;        }&#10;&#10;        is Resource.Error -&gt; {&#10;            Box(&#10;                modifier = Modifier.fillMaxSize(),&#10;                contentAlignment = Alignment.Center&#10;            ) {&#10;                Text(&#10;                    text = &quot;Li: ${albumsResource.message}&quot;,&#10;                    color = MaterialTheme.colorScheme.error&#10;                )&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun ArtistsContent(&#10;    artistsResource: Resource&lt;List&lt;ArtistInfo&gt;&gt;,&#10;    onArtistClick: (ArtistInfo) -&gt; Unit,&#10;    onPlayArtist: (ArtistInfo) -&gt; Unit,&#10;    userPreferences: UserPreferences&#10;) {&#10;    when (artistsResource) {&#10;        is Resource.Loading -&gt; {&#10;            Box(&#10;                modifier = Modifier.fillMaxSize(),&#10;                contentAlignment = Alignment.Center&#10;            ) {&#10;                CircularProgressIndicator()&#10;            }&#10;        }&#10;&#10;        is Resource.Success -&gt; {&#10;            val artists = artistsResource.data ?: emptyList()&#10;&#10;            LazyColumn(&#10;                modifier = Modifier.fillMaxSize(),&#10;                contentPadding = PaddingValues(16.dp),&#10;                verticalArrangement = Arrangement.spacedBy(8.dp)&#10;            ) {&#10;                items(&#10;                    items = artists,&#10;                    key = { it.id }&#10;                ) { artist -&gt;&#10;                    WaterDropAnimation(&#10;                        visible = true,&#10;                        ageGroup = userPreferences.ageGroup&#10;                    ) {&#10;                        ArtistCard(&#10;                            artist = artist,&#10;                            onClick = { onArtistClick(artist) },&#10;                            onPlay = { onPlayArtist(artist) },&#10;                            cornerRadius = userPreferences.ageGroup.cornerRadius.dp&#10;                        )&#10;                    }&#10;                }&#10;            }&#10;        }&#10;&#10;        is Resource.Error -&gt; {&#10;            Box(&#10;                modifier = Modifier.fillMaxSize(),&#10;                contentAlignment = Alignment.Center&#10;            ) {&#10;                Text(&#10;                    text = &quot;Li: ${artistsResource.message}&quot;,&#10;                    color = MaterialTheme.colorScheme.error&#10;                )&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun GenresContent(&#10;    genresResource: Resource&lt;List&lt;String&gt;&gt;,&#10;    onGenreClick: (String) -&gt; Unit,&#10;    userPreferences: UserPreferences&#10;) {&#10;    when (genresResource) {&#10;        is Resource.Loading -&gt; {&#10;            Box(&#10;                modifier = Modifier.fillMaxSize(),&#10;                contentAlignment = Alignment.Center&#10;            ) {&#10;                CircularProgressIndicator()&#10;            }&#10;        }&#10;&#10;        is Resource.Success -&gt; {&#10;            val genres = genresResource.data ?: emptyList()&#10;&#10;            LazyVerticalGrid(&#10;                columns = GridCells.Adaptive(minSize = 120.dp),&#10;                modifier = Modifier.fillMaxSize(),&#10;                contentPadding = PaddingValues(16.dp),&#10;                verticalArrangement = Arrangement.spacedBy(12.dp),&#10;                horizontalArrangement = Arrangement.spacedBy(12.dp)&#10;            ) {&#10;                items(&#10;                    items = genres,&#10;                    key = { it }&#10;                ) { genre -&gt;&#10;                    FlowerBloomAnimation(&#10;                        visible = true,&#10;                        ageGroup = userPreferences.ageGroup&#10;                    ) {&#10;                        GenreCard(&#10;                            genre = genre,&#10;                            onClick = { onGenreClick(genre) },&#10;                            cornerRadius = userPreferences.ageGroup.cornerRadius.dp&#10;                        )&#10;                    }&#10;                }&#10;            }&#10;        }&#10;&#10;        is Resource.Error -&gt; {&#10;            Box(&#10;                modifier = Modifier.fillMaxSize(),&#10;                contentAlignment = Alignment.Center&#10;            ) {&#10;                Text(&#10;                    text = &quot;Li: ${genresResource.message}&quot;,&#10;                    color = MaterialTheme.colorScheme.error&#10;                )&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun PlaylistsContent(&#10;    playlistsResource: Resource&lt;List&lt;PlaylistInfo&gt;&gt;,&#10;    onPlaylistClick: (PlaylistInfo) -&gt; Unit,&#10;    onCreatePlaylist: () -&gt; Unit,&#10;    userPreferences: UserPreferences&#10;) {&#10;    when (playlistsResource) {&#10;        is Resource.Loading -&gt; {&#10;            Box(&#10;                modifier = Modifier.fillMaxSize(),&#10;                contentAlignment = Alignment.Center&#10;            ) {&#10;                CircularProgressIndicator()&#10;            }&#10;        }&#10;&#10;        is Resource.Success -&gt; {&#10;            val playlists = playlistsResource.data ?: emptyList()&#10;&#10;            LazyColumn(&#10;                modifier = Modifier.fillMaxSize(),&#10;                contentPadding = PaddingValues(16.dp),&#10;                verticalArrangement = Arrangement.spacedBy(8.dp)&#10;            ) {&#10;                items(&#10;                    items = playlists,&#10;                    key = { it.id }&#10;                ) { playlist -&gt;&#10;                    WaterDropAnimation(&#10;                        visible = true,&#10;                        ageGroup = userPreferences.ageGroup&#10;                    ) {&#10;                        PlaylistCard(&#10;                            playlist = playlist,&#10;                            onClick = { onPlaylistClick(playlist) },&#10;                            cornerRadius = userPreferences.ageGroup.cornerRadius.dp&#10;                        )&#10;                    }&#10;                }&#10;            }&#10;        }&#10;&#10;        is Resource.Error -&gt; {&#10;            Box(&#10;                modifier = Modifier.fillMaxSize(),&#10;                contentAlignment = Alignment.Center&#10;            ) {&#10;                Text(&#10;                    text = &quot;Li: ${playlistsResource.message}&quot;,&#10;                    color = MaterialTheme.colorScheme.error&#10;                )&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun AlbumCard(&#10;    album: AlbumInfo,&#10;    onClick: () -&gt; Unit,&#10;    onPlay: () -&gt; Unit,&#10;    cornerRadius: Dp&#10;) {&#10;    Card(&#10;        modifier = Modifier&#10;            .fillMaxWidth()&#10;            .clickable { onClick() },&#10;        shape = RoundedCornerShape(cornerRadius),&#10;        colors = CardDefaults.cardColors(&#10;            containerColor = MaterialTheme.colorScheme.surfaceVariant&#10;        )&#10;    ) {&#10;        Column(&#10;            modifier = Modifier.padding(12.dp)&#10;        ) {&#10;            Box(&#10;                modifier = Modifier&#10;                    .fillMaxWidth()&#10;                    .aspectRatio(1f)&#10;                    .clip(RoundedCornerShape(cornerRadius * 0.7f))&#10;            ) {&#10;                AsyncImage(&#10;                    model = album.artworkUri,&#10;                    contentDescription = album.name,&#10;                    modifier = Modifier.fillMaxSize(),&#10;                    contentScale = ContentScale.Crop,&#10;                    error = painterResource(R.drawable.ic_album),&#10;                    placeholder = painterResource(R.drawable.ic_album)&#10;                )&#10;&#10;                // Play button overlay&#10;                Box(&#10;                    modifier = Modifier&#10;                        .align(Alignment.BottomEnd)&#10;                        .padding(8.dp)&#10;                        .size(32.dp)&#10;                        .background(&#10;                            color = MaterialTheme.colorScheme.primary,&#10;                            shape = CircleShape&#10;                        )&#10;                        .clickable { onPlay() },&#10;                    contentAlignment = Alignment.Center&#10;                ) {&#10;                    Icon(&#10;                        Icons.Default.PlayArrow,&#10;                        contentDescription = &quot;Pht&quot;,&#10;                        tint = MaterialTheme.colorScheme.onPrimary,&#10;                        modifier = Modifier.size(16.dp)&#10;                    )&#10;                }&#10;            }&#10;&#10;            Spacer(modifier = Modifier.height(8.dp))&#10;&#10;            Text(&#10;                text = album.name,&#10;                style = MaterialTheme.typography.bodyMedium,&#10;                fontWeight = FontWeight.Bold,&#10;                maxLines = 1,&#10;                overflow = TextOverflow.Ellipsis&#10;            )&#10;&#10;            Text(&#10;                text = album.artist,&#10;                style = MaterialTheme.typography.bodySmall,&#10;                color = MaterialTheme.colorScheme.onSurface.copy(alpha = 0.7f),&#10;                maxLines = 1,&#10;                overflow = TextOverflow.Ellipsis&#10;            )&#10;&#10;            Text(&#10;                text = &quot;${album.trackCount} bi&quot;,&#10;                style = MaterialTheme.typography.bodySmall,&#10;                color = MaterialTheme.colorScheme.onSurface.copy(alpha = 0.5f)&#10;            )&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun ArtistCard(&#10;    artist: ArtistInfo,&#10;    onClick: () -&gt; Unit,&#10;    onPlay: () -&gt; Unit,&#10;    cornerRadius: Dp&#10;) {&#10;    Card(&#10;        modifier = Modifier&#10;            .fillMaxWidth()&#10;            .clickable { onClick() },&#10;        shape = RoundedCornerShape(cornerRadius),&#10;        colors = CardDefaults.cardColors(&#10;            containerColor = MaterialTheme.colorScheme.surface&#10;        )&#10;    ) {&#10;        Row(&#10;            modifier = Modifier&#10;                .fillMaxWidth()&#10;                .padding(16.dp),&#10;            verticalAlignment = Alignment.CenterVertically&#10;        ) {&#10;            // Artist Avatar (circular)&#10;            Box(&#10;                modifier = Modifier&#10;                    .size(56.dp)&#10;                    .clip(CircleShape)&#10;                    .background(MaterialTheme.colorScheme.primaryContainer),&#10;                contentAlignment = Alignment.Center&#10;            ) {&#10;                Icon(&#10;                    Icons.Default.Person,&#10;                    contentDescription = artist.name,&#10;                    modifier = Modifier.size(32.dp),&#10;                    tint = MaterialTheme.colorScheme.onPrimaryContainer&#10;                )&#10;            }&#10;&#10;            Spacer(modifier = Modifier.width(16.dp))&#10;&#10;            Column(modifier = Modifier.weight(1f)) {&#10;                Text(&#10;                    text = artist.name,&#10;                    style = MaterialTheme.typography.titleMedium,&#10;                    fontWeight = FontWeight.Bold&#10;                )&#10;                Text(&#10;                    text = &quot;${artist.albumCount} album  ${artist.trackCount} bi&quot;,&#10;                    style = MaterialTheme.typography.bodySmall,&#10;                    color = MaterialTheme.colorScheme.onSurface.copy(alpha = 0.7f)&#10;                )&#10;            }&#10;&#10;            IconButton(onClick = onPlay) {&#10;                Icon(&#10;                    Icons.Default.PlayArrow,&#10;                    contentDescription = &quot;Pht&quot;,&#10;                    tint = MaterialTheme.colorScheme.primary&#10;                )&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun GenreCard(&#10;    genre: String,&#10;    onClick: () -&gt; Unit,&#10;    cornerRadius: Dp&#10;) {&#10;    Card(&#10;        modifier = Modifier&#10;            .fillMaxWidth()&#10;            .aspectRatio(1f)&#10;            .clickable { onClick() },&#10;        shape = RoundedCornerShape(cornerRadius),&#10;        colors = CardDefaults.cardColors(&#10;            containerColor = MaterialTheme.colorScheme.primaryContainer&#10;        )&#10;    ) {&#10;        Box(&#10;            modifier = Modifier&#10;                .fillMaxSize()&#10;                .padding(16.dp),&#10;            contentAlignment = Alignment.Center&#10;        ) {&#10;            Text(&#10;                text = genre,&#10;                style = MaterialTheme.typography.titleMedium,&#10;                fontWeight = FontWeight.Bold,&#10;                color = MaterialTheme.colorScheme.onPrimaryContainer&#10;            )&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun PlaylistCard(&#10;    playlist: PlaylistInfo,&#10;    onClick: () -&gt; Unit,&#10;    cornerRadius: Dp&#10;) {&#10;    Card(&#10;        modifier = Modifier&#10;            .fillMaxWidth()&#10;            .clickable { onClick() },&#10;        shape = RoundedCornerShape(cornerRadius),&#10;        colors = CardDefaults.cardColors(&#10;            containerColor = MaterialTheme.colorScheme.surface&#10;        )&#10;    ) {&#10;        Row(&#10;            modifier = Modifier&#10;                .fillMaxWidth()&#10;                .padding(16.dp),&#10;            verticalAlignment = Alignment.CenterVertically&#10;        ) {&#10;            // Playlist Icon&#10;            Box(&#10;                modifier = Modifier&#10;                    .size(56.dp)&#10;                    .clip(RoundedCornerShape(cornerRadius * 0.5f))&#10;                    .background(MaterialTheme.colorScheme.secondaryContainer),&#10;                contentAlignment = Alignment.Center&#10;            ) {&#10;                Icon(&#10;                    Icons.Default.PlaylistPlay,&#10;                    contentDescription = playlist.name,&#10;                    modifier = Modifier.size(32.dp),&#10;                    tint = MaterialTheme.colorScheme.onSecondaryContainer&#10;                )&#10;            }&#10;&#10;            Spacer(modifier = Modifier.width(16.dp))&#10;&#10;            Column(modifier = Modifier.weight(1f)) {&#10;                Text(&#10;                    text = playlist.name,&#10;                    style = MaterialTheme.typography.titleMedium,&#10;                    fontWeight = FontWeight.Bold&#10;                )&#10;                Text(&#10;                    text = &quot;${playlist.trackCount} bi&quot;,&#10;                    style = MaterialTheme.typography.bodySmall,&#10;                    color = MaterialTheme.colorScheme.onSurface.copy(alpha = 0.7f)&#10;                )&#10;                playlist.description?.let { description -&gt;&#10;                    Text(&#10;                        text = description,&#10;                        style = MaterialTheme.typography.bodySmall,&#10;                        color = MaterialTheme.colorScheme.onSurface.copy(alpha = 0.5f),&#10;                        maxLines = 1,&#10;                        overflow = TextOverflow.Ellipsis&#10;                    )&#10;                }&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;enum class CollectionTab(val title: String, val icon: ImageVector) {&#10;    ALBUMS(&quot;Albums&quot;, Icons.Default.Album),&#10;    ARTISTS(&quot;Ngh s&quot;, Icons.Default.Person),&#10;    GENRES(&quot;Th loi&quot;, Icons.Default.Category),&#10;    PLAYLISTS(&quot;Playlist&quot;, Icons.Default.PlaylistPlay)&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/presentation/src/main/java/com/tinhtx/player/presentation/screen/player/MusicPlayerScreen.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/presentation/src/main/java/com/tinhtx/player/presentation/screen/player/MusicPlayerScreen.kt" />
              <option name="originalContent" value="// presentation/src/main/kotlin/com/tinhtx/player/screen/player/MusicPlayerScreen.kt&#10;package com.tinhtx.player.presentation.screen.player&#10;&#10;import androidx.compose.animation.AnimatedContent&#10;import androidx.compose.animation.scaleIn&#10;import androidx.compose.animation.scaleOut&#10;import androidx.compose.animation.core.FastOutSlowInEasing&#10;import androidx.compose.animation.core.LinearEasing&#10;import androidx.compose.animation.core.RepeatMode as AnimationRepeatMode&#10;import androidx.compose.animation.core.animateFloatAsState&#10;import androidx.compose.animation.core.infiniteRepeatable&#10;import androidx.compose.animation.core.tween&#10;import androidx.compose.animation.togetherWith&#10;import androidx.compose.foundation.background&#10;import androidx.compose.foundation.layout.Arrangement&#10;import androidx.compose.foundation.layout.Box&#10;import androidx.compose.foundation.layout.Column&#10;import androidx.compose.foundation.layout.Row&#10;import androidx.compose.foundation.layout.Spacer&#10;import androidx.compose.foundation.layout.fillMaxSize&#10;import androidx.compose.foundation.layout.fillMaxWidth&#10;import androidx.compose.foundation.layout.height&#10;import androidx.compose.foundation.layout.padding&#10;import androidx.compose.foundation.layout.size&#10;import androidx.compose.foundation.shape.RoundedCornerShape&#10;import androidx.compose.material.icons.Icons&#10;import androidx.compose.material.icons.automirrored.filled.ArrowBack&#10;import androidx.compose.material.icons.filled.Equalizer&#10;import androidx.compose.material.icons.filled.Favorite&#10;import androidx.compose.material.icons.filled.FavoriteBorder&#10;import androidx.compose.material.icons.filled.Lyrics&#10;import androidx.compose.material.icons.filled.MoreVert&#10;import androidx.compose.material.icons.filled.Pause&#10;import androidx.compose.material.icons.filled.PlayArrow&#10;import androidx.compose.material.icons.filled.Repeat&#10;import androidx.compose.material.icons.filled.RepeatOne&#10;import androidx.compose.material.icons.filled.Shuffle&#10;import androidx.compose.material.icons.filled.SkipNext&#10;import androidx.compose.material.icons.filled.SkipPrevious&#10;import androidx.compose.material3.ExperimentalMaterial3Api&#10;import androidx.compose.material3.FloatingActionButton&#10;import androidx.compose.material3.Icon&#10;import androidx.compose.material3.IconButton&#10;import androidx.compose.material3.MaterialTheme&#10;import androidx.compose.material3.Slider&#10;import androidx.compose.material3.SliderDefaults&#10;import androidx.compose.material3.Text&#10;import androidx.compose.runtime.Composable&#10;import androidx.compose.runtime.DisposableEffect&#10;import androidx.compose.runtime.LaunchedEffect&#10;import androidx.compose.runtime.collectAsState&#10;import androidx.compose.runtime.getValue&#10;import androidx.compose.runtime.mutableStateOf&#10;import androidx.compose.runtime.remember&#10;import androidx.compose.runtime.setValue&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.draw.clip&#10;import androidx.compose.ui.draw.rotate&#10;import androidx.compose.ui.draw.scale&#10;import androidx.compose.ui.graphics.Brush&#10;import androidx.compose.ui.graphics.Color&#10;import androidx.compose.ui.layout.ContentScale&#10;import androidx.compose.ui.res.painterResource&#10;import androidx.compose.ui.text.style.TextAlign&#10;import androidx.compose.ui.text.style.TextOverflow&#10;import androidx.compose.ui.unit.dp&#10;import androidx.hilt.navigation.compose.hiltViewModel&#10;import androidx.lifecycle.compose.collectAsStateWithLifecycle&#10;import coil.compose.AsyncImage&#10;import com.tinhtx.player.domain.model.RepeatMode as PlaybackRepeatMode&#10;import com.tinhtx.player.domain.model.ShuffleMode&#10;import com.tinhtx.player.presentation.R&#10;import com.tinhtx.player.presentation.component.media.*&#10;import com.tinhtx.player.presentation.component.animation.FallingLeavesAnimation&#10;import com.tinhtx.player.presentation.component.animation.WaterWaveAnimation&#10;import com.tinhtx.player.presentation.component.animation.FlowerBloomAnimation&#10;import java.util.Locale&#10;&#10;@OptIn(ExperimentalMaterial3Api::class)&#10;@Composable&#10;fun MusicPlayerScreen(&#10;    mediaId: String,&#10;    onNavigateBack: () -&gt; Unit,&#10;    viewModel: MusicPlayerViewModel = hiltViewModel()&#10;) {&#10;    val uiState by viewModel.uiState.collectAsStateWithLifecycle()&#10;    val userPreferences by viewModel.userPreferences.collectAsStateWithLifecycle()&#10;    val playbackState by viewModel.playbackState.collectAsStateWithLifecycle()&#10;&#10;    var showEqualizer by remember { mutableStateOf(false) }&#10;    var showLyrics by remember { mutableStateOf(false) }&#10;&#10;    // Animation states&#10;    val albumArtRotation by animateFloatAsState(&#10;        targetValue = if (playbackState.isPlaying) 360f else 0f,&#10;        animationSpec = infiniteRepeatable(&#10;            animation = tween(10000, easing = LinearEasing),&#10;            repeatMode = AnimationRepeatMode.Restart&#10;        ),&#10;        label = &quot;Album Art Rotation&quot;&#10;    )&#10;&#10;    val pulseScale by animateFloatAsState(&#10;        targetValue = if (playbackState.isPlaying) 1.05f else 1f,&#10;        animationSpec = infiniteRepeatable(&#10;            animation = tween(1000, easing = FastOutSlowInEasing),&#10;            repeatMode = AnimationRepeatMode.Reverse&#10;        ),&#10;        label = &quot;Pulse Scale&quot;&#10;    )&#10;&#10;    LaunchedEffect(mediaId) {&#10;        // Kim tra k hn trc khi load v play&#10;        val currentState = viewModel.playbackState.value&#10;        val currentItem = currentState.currentItem&#10;&#10;        // Ch load nu:&#10;        // 1. Cha c currentItem, HOC&#10;        // 2. MediaId khc vi currentItem.id&#10;        if (currentItem == null || currentItem.id != mediaId) {&#10;            println(&quot;DEBUG: Loading new media - currentItem: ${currentItem?.id}, requested: $mediaId&quot;)&#10;            viewModel.loadAndPlayMediaItem(mediaId)&#10;        } else {&#10;            println(&quot;DEBUG: Media already loaded - currentItem: ${currentItem.id}, requested: $mediaId&quot;)&#10;            // Nu  c media ng ri, ch cn ensure UI ng b&#10;        }&#10;    }&#10;&#10;    // m bo broadcast state khi user navigate away khi MusicPlayerScreen&#10;    DisposableEffect(Unit) {&#10;        onDispose {&#10;            // Khi MusicPlayerScreen b dispose, broadcast state  MiniPlayerBar c th nhn c&#10;            viewModel.onNavigateAway()&#10;        }&#10;    }&#10;&#10;    Box(&#10;        modifier = Modifier&#10;            .fillMaxSize()&#10;            .background(&#10;                brush = Brush.verticalGradient(&#10;                    colors = listOf(&#10;                        MaterialTheme.colorScheme.primaryContainer.copy(alpha = 0.1f),&#10;                        MaterialTheme.colorScheme.background,&#10;                        MaterialTheme.colorScheme.surfaceVariant.copy(alpha = 0.1f)&#10;                    )&#10;                )&#10;            )&#10;    ) {&#10;        Column(&#10;            modifier = Modifier&#10;                .fillMaxSize()&#10;                .padding(16.dp),&#10;            horizontalAlignment = Alignment.CenterHorizontally&#10;        ) {&#10;            // Top Bar with Back Button&#10;            WaterWaveAnimation(&#10;                visible = true,&#10;                ageGroup = userPreferences.ageGroup&#10;            ) {&#10;                Row(&#10;                    modifier = Modifier.fillMaxWidth(),&#10;                    horizontalArrangement = Arrangement.SpaceBetween,&#10;                    verticalAlignment = Alignment.CenterVertically&#10;                ) {&#10;                    IconButton(onClick = onNavigateBack) {&#10;                        Icon(&#10;                            Icons.AutoMirrored.Filled.ArrowBack,&#10;                            contentDescription = &quot;Back&quot;,&#10;                            tint = MaterialTheme.colorScheme.onBackground&#10;                        )&#10;                    }&#10;&#10;                    Text(&#10;                        text = &quot;Now Playing&quot;,&#10;                        style = MaterialTheme.typography.headlineSmall,&#10;                        color = MaterialTheme.colorScheme.onBackground&#10;                    )&#10;&#10;                    IconButton(onClick = { /* More options */ }) {&#10;                        Icon(&#10;                            Icons.Default.MoreVert,&#10;                            contentDescription = &quot;More&quot;,&#10;                            tint = MaterialTheme.colorScheme.onBackground&#10;                        )&#10;                    }&#10;                }&#10;            }&#10;&#10;            Spacer(modifier = Modifier.height(32.dp))&#10;&#10;            // Album Art Section&#10;            FlowerBloomAnimation(&#10;                visible = uiState.currentMediaItem != null,&#10;                ageGroup = userPreferences.ageGroup&#10;            ) {&#10;                Box(&#10;                    modifier = Modifier&#10;                        .size(320.dp)&#10;                        .clip(RoundedCornerShape(userPreferences.ageGroup.cornerRadius)),&#10;                        // .background(&#10;                        //     brush = Brush.radialGradient(&#10;                        //         colors = listOf(&#10;                        //             MaterialTheme.colorScheme.primary.copy(alpha = 0.1f),&#10;                        //             MaterialTheme.colorScheme.secondary.copy(alpha = 0.05f)&#10;                        //         )&#10;                        //     )&#10;                        // )&#10;                        //.scale(pulseScale)&#10;                        //.rotate(albumArtRotation),&#10;                    contentAlignment = Alignment.Center&#10;                ) {&#10;                    AsyncImage(&#10;                        model = uiState.currentMediaItem?.albumArtUri,&#10;                        contentDescription = &quot;Album Art&quot;,&#10;                        modifier = Modifier&#10;                            .fillMaxSize()&#10;                            .clip(RoundedCornerShape(userPreferences.ageGroup.cornerRadius)),&#10;                        contentScale = ContentScale.Crop,&#10;                        error = painterResource(R.drawable.ic_placeholder),&#10;                        placeholder = painterResource(R.drawable.ic_placeholder)&#10;                    )&#10;                }&#10;            }&#10;&#10;            Spacer(modifier = Modifier.height(32.dp))&#10;&#10;            // Track Info&#10;            WaterWaveAnimation(&#10;                visible = uiState.currentMediaItem != null,&#10;                ageGroup = userPreferences.ageGroup&#10;            ) {&#10;                Column(&#10;                    horizontalAlignment = Alignment.CenterHorizontally&#10;                ) {&#10;                    Text(&#10;                        text = uiState.currentMediaItem?.title ?: &quot;Unknown Title&quot;,&#10;                        style = MaterialTheme.typography.headlineMedium,&#10;                        color = MaterialTheme.colorScheme.onBackground,&#10;                        textAlign = TextAlign.Center,&#10;                        maxLines = 2,&#10;                        overflow = TextOverflow.Ellipsis&#10;                    )&#10;&#10;                    Spacer(modifier = Modifier.height(8.dp))&#10;&#10;                    Text(&#10;                        text = uiState.currentMediaItem?.artist ?: &quot;Unknown Artist&quot;,&#10;                        style = MaterialTheme.typography.bodyLarge,&#10;                        color = MaterialTheme.colorScheme.onBackground.copy(alpha = 0.7f),&#10;                        textAlign = TextAlign.Center&#10;                    )&#10;                }&#10;            }&#10;&#10;            Spacer(modifier = Modifier.height(32.dp))&#10;&#10;            // Progress Bar&#10;            FallingLeavesAnimation(&#10;                visible = true,&#10;                ageGroup = userPreferences.ageGroup&#10;            ) {&#10;                Column {&#10;                    Slider(&#10;                        value = playbackState.playbackPosition.toFloat(),&#10;                        onValueChange = { viewModel.seekTo(it.toLong()) },&#10;                        valueRange = 0f..playbackState.duration.toFloat(),&#10;                        modifier = Modifier.fillMaxWidth(),&#10;                        colors = SliderDefaults.colors(&#10;                            thumbColor = MaterialTheme.colorScheme.primary,&#10;                            activeTrackColor = MaterialTheme.colorScheme.primary,&#10;                            inactiveTrackColor = MaterialTheme.colorScheme.primary.copy(alpha = 0.3f)&#10;                        )&#10;                    )&#10;&#10;                    Row(&#10;                        modifier = Modifier.fillMaxWidth(),&#10;                        horizontalArrangement = Arrangement.SpaceBetween&#10;                    ) {&#10;                        Text(&#10;                            text = formatTime(playbackState.playbackPosition),&#10;                            style = MaterialTheme.typography.bodySmall,&#10;                            color = MaterialTheme.colorScheme.onBackground.copy(alpha = 0.6f)&#10;                        )&#10;&#10;                        Text(&#10;                            text = formatTime(playbackState.duration),&#10;                            style = MaterialTheme.typography.bodySmall,&#10;                            color = MaterialTheme.colorScheme.onBackground.copy(alpha = 0.6f)&#10;                        )&#10;                    }&#10;                }&#10;            }&#10;&#10;            Spacer(modifier = Modifier.height(32.dp))&#10;&#10;            // Playback Controls&#10;            WaterWaveAnimation(&#10;                visible = true,&#10;                ageGroup = userPreferences.ageGroup&#10;            ) {&#10;                Row(&#10;                    modifier = Modifier.fillMaxWidth(),&#10;                    horizontalArrangement = Arrangement.SpaceEvenly,&#10;                    verticalAlignment = Alignment.CenterVertically&#10;                ) {&#10;                    IconButton(&#10;                        onClick = { viewModel.toggleShuffle() },&#10;                        modifier = Modifier.size(48.dp)&#10;                    ) {&#10;                        Icon(&#10;                            Icons.Default.Shuffle,&#10;                            contentDescription = &quot;Shuffle&quot;,&#10;                            tint = if (playbackState.shuffleMode == ShuffleMode.ON)&#10;                                MaterialTheme.colorScheme.primary&#10;                            else&#10;                                MaterialTheme.colorScheme.onBackground.copy(alpha = 0.6f)&#10;                        )&#10;                    }&#10;&#10;                    IconButton(&#10;                        onClick = { viewModel.skipToPrevious() },&#10;                        modifier = Modifier.size(56.dp)&#10;                    ) {&#10;                        Icon(&#10;                            Icons.Default.SkipPrevious,&#10;                            contentDescription = &quot;Previous&quot;,&#10;                            tint = MaterialTheme.colorScheme.onBackground&#10;                        )&#10;                    }&#10;&#10;                    // Play/Pause Button with Animation&#10;                    FloatingActionButton(&#10;                        onClick = { viewModel.togglePlayPause() },&#10;                        modifier = Modifier.size(72.dp),&#10;                        containerColor = MaterialTheme.colorScheme.primary&#10;                    ) {&#10;                        AnimatedContent(&#10;                            targetState = playbackState.isPlaying,&#10;                            transitionSpec = {&#10;                                scaleIn(&#10;                                    animationSpec = tween(150, easing = FastOutSlowInEasing)&#10;                                ) togetherWith scaleOut(&#10;                                    animationSpec = tween(150, easing = FastOutSlowInEasing)&#10;                                )&#10;                            },&#10;                            label = &quot;Play/Pause Icon&quot;&#10;                        ) { isPlaying -&gt;&#10;                            Icon(&#10;                                if (isPlaying) Icons.Default.Pause else Icons.Default.PlayArrow,&#10;                                contentDescription = if (isPlaying) &quot;Pause&quot; else &quot;Play&quot;,&#10;                                tint = MaterialTheme.colorScheme.onPrimary,&#10;                                modifier = Modifier.size(32.dp)&#10;                            )&#10;                        }&#10;                    }&#10;&#10;                    IconButton(&#10;                        onClick = { viewModel.skipToNext() },&#10;                        modifier = Modifier.size(56.dp)&#10;                    ) {&#10;                        Icon(&#10;                            Icons.Default.SkipNext,&#10;                            contentDescription = &quot;Next&quot;,&#10;                            tint = MaterialTheme.colorScheme.onBackground&#10;                        )&#10;                    }&#10;&#10;                    IconButton(&#10;                        onClick = { viewModel.toggleRepeat() },&#10;                        modifier = Modifier.size(48.dp)&#10;                    ) {&#10;                        Icon(&#10;                            when (playbackState.repeatMode) {&#10;                                PlaybackRepeatMode.ONE -&gt; Icons.Default.RepeatOne&#10;                                PlaybackRepeatMode.ALL -&gt; Icons.Default.Repeat&#10;                                else -&gt; Icons.Default.Repeat&#10;                            },&#10;                            contentDescription = &quot;Repeat&quot;,&#10;                            tint = if (playbackState.repeatMode != PlaybackRepeatMode.OFF)&#10;                                MaterialTheme.colorScheme.primary&#10;                            else&#10;                                MaterialTheme.colorScheme.onBackground.copy(alpha = 0.6f)&#10;                        )&#10;                    }&#10;                }&#10;            }&#10;&#10;            Spacer(modifier = Modifier.height(24.dp))&#10;&#10;            // Additional Controls&#10;            Row(&#10;                modifier = Modifier.fillMaxWidth(),&#10;                horizontalArrangement = Arrangement.SpaceEvenly&#10;            ) {&#10;                IconButton(onClick = { showEqualizer = true }) {&#10;                    Icon(&#10;                        Icons.Default.Equalizer,&#10;                        contentDescription = &quot;Equalizer&quot;,&#10;                        tint = MaterialTheme.colorScheme.onBackground.copy(alpha = 0.7f)&#10;                    )&#10;                }&#10;&#10;                IconButton(&#10;                    onClick = { showLyrics = !showLyrics },&#10;                    enabled = !uiState.lyrics.isNullOrBlank()&#10;                ) {&#10;                    Icon(&#10;                        Icons.Default.Lyrics,&#10;                        contentDescription = &quot;Lyrics&quot;,&#10;                        tint = if (!uiState.lyrics.isNullOrBlank())&#10;                            MaterialTheme.colorScheme.onBackground.copy(alpha = 0.7f)&#10;                        else&#10;                            MaterialTheme.colorScheme.onBackground.copy(alpha = 0.3f)&#10;                    )&#10;                }&#10;&#10;                IconButton(onClick = { viewModel.toggleFavorite() }) {&#10;                    Icon(&#10;                        if (uiState.currentMediaItem?.isFavorite == true)&#10;                            Icons.Default.Favorite&#10;                        else&#10;                            Icons.Default.FavoriteBorder,&#10;                        contentDescription = &quot;Favorite&quot;,&#10;                        tint = if (uiState.currentMediaItem?.isFavorite == true)&#10;                            Color.Red&#10;                        else&#10;                            MaterialTheme.colorScheme.onBackground.copy(alpha = 0.7f)&#10;                    )&#10;                }&#10;            }&#10;        }&#10;    }&#10;&#10;    // Equalizer Bottom Sheet&#10;    if (showEqualizer) {&#10;        EqualizerBottomSheet(&#10;            visible = true,&#10;            onDismiss = { showEqualizer = false }&#10;        ) {&#10;            // Equalizer content&#10;            Column(&#10;                modifier = Modifier&#10;                    .fillMaxWidth()&#10;                    .padding(16.dp)&#10;            ) {&#10;                Text(&#10;                    text = &quot;Equalizer&quot;,&#10;                    style = MaterialTheme.typography.headlineSmall,&#10;                    modifier = Modifier.padding(bottom = 16.dp)&#10;                )&#10;                // Add equalizer controls here&#10;                Text(&#10;                    text = &quot;Equalizer controls will be implemented here&quot;,&#10;                    style = MaterialTheme.typography.bodyMedium&#10;                )&#10;            }&#10;        }&#10;    }&#10;&#10;    // Lyrics Panel&#10;    if (showLyrics) {&#10;        LyricsPanel(&#10;            visible = true,&#10;            onDismiss = { showLyrics = false },&#10;            currentPosition = playbackState.playbackPosition,&#10;            lyrics = uiState.lyrics&#10;        )&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun formatTime(milliseconds: Long): String {&#10;    val seconds = (milliseconds / 1000) % 60&#10;    val minutes = (milliseconds / (1000 * 60)) % 60&#10;    val hours = (milliseconds / (1000 * 60 * 60)) % 24&#10;&#10;    return if (hours &gt; 0) {&#10;        String.format(Locale.getDefault(), &quot;%d:%02d:%02d&quot;, hours, minutes, seconds)&#10;    } else {&#10;        String.format(Locale.getDefault(), &quot;%02d:%02d&quot;, minutes, seconds)&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="// presentation/src/main/kotlin/com/tinhtx/player/screen/player/MusicPlayerScreen.kt&#10;package com.tinhtx.player.presentation.screen.player&#10;&#10;import androidx.compose.animation.AnimatedContent&#10;import androidx.compose.animation.scaleIn&#10;import androidx.compose.animation.scaleOut&#10;import androidx.compose.animation.core.FastOutSlowInEasing&#10;import androidx.compose.animation.core.LinearEasing&#10;import androidx.compose.animation.core.RepeatMode as AnimationRepeatMode&#10;import androidx.compose.animation.core.animateFloatAsState&#10;import androidx.compose.animation.core.infiniteRepeatable&#10;import androidx.compose.animation.core.tween&#10;import androidx.compose.animation.togetherWith&#10;import androidx.compose.foundation.background&#10;import androidx.compose.foundation.layout.Arrangement&#10;import androidx.compose.foundation.layout.Box&#10;import androidx.compose.foundation.layout.Column&#10;import androidx.compose.foundation.layout.Row&#10;import androidx.compose.foundation.layout.Spacer&#10;import androidx.compose.foundation.layout.fillMaxSize&#10;import androidx.compose.foundation.layout.fillMaxWidth&#10;import androidx.compose.foundation.layout.height&#10;import androidx.compose.foundation.layout.padding&#10;import androidx.compose.foundation.layout.size&#10;import androidx.compose.foundation.shape.RoundedCornerShape&#10;import androidx.compose.material.icons.Icons&#10;import androidx.compose.material.icons.automirrored.filled.ArrowBack&#10;import androidx.compose.material.icons.filled.Equalizer&#10;import androidx.compose.material.icons.filled.Favorite&#10;import androidx.compose.material.icons.filled.FavoriteBorder&#10;import androidx.compose.material.icons.filled.Lyrics&#10;import androidx.compose.material.icons.filled.MoreVert&#10;import androidx.compose.material.icons.filled.Pause&#10;import androidx.compose.material.icons.filled.PlayArrow&#10;import androidx.compose.material.icons.filled.Repeat&#10;import androidx.compose.material.icons.filled.RepeatOne&#10;import androidx.compose.material.icons.filled.Shuffle&#10;import androidx.compose.material.icons.filled.SkipNext&#10;import androidx.compose.material.icons.filled.SkipPrevious&#10;import androidx.compose.material3.ExperimentalMaterial3Api&#10;import androidx.compose.material3.FloatingActionButton&#10;import androidx.compose.material3.Icon&#10;import androidx.compose.material3.IconButton&#10;import androidx.compose.material3.MaterialTheme&#10;import androidx.compose.material3.Slider&#10;import androidx.compose.material3.SliderDefaults&#10;import androidx.compose.material3.Text&#10;import androidx.compose.runtime.Composable&#10;import androidx.compose.runtime.DisposableEffect&#10;import androidx.compose.runtime.LaunchedEffect&#10;import androidx.compose.runtime.collectAsStateWithLifecycle&#10;import androidx.compose.runtime.getValue&#10;import androidx.compose.runtime.mutableStateOf&#10;import androidx.compose.runtime.remember&#10;import androidx.compose.runtime.setValue&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.draw.clip&#10;import androidx.compose.ui.draw.rotate&#10;import androidx.compose.ui.draw.scale&#10;import androidx.compose.ui.graphics.Brush&#10;import androidx.compose.ui.graphics.Color&#10;import androidx.compose.ui.layout.ContentScale&#10;import androidx.compose.ui.res.painterResource&#10;import androidx.compose.ui.text.style.TextAlign&#10;import androidx.compose.ui.text.style.TextOverflow&#10;import androidx.compose.ui.unit.dp&#10;import androidx.hilt.navigation.compose.hiltViewModel&#10;import coil.compose.AsyncImage&#10;import com.tinhtx.player.domain.model.RepeatMode as PlaybackRepeatMode&#10;import com.tinhtx.player.domain.model.ShuffleMode&#10;import com.tinhtx.player.presentation.R&#10;import com.tinhtx.player.presentation.component.media.*&#10;import com.tinhtx.player.presentation.component.animation.FallingLeavesAnimation&#10;import com.tinhtx.player.presentation.component.animation.WaterWaveAnimation&#10;import com.tinhtx.player.presentation.component.animation.FlowerBloomAnimation&#10;import java.util.Locale&#10;&#10;@OptIn(ExperimentalMaterial3Api::class)&#10;@Composable&#10;fun MusicPlayerScreen(&#10;    mediaId: String,&#10;    onNavigateBack: () -&gt; Unit,&#10;    viewModel: MusicPlayerViewModel = hiltViewModel()&#10;) {&#10;    val uiState by viewModel.uiState.collectAsStateWithLifecycle()&#10;    val userPreferences by viewModel.userPreferences.collectAsStateWithLifecycle()&#10;    val playbackState by viewModel.playbackState.collectAsStateWithLifecycle()&#10;&#10;    var showEqualizer by remember { mutableStateOf(false) }&#10;    var showLyrics by remember { mutableStateOf(false) }&#10;&#10;    // Animation states&#10;    val albumArtRotation by animateFloatAsState(&#10;        targetValue = if (playbackState.isPlaying) 360f else 0f,&#10;        animationSpec = infiniteRepeatable(&#10;            animation = tween(10000, easing = LinearEasing),&#10;            repeatMode = AnimationRepeatMode.Restart&#10;        ),&#10;        label = &quot;Album Art Rotation&quot;&#10;    )&#10;&#10;    val pulseScale by animateFloatAsState(&#10;        targetValue = if (playbackState.isPlaying) 1.05f else 1f,&#10;        animationSpec = infiniteRepeatable(&#10;            animation = tween(1000, easing = FastOutSlowInEasing),&#10;            repeatMode = AnimationRepeatMode.Reverse&#10;        ),&#10;        label = &quot;Pulse Scale&quot;&#10;    )&#10;&#10;    LaunchedEffect(mediaId) {&#10;        // Kim tra k hn trc khi load v play&#10;        val currentState = viewModel.playbackState.value&#10;        val currentItem = currentState.currentItem&#10;&#10;        // Ch load nu:&#10;        // 1. Cha c currentItem, HOC&#10;        // 2. MediaId khc vi currentItem.id&#10;        if (currentItem == null || currentItem.id != mediaId) {&#10;            println(&quot;DEBUG: Loading new media - currentItem: ${currentItem?.id}, requested: $mediaId&quot;)&#10;            viewModel.loadAndPlayMediaItem(mediaId)&#10;        } else {&#10;            println(&quot;DEBUG: Media already loaded - currentItem: ${currentItem.id}, requested: $mediaId&quot;)&#10;            // Nu  c media ng ri, ch cn ensure UI ng b&#10;        }&#10;    }&#10;&#10;    // m bo broadcast state khi user navigate away khi MusicPlayerScreen&#10;    DisposableEffect(Unit) {&#10;        onDispose {&#10;            // Khi MusicPlayerScreen b dispose, broadcast state  MiniPlayerBar c th nhn c&#10;            viewModel.onNavigateAway()&#10;        }&#10;    }&#10;&#10;    Box(&#10;        modifier = Modifier&#10;            .fillMaxSize()&#10;            .background(&#10;                brush = Brush.verticalGradient(&#10;                    colors = listOf(&#10;                        MaterialTheme.colorScheme.primaryContainer.copy(alpha = 0.1f),&#10;                        MaterialTheme.colorScheme.background,&#10;                        MaterialTheme.colorScheme.surfaceVariant.copy(alpha = 0.1f)&#10;                    )&#10;                )&#10;            )&#10;    ) {&#10;        Column(&#10;            modifier = Modifier&#10;                .fillMaxSize()&#10;                .padding(16.dp),&#10;            horizontalAlignment = Alignment.CenterHorizontally&#10;        ) {&#10;            // Top Bar with Back Button&#10;            WaterWaveAnimation(&#10;                visible = true,&#10;                ageGroup = userPreferences.ageGroup&#10;            ) {&#10;                Row(&#10;                    modifier = Modifier.fillMaxWidth(),&#10;                    horizontalArrangement = Arrangement.SpaceBetween,&#10;                    verticalAlignment = Alignment.CenterVertically&#10;                ) {&#10;                    IconButton(onClick = onNavigateBack) {&#10;                        Icon(&#10;                            Icons.AutoMirrored.Filled.ArrowBack,&#10;                            contentDescription = &quot;Back&quot;,&#10;                            tint = MaterialTheme.colorScheme.onBackground&#10;                        )&#10;                    }&#10;&#10;                    Text(&#10;                        text = &quot;Now Playing&quot;,&#10;                        style = MaterialTheme.typography.headlineSmall,&#10;                        color = MaterialTheme.colorScheme.onBackground&#10;                    )&#10;&#10;                    IconButton(onClick = { /* More options */ }) {&#10;                        Icon(&#10;                            Icons.Default.MoreVert,&#10;                            contentDescription = &quot;More&quot;,&#10;                            tint = MaterialTheme.colorScheme.onBackground&#10;                        )&#10;                    }&#10;                }&#10;            }&#10;&#10;            Spacer(modifier = Modifier.height(32.dp))&#10;&#10;            // Album Art Section&#10;            FlowerBloomAnimation(&#10;                visible = uiState.currentMediaItem != null,&#10;                ageGroup = userPreferences.ageGroup&#10;            ) {&#10;                Box(&#10;                    modifier = Modifier&#10;                        .size(320.dp)&#10;                        .clip(RoundedCornerShape(userPreferences.ageGroup.cornerRadius)),&#10;                        // .background(&#10;                        //     brush = Brush.radialGradient(&#10;                        //         colors = listOf(&#10;                        //             MaterialTheme.colorScheme.primary.copy(alpha = 0.1f),&#10;                        //             MaterialTheme.colorScheme.secondary.copy(alpha = 0.05f)&#10;                        //         )&#10;                        //     )&#10;                        // )&#10;                        //.scale(pulseScale)&#10;                        //.rotate(albumArtRotation),&#10;                    contentAlignment = Alignment.Center&#10;                ) {&#10;                    AsyncImage(&#10;                        model = uiState.currentMediaItem?.albumArtUri,&#10;                        contentDescription = &quot;Album Art&quot;,&#10;                        modifier = Modifier&#10;                            .fillMaxSize()&#10;                            .clip(RoundedCornerShape(userPreferences.ageGroup.cornerRadius)),&#10;                        contentScale = ContentScale.Crop,&#10;                        error = painterResource(R.drawable.ic_placeholder),&#10;                        placeholder = painterResource(R.drawable.ic_placeholder)&#10;                    )&#10;                }&#10;            }&#10;&#10;            Spacer(modifier = Modifier.height(32.dp))&#10;&#10;            // Track Info&#10;            WaterWaveAnimation(&#10;                visible = uiState.currentMediaItem != null,&#10;                ageGroup = userPreferences.ageGroup&#10;            ) {&#10;                Column(&#10;                    horizontalAlignment = Alignment.CenterHorizontally&#10;                ) {&#10;                    Text(&#10;                        text = uiState.currentMediaItem?.title ?: &quot;Unknown Title&quot;,&#10;                        style = MaterialTheme.typography.headlineMedium,&#10;                        color = MaterialTheme.colorScheme.onBackground,&#10;                        textAlign = TextAlign.Center,&#10;                        maxLines = 2,&#10;                        overflow = TextOverflow.Ellipsis&#10;                    )&#10;&#10;                    Spacer(modifier = Modifier.height(8.dp))&#10;&#10;                    Text(&#10;                        text = uiState.currentMediaItem?.artist ?: &quot;Unknown Artist&quot;,&#10;                        style = MaterialTheme.typography.bodyLarge,&#10;                        color = MaterialTheme.colorScheme.onBackground.copy(alpha = 0.7f),&#10;                        textAlign = TextAlign.Center&#10;                    )&#10;                }&#10;            }&#10;&#10;            Spacer(modifier = Modifier.height(32.dp))&#10;&#10;            // Progress Bar&#10;            FallingLeavesAnimation(&#10;                visible = true,&#10;                ageGroup = userPreferences.ageGroup&#10;            ) {&#10;                Column {&#10;                    Slider(&#10;                        value = playbackState.playbackPosition.toFloat(),&#10;                        onValueChange = { viewModel.seekTo(it.toLong()) },&#10;                        valueRange = 0f..playbackState.duration.toFloat(),&#10;                        modifier = Modifier.fillMaxWidth(),&#10;                        colors = SliderDefaults.colors(&#10;                            thumbColor = MaterialTheme.colorScheme.primary,&#10;                            activeTrackColor = MaterialTheme.colorScheme.primary,&#10;                            inactiveTrackColor = MaterialTheme.colorScheme.primary.copy(alpha = 0.3f)&#10;                        )&#10;                    )&#10;&#10;                    Row(&#10;                        modifier = Modifier.fillMaxWidth(),&#10;                        horizontalArrangement = Arrangement.SpaceBetween&#10;                    ) {&#10;                        Text(&#10;                            text = formatTime(playbackState.playbackPosition),&#10;                            style = MaterialTheme.typography.bodySmall,&#10;                            color = MaterialTheme.colorScheme.onBackground.copy(alpha = 0.6f)&#10;                        )&#10;&#10;                        Text(&#10;                            text = formatTime(playbackState.duration),&#10;                            style = MaterialTheme.typography.bodySmall,&#10;                            color = MaterialTheme.colorScheme.onBackground.copy(alpha = 0.6f)&#10;                        )&#10;                    }&#10;                }&#10;            }&#10;&#10;            Spacer(modifier = Modifier.height(32.dp))&#10;&#10;            // Playback Controls&#10;            WaterWaveAnimation(&#10;                visible = true,&#10;                ageGroup = userPreferences.ageGroup&#10;            ) {&#10;                Row(&#10;                    modifier = Modifier.fillMaxWidth(),&#10;                    horizontalArrangement = Arrangement.SpaceEvenly,&#10;                    verticalAlignment = Alignment.CenterVertically&#10;                ) {&#10;                    IconButton(&#10;                        onClick = { viewModel.toggleShuffle() },&#10;                        modifier = Modifier.size(48.dp)&#10;                    ) {&#10;                        Icon(&#10;                            Icons.Default.Shuffle,&#10;                            contentDescription = &quot;Shuffle&quot;,&#10;                            tint = if (playbackState.shuffleMode == ShuffleMode.ON)&#10;                                MaterialTheme.colorScheme.primary&#10;                            else&#10;                                MaterialTheme.colorScheme.onBackground.copy(alpha = 0.6f)&#10;                        )&#10;                    }&#10;&#10;                    IconButton(&#10;                        onClick = { viewModel.skipToPrevious() },&#10;                        modifier = Modifier.size(56.dp)&#10;                    ) {&#10;                        Icon(&#10;                            Icons.Default.SkipPrevious,&#10;                            contentDescription = &quot;Previous&quot;,&#10;                            tint = MaterialTheme.colorScheme.onBackground&#10;                        )&#10;                    }&#10;&#10;                    // Play/Pause Button with Animation&#10;                    FloatingActionButton(&#10;                        onClick = { viewModel.togglePlayPause() },&#10;                        modifier = Modifier.size(72.dp),&#10;                        containerColor = MaterialTheme.colorScheme.primary&#10;                    ) {&#10;                        AnimatedContent(&#10;                            targetState = playbackState.isPlaying,&#10;                            transitionSpec = {&#10;                                scaleIn(&#10;                                    animationSpec = tween(150, easing = FastOutSlowInEasing)&#10;                                ) togetherWith scaleOut(&#10;                                    animationSpec = tween(150, easing = FastOutSlowInEasing)&#10;                                )&#10;                            },&#10;                            label = &quot;Play/Pause Icon&quot;&#10;                        ) { isPlaying -&gt;&#10;                            Icon(&#10;                                if (isPlaying) Icons.Default.Pause else Icons.Default.PlayArrow,&#10;                                contentDescription = if (isPlaying) &quot;Pause&quot; else &quot;Play&quot;,&#10;                                tint = MaterialTheme.colorScheme.onPrimary,&#10;                                modifier = Modifier.size(32.dp)&#10;                            )&#10;                        }&#10;                    }&#10;&#10;                    IconButton(&#10;                        onClick = { viewModel.skipToNext() },&#10;                        modifier = Modifier.size(56.dp)&#10;                    ) {&#10;                        Icon(&#10;                            Icons.Default.SkipNext,&#10;                            contentDescription = &quot;Next&quot;,&#10;                            tint = MaterialTheme.colorScheme.onBackground&#10;                        )&#10;                    }&#10;&#10;                    IconButton(&#10;                        onClick = { viewModel.toggleRepeat() },&#10;                        modifier = Modifier.size(48.dp)&#10;                    ) {&#10;                        Icon(&#10;                            when (playbackState.repeatMode) {&#10;                                PlaybackRepeatMode.ONE -&gt; Icons.Default.RepeatOne&#10;                                PlaybackRepeatMode.ALL -&gt; Icons.Default.Repeat&#10;                                else -&gt; Icons.Default.Repeat&#10;                            },&#10;                            contentDescription = &quot;Repeat&quot;,&#10;                            tint = if (playbackState.repeatMode != PlaybackRepeatMode.OFF)&#10;                                MaterialTheme.colorScheme.primary&#10;                            else&#10;                                MaterialTheme.colorScheme.onBackground.copy(alpha = 0.6f)&#10;                        )&#10;                    }&#10;                }&#10;            }&#10;&#10;            Spacer(modifier = Modifier.height(24.dp))&#10;&#10;            // Additional Controls&#10;            Row(&#10;                modifier = Modifier.fillMaxWidth(),&#10;                horizontalArrangement = Arrangement.SpaceEvenly&#10;            ) {&#10;                IconButton(onClick = { showEqualizer = true }) {&#10;                    Icon(&#10;                        Icons.Default.Equalizer,&#10;                        contentDescription = &quot;Equalizer&quot;,&#10;                        tint = MaterialTheme.colorScheme.onBackground.copy(alpha = 0.7f)&#10;                    )&#10;                }&#10;&#10;                IconButton(&#10;                    onClick = { showLyrics = !showLyrics },&#10;                    enabled = !uiState.lyrics.isNullOrBlank()&#10;                ) {&#10;                    Icon(&#10;                        Icons.Default.Lyrics,&#10;                        contentDescription = &quot;Lyrics&quot;,&#10;                        tint = if (!uiState.lyrics.isNullOrBlank())&#10;                            MaterialTheme.colorScheme.onBackground.copy(alpha = 0.7f)&#10;                        else&#10;                            MaterialTheme.colorScheme.onBackground.copy(alpha = 0.3f)&#10;                    )&#10;                }&#10;&#10;                IconButton(onClick = { viewModel.toggleFavorite() }) {&#10;                    Icon(&#10;                        if (uiState.currentMediaItem?.isFavorite == true)&#10;                            Icons.Default.Favorite&#10;                        else&#10;                            Icons.Default.FavoriteBorder,&#10;                        contentDescription = &quot;Favorite&quot;,&#10;                        tint = if (uiState.currentMediaItem?.isFavorite == true)&#10;                            Color.Red&#10;                        else&#10;                            MaterialTheme.colorScheme.onBackground.copy(alpha = 0.7f)&#10;                    )&#10;                }&#10;            }&#10;        }&#10;    }&#10;&#10;    // Equalizer Bottom Sheet&#10;    if (showEqualizer) {&#10;        EqualizerBottomSheet(&#10;            visible = true,&#10;            onDismiss = { showEqualizer = false }&#10;        ) {&#10;            // Equalizer content&#10;            Column(&#10;                modifier = Modifier&#10;                    .fillMaxWidth()&#10;                    .padding(16.dp)&#10;            ) {&#10;                Text(&#10;                    text = &quot;Equalizer&quot;,&#10;                    style = MaterialTheme.typography.headlineSmall,&#10;                    modifier = Modifier.padding(bottom = 16.dp)&#10;                )&#10;                // Add equalizer controls here&#10;                Text(&#10;                    text = &quot;Equalizer controls will be implemented here&quot;,&#10;                    style = MaterialTheme.typography.bodyMedium&#10;                )&#10;            }&#10;        }&#10;    }&#10;&#10;    // Lyrics Panel&#10;    if (showLyrics) {&#10;        LyricsPanel(&#10;            visible = true,&#10;            onDismiss = { showLyrics = false },&#10;            currentPosition = playbackState.playbackPosition,&#10;            lyrics = uiState.lyrics&#10;        )&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun formatTime(milliseconds: Long): String {&#10;    val seconds = (milliseconds / 1000) % 60&#10;    val minutes = (milliseconds / (1000 * 60)) % 60&#10;    val hours = (milliseconds / (1000 * 60 * 60)) % 24&#10;&#10;    return if (hours &gt; 0) {&#10;        String.format(Locale.getDefault(), &quot;%d:%02d:%02d&quot;, hours, minutes, seconds)&#10;    } else {&#10;        String.format(Locale.getDefault(), &quot;%02d:%02d&quot;, minutes, seconds)&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/presentation/src/main/java/com/tinhtx/player/presentation/screen/player/MusicPlayerViewModel.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/presentation/src/main/java/com/tinhtx/player/presentation/screen/player/MusicPlayerViewModel.kt" />
              <option name="originalContent" value="// presentation/src/main/kotlin/com/tinhtx/player/screen/player/MusicPlayerViewModel.kt&#10;package com.tinhtx.player.presentation.screen.player&#10;&#10;import android.content.Context&#10;import android.content.Intent&#10;import androidx.lifecycle.ViewModel&#10;import androidx.lifecycle.viewModelScope&#10;import com.tinhtx.player.domain.model.AgeGroup&#10;import com.tinhtx.player.domain.model.EqualizerSettings&#10;import com.tinhtx.player.domain.model.MediaItem&#10;import com.tinhtx.player.domain.model.MediaType&#10;import com.tinhtx.player.domain.model.PlaybackSettings&#10;import com.tinhtx.player.domain.model.PlaybackState&#10;import com.tinhtx.player.domain.model.PrivacySettings&#10;import com.tinhtx.player.domain.model.RepeatMode&#10;import com.tinhtx.player.domain.model.ShuffleMode&#10;import com.tinhtx.player.domain.model.ThemeMode&#10;import com.tinhtx.player.domain.model.UiSettings&#10;import com.tinhtx.player.domain.model.UserPreferences&#10;import com.tinhtx.player.domain.usecase.GetMediaItemsUseCase&#10;import com.tinhtx.player.domain.usecase.PlayMediaUseCase&#10;import com.tinhtx.player.media.playback.PlaybackService&#10;import dagger.hilt.android.lifecycle.HiltViewModel&#10;import dagger.hilt.android.qualifiers.ApplicationContext&#10;import kotlinx.coroutines.delay&#10;import kotlinx.coroutines.flow.MutableStateFlow&#10;import kotlinx.coroutines.flow.StateFlow&#10;import kotlinx.coroutines.flow.asStateFlow&#10;import kotlinx.coroutines.launch&#10;import javax.inject.Inject&#10;&#10;@HiltViewModel&#10;class MusicPlayerViewModel @Inject constructor(&#10;    @ApplicationContext private val context: Context,&#10;    private val getMediaItemsUseCase: GetMediaItemsUseCase,&#10;    private val playMediaUseCase: PlayMediaUseCase&#10;) : ViewModel() {&#10;&#10;    private val _uiState = MutableStateFlow(MusicPlayerUiState())&#10;    val uiState: StateFlow&lt;MusicPlayerUiState&gt; = _uiState.asStateFlow()&#10;&#10;    private val _playbackState = MutableStateFlow(PlaybackState())&#10;    val playbackState: StateFlow&lt;PlaybackState&gt; = _playbackState.asStateFlow()&#10;&#10;    private val _userPreferences = MutableStateFlow(&#10;        UserPreferences(&#10;            ageGroup = AgeGroup.ADULT,&#10;            themeMode = ThemeMode.SYSTEM,&#10;            primaryColor = null,&#10;            language = &quot;vi&quot;,&#10;            playbackSettings = PlaybackSettings(),&#10;            equalizerSettings = EqualizerSettings(),&#10;            uiSettings = UiSettings(),&#10;            privacySettings = PrivacySettings()&#10;        )&#10;    )&#10;    val userPreferences: StateFlow&lt;UserPreferences&gt; = _userPreferences.asStateFlow()&#10;&#10;    init {&#10;        // Start updating playback position&#10;        startPlaybackPositionUpdater()&#10;&#10;        // m bo broadcast state ngay khi ViewModel c khi to&#10;        //  MiniPlayerBar c th nhn c state hin ti&#10;        broadcastCurrentPlaybackState()&#10;    }&#10;&#10;    private fun startPlaybackPositionUpdater() {&#10;        viewModelScope.launch {&#10;            while (true) {&#10;                if (_playbackState.value.isPlaying) {&#10;                    val currentState = _playbackState.value&#10;                    val newPosition = (currentState.playbackPosition + 1000).coerceAtMost(currentState.duration)&#10;&#10;                    _playbackState.value = currentState.copy(&#10;                        playbackPosition = newPosition&#10;                    )&#10;&#10;                    // Auto pause when reached end&#10;                    if (newPosition &gt;= currentState.duration &amp;&amp; currentState.duration &gt; 0) {&#10;                        _playbackState.value = currentState.copy(&#10;                            isPlaying = false,&#10;                            playbackPosition = currentState.duration&#10;                        )&#10;                    }&#10;                }&#10;                delay(1000) // Update every second&#10;            }&#10;        }&#10;    }&#10;&#10;    fun loadAndPlayMediaItem(mediaId: String) {&#10;        viewModelScope.launch {&#10;            try {&#10;                getMediaItemsUseCase.getMediaItemById(mediaId).collect { mediaItem -&gt;&#10;                    if (mediaItem != null) {&#10;                        val currentState = _playbackState.value&#10;                        val currentItem = _uiState.value.currentMediaItem&#10;&#10;                        // Cp nht UI state trc&#10;                        val lyrics = extractLyricsFromAudioFile(mediaItem)&#10;                        _uiState.value = _uiState.value.copy(&#10;                            currentMediaItem = mediaItem,&#10;                            lyrics = lyrics&#10;                        )&#10;&#10;                        // CH play nu y l bi ht khc hoc cha c bi ht no ang pht&#10;                        if (currentItem == null || currentItem.id != mediaId) {&#10;                            println(&quot;DEBUG: Playing new media - currentItem: ${currentItem?.id}, requested: $mediaId&quot;)&#10;                            playMediaUseCase.playMediaItem(mediaItem)&#10;&#10;                            _playbackState.value = _playbackState.value.copy(&#10;                                currentItem = mediaItem,&#10;                                isPlaying = true,&#10;                                duration = 240000L, // 4 minutes sample duration&#10;                                playbackPosition = 0L&#10;                            )&#10;                        } else {&#10;                            println(&quot;DEBUG: Media already playing - currentItem: ${currentItem.id}, requested: $mediaId&quot;)&#10;                            // Nu bi ht  ang pht, ch cp nht UI m khng restart playback&#10;                            _playbackState.value = _playbackState.value.copy(&#10;                                currentItem = mediaItem&#10;                            )&#10;                        }&#10;&#10;                        // Start PlaybackService to show notification&#10;                        startPlaybackService()&#10;&#10;                        // Broadcast state cho MiniPlayerBar&#10;                        broadcastPlaybackState()&#10;                    }&#10;                }&#10;            } catch (_: Exception) {&#10;                // If use case fails, create sample data&#10;                loadSampleMediaItem(mediaId)&#10;            }&#10;        }&#10;    }&#10;&#10;    private fun loadSampleMediaItem(mediaId: String) {&#10;        val sampleMediaItem = MediaItem(&#10;            id = mediaId,&#10;            uri = &quot;content://media/external/audio/media/$mediaId&quot;,&#10;            displayName = &quot;Sample Song.mp3&quot;,&#10;            title = &quot;Sample Song&quot;,&#10;            artist = &quot;Sample Artist&quot;,&#10;            album = &quot;Sample Album&quot;,&#10;            duration = 240000L, // 4 minutes&#10;            size = 5242880L, // 5MB&#10;            dateAdded = System.currentTimeMillis(),&#10;            dateModified = System.currentTimeMillis(),&#10;            mimeType = &quot;audio/mpeg&quot;,&#10;            albumArtUri = null,&#10;            track = 1,&#10;            year = 2024,&#10;            genre = &quot;Pop&quot;,&#10;            bitrate = 320000,&#10;            sampleRate = 44100,&#10;            type = MediaType.AUDIO,&#10;            path = &quot;/storage/emulated/0/Music/sample.mp3&quot;,&#10;            isFavorite = false&#10;        )&#10;        &#10;        // Try to extract lyrics from the sample media item&#10;        val lyrics = extractLyricsFromAudioFile(sampleMediaItem)&#10;&#10;        _uiState.value = _uiState.value.copy(&#10;            currentMediaItem = sampleMediaItem,&#10;            lyrics = lyrics&#10;        )&#10;        &#10;        // Start PlaybackService to show notification&#10;        startPlaybackService()&#10;&#10;        _playbackState.value = _playbackState.value.copy(&#10;            currentItem = sampleMediaItem,&#10;            isPlaying = true,&#10;            duration = 240000L,&#10;            playbackPosition = 0L&#10;        )&#10;&#10;        // QUAN TRNG: Broadcast state cho MiniPlayerBar&#10;        broadcastPlaybackState()&#10;    }&#10;&#10;    private fun startPlaybackService() {&#10;        try {&#10;            val intent = Intent(context, PlaybackService::class.java)&#10;            context.startForegroundService(intent)&#10;        } catch (e: Exception) {&#10;            // Handle service start error&#10;        }&#10;    }&#10;&#10;    private fun broadcastPlaybackState() {&#10;        // Broadcast state  MiniPlayerBar c th nhn c&#10;        val intent = Intent(&quot;PLAYBACK_STATE_UPDATE&quot;)&#10;        val currentItem = _uiState.value.currentMediaItem&#10;        val playbackState = _playbackState.value&#10;&#10;        intent.putExtra(&quot;isPlaying&quot;, playbackState.isPlaying)&#10;        intent.putExtra(&quot;mediaId&quot;, currentItem?.id ?: &quot;&quot;)&#10;        intent.putExtra(&quot;title&quot;, currentItem?.title ?: &quot;&quot;)&#10;        intent.putExtra(&quot;artist&quot;, currentItem?.artist ?: &quot;&quot;)&#10;        intent.putExtra(&quot;albumArtUri&quot;, currentItem?.albumArtUri ?: &quot;&quot;)&#10;        intent.putExtra(&quot;position&quot;, playbackState.playbackPosition)&#10;        intent.putExtra(&quot;duration&quot;, playbackState.duration)&#10;        intent.putExtra(&quot;progress&quot;, playbackState.progress)&#10;&#10;        println(&quot;DEBUG: Broadcasting playback state - mediaId: ${currentItem?.id}, title: ${currentItem?.title}, isPlaying: ${playbackState.isPlaying}&quot;)&#10;        context.sendBroadcast(intent)&#10;    }&#10;&#10;    // Thm method  broadcast state hin ti&#10;    private fun broadcastCurrentPlaybackState() {&#10;        val currentItem = _uiState.value.currentMediaItem&#10;        val playbackState = _playbackState.value&#10;        &#10;        // Ch broadcast nu c currentItem&#10;        if (currentItem != null) {&#10;            broadcastPlaybackState()&#10;        }&#10;    }&#10;&#10;    // Thm method  maintain state khi navigate away&#10;    fun onNavigateAway() {&#10;        // m bo broadcast state khi user navigate away khi MusicPlayerScreen&#10;        broadcastCurrentPlaybackState()&#10;    }&#10;&#10;    private fun extractLyricsFromAudioFile(mediaItem: MediaItem): String? {&#10;        return try {&#10;            // Try to extract lyrics from audio file metadata&#10;            // This would typically use a library like JAudioTagger or similar&#10;            // For now, we'll simulate based on file name or path for demonstration&#10;&#10;            val fileName = mediaItem.displayName.lowercase()&#10;            val title = mediaItem.title?.lowercase() ?: &quot;&quot;&#10;&#10;            // Check if the file name or title suggests it might have lyrics&#10;            // In a real implementation, you would parse the audio file metadata&#10;            when {&#10;                fileName.contains(&quot;instrumental&quot;) || title.contains(&quot;instrumental&quot;) -&gt; null&#10;                fileName.contains(&quot;karaoke&quot;) || title.contains(&quot;karaoke&quot;) -&gt; null&#10;                mediaItem.path?.endsWith(&quot;.mp3&quot;) == true -&gt; {&#10;                    // Try to read ID3 tags for lyrics&#10;                    readID3Lyrics(mediaItem.path)&#10;                }&#10;                mediaItem.path?.endsWith(&quot;.flac&quot;) == true -&gt; {&#10;                    // Try to read FLAC metadata for lyrics&#10;                    readFLACLyrics(mediaItem.path)&#10;                }&#10;                else -&gt; null&#10;            }&#10;        } catch (e: Exception) {&#10;            // If extraction fails, return null (no lyrics)&#10;            null&#10;        }&#10;    }&#10;&#10;    private fun readID3Lyrics(filePath: String): String? {&#10;        return try {&#10;            // In a real implementation, you would use a library like JAudioTagger&#10;            // to read ID3 tags from MP3 files&#10;            // For demonstration, we'll return null (no lyrics found)&#10;&#10;            // Example implementation would be:&#10;            // val audioFile = AudioFileIO.read(File(filePath))&#10;            // val tag = audioFile.tag&#10;            // return tag?.getFirst(FieldKey.LYRICS)&#10;&#10;            null&#10;        } catch (e: Exception) {&#10;            null&#10;        }&#10;    }&#10;&#10;    private fun readFLACLyrics(filePath: String): String? {&#10;        return try {&#10;            // In a real implementation, you would use a library like JAudioTagger&#10;            // to read Vorbis comments from FLAC files&#10;            // For demonstration, we'll return null (no lyrics found)&#10;&#10;            null&#10;        } catch (e: Exception) {&#10;            null&#10;        }&#10;    }&#10;&#10;    fun togglePlayPause() {&#10;        val currentState = _playbackState.value&#10;        val newIsPlaying = !currentState.isPlaying&#10;        &#10;        if (newIsPlaying) {&#10;            playMediaUseCase.resume()&#10;        } else {&#10;            playMediaUseCase.pause()&#10;        }&#10;        &#10;        _playbackState.value = currentState.copy(isPlaying = newIsPlaying)&#10;    }&#10;&#10;    fun skipToNext() {&#10;        playMediaUseCase.skipToNext()&#10;        // Reset position for new track&#10;        _playbackState.value = _playbackState.value.copy(&#10;            playbackPosition = 0L&#10;        )&#10;    }&#10;&#10;    fun skipToPrevious() {&#10;        playMediaUseCase.skipToPrevious()&#10;        // Reset position for new track&#10;        _playbackState.value = _playbackState.value.copy(&#10;            playbackPosition = 0L&#10;        )&#10;    }&#10;&#10;    fun seekTo(position: Long) {&#10;        playMediaUseCase.seekTo(position)&#10;        _playbackState.value = _playbackState.value.copy(&#10;            playbackPosition = position&#10;        )&#10;    }&#10;&#10;    fun toggleRepeat() {&#10;        val newMode = when (playbackState.value.repeatMode) {&#10;            RepeatMode.OFF -&gt; RepeatMode.ALL&#10;            RepeatMode.ALL -&gt; RepeatMode.ONE&#10;            RepeatMode.ONE -&gt; RepeatMode.OFF&#10;        }&#10;        playMediaUseCase.setRepeatMode(newMode)&#10;        _playbackState.value = _playbackState.value.copy(repeatMode = newMode)&#10;    }&#10;&#10;    fun toggleShuffle() {&#10;        val newMode = if (playbackState.value.shuffleMode == ShuffleMode.OFF) ShuffleMode.ON else ShuffleMode.OFF&#10;        playMediaUseCase.setShuffleMode(newMode)&#10;        _playbackState.value = _playbackState.value.copy(shuffleMode = newMode)&#10;    }&#10;&#10;    fun toggleFavorite() {&#10;        viewModelScope.launch {&#10;            val currentItem = uiState.value.currentMediaItem&#10;            if (currentItem != null) {&#10;                val updatedItem = currentItem.copy(isFavorite = !currentItem.isFavorite)&#10;                _uiState.value = _uiState.value.copy(currentMediaItem = updatedItem)&#10;                playMediaUseCase.setFavorite(currentItem.id, updatedItem.isFavorite)&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;data class MusicPlayerUiState(&#10;    val currentMediaItem: MediaItem? = null, &#10;    val lyrics: String? = null&#10;)&#10;" />
              <option name="updatedContent" value="// presentation/src/main/kotlin/com/tinhtx/player/screen/player/MusicPlayerViewModel.kt&#10;package com.tinhtx.player.presentation.screen.player&#10;&#10;import android.content.BroadcastReceiver&#10;import android.content.Context&#10;import android.content.Intent&#10;import android.content.IntentFilter&#10;import android.os.Build&#10;import androidx.lifecycle.ViewModel&#10;import androidx.lifecycle.viewModelScope&#10;import com.tinhtx.player.domain.model.AgeGroup&#10;import com.tinhtx.player.domain.model.EqualizerSettings&#10;import com.tinhtx.player.domain.model.MediaItem&#10;import com.tinhtx.player.domain.model.MediaType&#10;import com.tinhtx.player.domain.model.PlaybackSettings&#10;import com.tinhtx.player.domain.model.PlaybackState&#10;import com.tinhtx.player.domain.model.PrivacySettings&#10;import com.tinhtx.player.domain.model.RepeatMode&#10;import com.tinhtx.player.domain.model.ShuffleMode&#10;import com.tinhtx.player.domain.model.ThemeMode&#10;import com.tinhtx.player.domain.model.UiSettings&#10;import com.tinhtx.player.domain.model.UserPreferences&#10;import com.tinhtx.player.domain.usecase.GetMediaItemsUseCase&#10;import com.tinhtx.player.domain.usecase.PlayMediaUseCase&#10;import com.tinhtx.player.media.playback.PlaybackService&#10;import dagger.hilt.android.lifecycle.HiltViewModel&#10;import dagger.hilt.android.qualifiers.ApplicationContext&#10;import kotlinx.coroutines.delay&#10;import kotlinx.coroutines.flow.MutableStateFlow&#10;import kotlinx.coroutines.flow.StateFlow&#10;import kotlinx.coroutines.flow.asStateFlow&#10;import kotlinx.coroutines.launch&#10;import javax.inject.Inject&#10;&#10;@HiltViewModel&#10;class MusicPlayerViewModel @Inject constructor(&#10;    @ApplicationContext private val context: Context,&#10;    private val getMediaItemsUseCase: GetMediaItemsUseCase,&#10;    private val playMediaUseCase: PlayMediaUseCase&#10;) : ViewModel() {&#10;&#10;    private val _uiState = MutableStateFlow(MusicPlayerUiState())&#10;    val uiState: StateFlow&lt;MusicPlayerUiState&gt; = _uiState.asStateFlow()&#10;&#10;    private val _playbackState = MutableStateFlow(PlaybackState())&#10;    val playbackState: StateFlow&lt;PlaybackState&gt; = _playbackState.asStateFlow()&#10;&#10;    private val _userPreferences = MutableStateFlow(&#10;        UserPreferences(&#10;            ageGroup = AgeGroup.ADULT,&#10;            themeMode = ThemeMode.SYSTEM,&#10;            primaryColor = null,&#10;            language = &quot;vi&quot;,&#10;            playbackSettings = PlaybackSettings(),&#10;            equalizerSettings = EqualizerSettings(),&#10;            uiSettings = UiSettings(),&#10;            privacySettings = PrivacySettings()&#10;        )&#10;    )&#10;    val userPreferences: StateFlow&lt;UserPreferences&gt; = _userPreferences.asStateFlow()&#10;&#10;    // Thm broadcast receiver  respond li request t PlaybackViewModel&#10;    private val stateRequestReceiver = object : BroadcastReceiver() {&#10;        override fun onReceive(context: Context?, intent: Intent?) {&#10;            when (intent?.action) {&#10;                &quot;REQUEST_PLAYBACK_STATE&quot; -&gt; {&#10;                    println(&quot;DEBUG: MusicPlayerViewModel received request for current state&quot;)&#10;                    // Broadcast current state ngay lp tc&#10;                    broadcastCurrentPlaybackState()&#10;                }&#10;            }&#10;        }&#10;    }&#10;&#10;    init {&#10;        // Start updating playback position&#10;        startPlaybackPositionUpdater()&#10;&#10;        // ng k broadcast receiver  respond li request&#10;        registerStateRequestReceiver()&#10;&#10;        // m bo broadcast state ngay khi ViewModel c khi to&#10;        //  MiniPlayerBar c th nhn c state hin ti&#10;        broadcastCurrentPlaybackState()&#10;    }&#10;&#10;    private fun registerStateRequestReceiver() {&#10;        try {&#10;            val filter = IntentFilter(&quot;REQUEST_PLAYBACK_STATE&quot;)&#10;            if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.TIRAMISU) {&#10;                context.registerReceiver(stateRequestReceiver, filter, Context.RECEIVER_NOT_EXPORTED)&#10;            } else {&#10;                context.registerReceiver(stateRequestReceiver, filter)&#10;            }&#10;            println(&quot;DEBUG: MusicPlayerViewModel state request receiver registered&quot;)&#10;        } catch (e: Exception) {&#10;            println(&quot;DEBUG: Failed to register state request receiver: ${e.message}&quot;)&#10;        }&#10;    }&#10;&#10;    private fun startPlaybackPositionUpdater() {&#10;        viewModelScope.launch {&#10;            while (true) {&#10;                if (_playbackState.value.isPlaying) {&#10;                    val currentState = _playbackState.value&#10;                    val newPosition = (currentState.playbackPosition + 1000).coerceAtMost(currentState.duration)&#10;&#10;                    _playbackState.value = currentState.copy(&#10;                        playbackPosition = newPosition&#10;                    )&#10;&#10;                    // Auto pause when reached end&#10;                    if (newPosition &gt;= currentState.duration &amp;&amp; currentState.duration &gt; 0) {&#10;                        _playbackState.value = currentState.copy(&#10;                            isPlaying = false,&#10;                            playbackPosition = currentState.duration&#10;                        )&#10;                    }&#10;                }&#10;                delay(1000) // Update every second&#10;            }&#10;        }&#10;    }&#10;&#10;    fun loadAndPlayMediaItem(mediaId: String) {&#10;        viewModelScope.launch {&#10;            try {&#10;                getMediaItemsUseCase.getMediaItemById(mediaId).collect { mediaItem -&gt;&#10;                    if (mediaItem != null) {&#10;                        val currentState = _playbackState.value&#10;                        val currentItem = _uiState.value.currentMediaItem&#10;&#10;                        // Cp nht UI state trc&#10;                        val lyrics = extractLyricsFromAudioFile(mediaItem)&#10;                        _uiState.value = _uiState.value.copy(&#10;                            currentMediaItem = mediaItem,&#10;                            lyrics = lyrics&#10;                        )&#10;&#10;                        // CH play nu y l bi ht khc hoc cha c bi ht no ang pht&#10;                        if (currentItem == null || currentItem.id != mediaId) {&#10;                            println(&quot;DEBUG: Playing new media - currentItem: ${currentItem?.id}, requested: $mediaId&quot;)&#10;                            playMediaUseCase.playMediaItem(mediaItem)&#10;&#10;                            _playbackState.value = _playbackState.value.copy(&#10;                                currentItem = mediaItem,&#10;                                isPlaying = true,&#10;                                duration = 240000L, // 4 minutes sample duration&#10;                                playbackPosition = 0L&#10;                            )&#10;                        } else {&#10;                            println(&quot;DEBUG: Media already playing - currentItem: ${currentItem.id}, requested: $mediaId&quot;)&#10;                            // Nu bi ht  ang pht, ch cp nht UI m khng restart playback&#10;                            _playbackState.value = _playbackState.value.copy(&#10;                                currentItem = mediaItem&#10;                            )&#10;                        }&#10;&#10;                        // Start PlaybackService to show notification&#10;                        startPlaybackService()&#10;&#10;                        // Broadcast state cho MiniPlayerBar&#10;                        broadcastPlaybackState()&#10;                    }&#10;                }&#10;            } catch (_: Exception) {&#10;                // If use case fails, create sample data&#10;                loadSampleMediaItem(mediaId)&#10;            }&#10;        }&#10;    }&#10;&#10;    private fun loadSampleMediaItem(mediaId: String) {&#10;        val sampleMediaItem = MediaItem(&#10;            id = mediaId,&#10;            uri = &quot;content://media/external/audio/media/$mediaId&quot;,&#10;            displayName = &quot;Sample Song.mp3&quot;,&#10;            title = &quot;Sample Song&quot;,&#10;            artist = &quot;Sample Artist&quot;,&#10;            album = &quot;Sample Album&quot;,&#10;            duration = 240000L, // 4 minutes&#10;            size = 5242880L, // 5MB&#10;            dateAdded = System.currentTimeMillis(),&#10;            dateModified = System.currentTimeMillis(),&#10;            mimeType = &quot;audio/mpeg&quot;,&#10;            albumArtUri = null,&#10;            track = 1,&#10;            year = 2024,&#10;            genre = &quot;Pop&quot;,&#10;            bitrate = 320000,&#10;            sampleRate = 44100,&#10;            type = MediaType.AUDIO,&#10;            path = &quot;/storage/emulated/0/Music/sample.mp3&quot;,&#10;            isFavorite = false&#10;        )&#10;        &#10;        // Try to extract lyrics from the sample media item&#10;        val lyrics = extractLyricsFromAudioFile(sampleMediaItem)&#10;&#10;        _uiState.value = _uiState.value.copy(&#10;            currentMediaItem = sampleMediaItem,&#10;            lyrics = lyrics&#10;        )&#10;        &#10;        // Start PlaybackService to show notification&#10;        startPlaybackService()&#10;&#10;        _playbackState.value = _playbackState.value.copy(&#10;            currentItem = sampleMediaItem,&#10;            isPlaying = true,&#10;            duration = 240000L,&#10;            playbackPosition = 0L&#10;        )&#10;&#10;        // QUAN TRNG: Broadcast state cho MiniPlayerBar&#10;        broadcastPlaybackState()&#10;    }&#10;&#10;    private fun startPlaybackService() {&#10;        try {&#10;            val intent = Intent(context, PlaybackService::class.java)&#10;            context.startForegroundService(intent)&#10;        } catch (e: Exception) {&#10;            // Handle service start error&#10;        }&#10;    }&#10;&#10;    private fun broadcastPlaybackState() {&#10;        // Broadcast state  MiniPlayerBar c th nhn c&#10;        val intent = Intent(&quot;PLAYBACK_STATE_UPDATE&quot;)&#10;        val currentItem = _uiState.value.currentMediaItem&#10;        val playbackState = _playbackState.value&#10;&#10;        intent.putExtra(&quot;isPlaying&quot;, playbackState.isPlaying)&#10;        intent.putExtra(&quot;mediaId&quot;, currentItem?.id ?: &quot;&quot;)&#10;        intent.putExtra(&quot;title&quot;, currentItem?.title ?: &quot;&quot;)&#10;        intent.putExtra(&quot;artist&quot;, currentItem?.artist ?: &quot;&quot;)&#10;        intent.putExtra(&quot;albumArtUri&quot;, currentItem?.albumArtUri ?: &quot;&quot;)&#10;        intent.putExtra(&quot;position&quot;, playbackState.playbackPosition)&#10;        intent.putExtra(&quot;duration&quot;, playbackState.duration)&#10;        intent.putExtra(&quot;progress&quot;, playbackState.progress)&#10;&#10;        println(&quot;DEBUG: Broadcasting playback state - mediaId: ${currentItem?.id}, title: ${currentItem?.title}, isPlaying: ${playbackState.isPlaying}&quot;)&#10;        context.sendBroadcast(intent)&#10;    }&#10;&#10;    // Thm method  broadcast state hin ti&#10;    private fun broadcastCurrentPlaybackState() {&#10;        val currentItem = _uiState.value.currentMediaItem&#10;        val playbackState = _playbackState.value&#10;        &#10;        // Ch broadcast nu c currentItem&#10;        if (currentItem != null) {&#10;            broadcastPlaybackState()&#10;        }&#10;    }&#10;&#10;    // Thm method  maintain state khi navigate away&#10;    fun onNavigateAway() {&#10;        // m bo broadcast state khi user navigate away khi MusicPlayerScreen&#10;        broadcastCurrentPlaybackState()&#10;    }&#10;&#10;    private fun extractLyricsFromAudioFile(mediaItem: MediaItem): String? {&#10;        return try {&#10;            // Try to extract lyrics from audio file metadata&#10;            // This would typically use a library like JAudioTagger or similar&#10;            // For now, we'll simulate based on file name or path for demonstration&#10;&#10;            val fileName = mediaItem.displayName.lowercase()&#10;            val title = mediaItem.title?.lowercase() ?: &quot;&quot;&#10;&#10;            // Check if the file name or title suggests it might have lyrics&#10;            // In a real implementation, you would parse the audio file metadata&#10;            when {&#10;                fileName.contains(&quot;instrumental&quot;) || title.contains(&quot;instrumental&quot;) -&gt; null&#10;                fileName.contains(&quot;karaoke&quot;) || title.contains(&quot;karaoke&quot;) -&gt; null&#10;                mediaItem.path?.endsWith(&quot;.mp3&quot;) == true -&gt; {&#10;                    // Try to read ID3 tags for lyrics&#10;                    readID3Lyrics(mediaItem.path)&#10;                }&#10;                mediaItem.path?.endsWith(&quot;.flac&quot;) == true -&gt; {&#10;                    // Try to read FLAC metadata for lyrics&#10;                    readFLACLyrics(mediaItem.path)&#10;                }&#10;                else -&gt; null&#10;            }&#10;        } catch (e: Exception) {&#10;            // If extraction fails, return null (no lyrics)&#10;            null&#10;        }&#10;    }&#10;&#10;    private fun readID3Lyrics(filePath: String): String? {&#10;        return try {&#10;            // In a real implementation, you would use a library like JAudioTagger&#10;            // to read ID3 tags from MP3 files&#10;            // For demonstration, we'll return null (no lyrics found)&#10;&#10;            // Example implementation would be:&#10;            // val audioFile = AudioFileIO.read(File(filePath))&#10;            // val tag = audioFile.tag&#10;            // return tag?.getFirst(FieldKey.LYRICS)&#10;&#10;            null&#10;        } catch (e: Exception) {&#10;            null&#10;        }&#10;    }&#10;&#10;    private fun readFLACLyrics(filePath: String): String? {&#10;        return try {&#10;            // In a real implementation, you would use a library like JAudioTagger&#10;            // to read Vorbis comments from FLAC files&#10;            // For demonstration, we'll return null (no lyrics found)&#10;&#10;            null&#10;        } catch (e: Exception) {&#10;            null&#10;        }&#10;    }&#10;&#10;    fun togglePlayPause() {&#10;        val currentState = _playbackState.value&#10;        val newIsPlaying = !currentState.isPlaying&#10;        &#10;        if (newIsPlaying) {&#10;            playMediaUseCase.resume()&#10;        } else {&#10;            playMediaUseCase.pause()&#10;        }&#10;        &#10;        _playbackState.value = currentState.copy(isPlaying = newIsPlaying)&#10;    }&#10;&#10;    fun skipToNext() {&#10;        playMediaUseCase.skipToNext()&#10;        // Reset position for new track&#10;        _playbackState.value = _playbackState.value.copy(&#10;            playbackPosition = 0L&#10;        )&#10;    }&#10;&#10;    fun skipToPrevious() {&#10;        playMediaUseCase.skipToPrevious()&#10;        // Reset position for new track&#10;        _playbackState.value = _playbackState.value.copy(&#10;            playbackPosition = 0L&#10;        )&#10;    }&#10;&#10;    fun seekTo(position: Long) {&#10;        playMediaUseCase.seekTo(position)&#10;        _playbackState.value = _playbackState.value.copy(&#10;            playbackPosition = position&#10;        )&#10;    }&#10;&#10;    fun toggleRepeat() {&#10;        val newMode = when (playbackState.value.repeatMode) {&#10;            RepeatMode.OFF -&gt; RepeatMode.ALL&#10;            RepeatMode.ALL -&gt; RepeatMode.ONE&#10;            RepeatMode.ONE -&gt; RepeatMode.OFF&#10;        }&#10;        playMediaUseCase.setRepeatMode(newMode)&#10;        _playbackState.value = _playbackState.value.copy(repeatMode = newMode)&#10;    }&#10;&#10;    fun toggleShuffle() {&#10;        val newMode = if (playbackState.value.shuffleMode == ShuffleMode.OFF) ShuffleMode.ON else ShuffleMode.OFF&#10;        playMediaUseCase.setShuffleMode(newMode)&#10;        _playbackState.value = _playbackState.value.copy(shuffleMode = newMode)&#10;    }&#10;&#10;    fun toggleFavorite() {&#10;        viewModelScope.launch {&#10;            val currentItem = uiState.value.currentMediaItem&#10;            if (currentItem != null) {&#10;                val updatedItem = currentItem.copy(isFavorite = !currentItem.isFavorite)&#10;                _uiState.value = _uiState.value.copy(currentMediaItem = updatedItem)&#10;                playMediaUseCase.setFavorite(currentItem.id, updatedItem.isFavorite)&#10;            }&#10;        }&#10;    }&#10;&#10;    override fun onCleared() {&#10;        try {&#10;            context.unregisterReceiver(stateRequestReceiver)&#10;        } catch (e: Exception) {&#10;            println(&quot;DEBUG: Error unregistering state request receiver: ${e.message}&quot;)&#10;        }&#10;        super.onCleared()&#10;    }&#10;}&#10;&#10;data class MusicPlayerUiState(&#10;    val currentMediaItem: MediaItem? = null, &#10;    val lyrics: String? = null&#10;)" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/presentation/src/main/java/com/tinhtx/player/presentation/screen/player/PlaybackViewModel.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/presentation/src/main/java/com/tinhtx/player/presentation/screen/player/PlaybackViewModel.kt" />
              <option name="originalContent" value="package com.tinhtx.player.presentation.screen.player&#10;&#10;import android.content.BroadcastReceiver&#10;import android.content.Context&#10;import android.content.Intent&#10;import android.content.IntentFilter&#10;import android.os.Build&#10;import androidx.lifecycle.ViewModel&#10;import androidx.lifecycle.viewModelScope&#10;import com.tinhtx.player.domain.model.MediaItem&#10;import com.tinhtx.player.domain.model.MediaType&#10;import com.tinhtx.player.domain.model.PlaybackState&#10;import com.tinhtx.player.domain.usecase.PlayMediaUseCase&#10;import dagger.hilt.android.lifecycle.HiltViewModel&#10;import dagger.hilt.android.qualifiers.ApplicationContext&#10;import kotlinx.coroutines.flow.MutableStateFlow&#10;import kotlinx.coroutines.flow.asStateFlow&#10;import kotlinx.coroutines.launch&#10;import javax.inject.Inject&#10;&#10;@HiltViewModel&#10;class PlaybackViewModel @Inject constructor(&#10;    private val playMediaUseCase: PlayMediaUseCase,&#10;    @ApplicationContext private val context: Context&#10;) : ViewModel() {&#10;&#10;    private val _playbackState = MutableStateFlow(PlaybackState())&#10;    val playbackState = _playbackState.asStateFlow()&#10;&#10;    private val stateReceiver = object : BroadcastReceiver() {&#10;        override fun onReceive(context: Context?, intent: Intent?) {&#10;            println(&quot;DEBUG: PlaybackViewModel received broadcast!&quot;)&#10;&#10;            val isPlaying = intent?.getBooleanExtra(&quot;isPlaying&quot;, false) ?: false&#10;            val mediaId = intent?.getStringExtra(&quot;mediaId&quot;) ?: &quot;&quot;&#10;            val title = intent?.getStringExtra(&quot;title&quot;) ?: &quot;&quot;&#10;            val artist = intent?.getStringExtra(&quot;artist&quot;) ?: &quot;&quot;&#10;            val albumArtUri = intent?.getStringExtra(&quot;albumArtUri&quot;) ?: &quot;&quot;&#10;            val position = intent?.getLongExtra(&quot;position&quot;, 0L) ?: 0L&#10;            val duration = intent?.getLongExtra(&quot;duration&quot;, 0L) ?: 0L&#10;            val progress = intent?.getFloatExtra(&quot;progress&quot;, 0f) ?: 0f&#10;&#10;            println(&quot;DEBUG: Received broadcast - mediaId: $mediaId, title: $title, isPlaying: $isPlaying&quot;)&#10;&#10;            // To MediaItem t broadcast data&#10;            val mediaItem = if (mediaId.isNotEmpty()) {&#10;                MediaItem(&#10;                    id = mediaId,&#10;                    title = title,&#10;                    artist = artist,&#10;                    album = &quot;Unknown Album&quot;,&#10;                    duration = duration,&#10;                    uri = &quot;content://media/external/audio/media/$mediaId&quot;,&#10;                    albumArtUri = albumArtUri.takeIf { it.isNotEmpty() },&#10;                    type = MediaType.AUDIO,&#10;                    isFavorite = false,&#10;                    displayName = &quot;$title.mp3&quot;,&#10;                    size = 5242880L,&#10;                    dateAdded = System.currentTimeMillis(),&#10;                    dateModified = System.currentTimeMillis(),&#10;                    mimeType = &quot;audio/mpeg&quot;,&#10;                    track = 1,&#10;                    year = 2024,&#10;                    genre = &quot;Pop&quot;,&#10;                    bitrate = 320000,&#10;                    sampleRate = 44100,&#10;                    path = &quot;/storage/emulated/0/Music/$title.mp3&quot;&#10;                )&#10;            } else null&#10;&#10;            println(&quot;DEBUG: Created MediaItem: ${mediaItem?.title}, currentItem before update: ${_playbackState.value.currentItem?.title}&quot;)&#10;&#10;            _playbackState.value = _playbackState.value.copy(&#10;                currentItem = mediaItem,&#10;                isPlaying = isPlaying,&#10;                playbackPosition = position,&#10;                duration = duration,&#10;                progress = progress&#10;            )&#10;&#10;            println(&quot;DEBUG: Updated playback state, currentItem after update: ${_playbackState.value.currentItem?.title}&quot;)&#10;        }&#10;    }&#10;&#10;    init {&#10;        println(&quot;DEBUG: PlaybackViewModel init - registering broadcast receiver&quot;)&#10;&#10;        if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.TIRAMISU) {&#10;            context.registerReceiver(&#10;                stateReceiver,&#10;                IntentFilter(&quot;PLAYBACK_STATE_UPDATE&quot;),&#10;                Context.RECEIVER_NOT_EXPORTED&#10;            )&#10;        } else {&#10;            context.registerReceiver(&#10;                stateReceiver,&#10;                IntentFilter(&quot;PLAYBACK_STATE_UPDATE&quot;)&#10;            )&#10;        }&#10;&#10;        println(&quot;DEBUG: PlaybackViewModel broadcast receiver registered successfully&quot;)&#10;    }&#10;&#10;    fun play(mediaItem: MediaItem) {&#10;        viewModelScope.launch {&#10;            playMediaUseCase.playMediaItem(mediaItem)&#10;            _playbackState.value = _playbackState.value.copy(&#10;                currentItem = mediaItem,&#10;                isPlaying = true,&#10;                progress = 0f&#10;            )&#10;        }&#10;    }&#10;&#10;    fun togglePlayPause() {&#10;        val current = _playbackState.value&#10;        _playbackState.value = current.copy(isPlaying = !current.isPlaying)&#10;    }&#10;&#10;    fun stop() {&#10;        _playbackState.value = PlaybackState()&#10;    }&#10;&#10;    fun updateProgress(position: Long, duration: Long) {&#10;        val progress = if (duration &gt; 0) position.toFloat() / duration else 0f&#10;        _playbackState.value = _playbackState.value.copy(&#10;            playbackPosition = position,&#10;            duration = duration,&#10;            progress = progress&#10;        )&#10;    }&#10;&#10;    fun loadAndPlayMediaItem(mediaId: String) {&#10;        viewModelScope.launch {&#10;            try {&#10;                // Gi s c cch ly MediaItem t mediaId&#10;                // Tm thi to MediaItem dummy  test&#10;                val mediaItem = createDummyMediaItem(mediaId)&#10;                play(mediaItem)&#10;            } catch (e: Exception) {&#10;                println(&quot;Error loading media: ${e.message}&quot;)&#10;            }&#10;        }&#10;    }&#10;&#10;    private fun createDummyMediaItem(mediaId: String): MediaItem {&#10;        return MediaItem(&#10;            id = mediaId,&#10;            title = &quot;Sample Song&quot;,&#10;            artist = &quot;Sample Artist&quot;,&#10;            album = &quot;Sample Album&quot;,&#10;            duration = 240000L, // 4 minutes&#10;            uri = &quot;content://media/external/audio/media/$mediaId&quot;,&#10;            albumArtUri = null,&#10;            type = MediaType.AUDIO,&#10;            isFavorite = false,&#10;            displayName = &quot;Sample Song.mp3&quot;,&#10;            size = 5242880L,&#10;            dateAdded = System.currentTimeMillis(),&#10;            dateModified = System.currentTimeMillis(),&#10;            mimeType = &quot;audio/mpeg&quot;,&#10;            track = 1,&#10;            year = 2024,&#10;            genre = &quot;Pop&quot;,&#10;            bitrate = 320000,&#10;            sampleRate = 44100,&#10;            path = &quot;/storage/emulated/0/Music/sample.mp3&quot;&#10;        )&#10;    }&#10;&#10;    override fun onCleared() {&#10;        context.unregisterReceiver(stateReceiver)&#10;        super.onCleared()&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.tinhtx.player.presentation.screen.player&#10;&#10;import android.content.BroadcastReceiver&#10;import android.content.Context&#10;import android.content.Intent&#10;import android.content.IntentFilter&#10;import android.os.Build&#10;import androidx.lifecycle.ViewModel&#10;import androidx.lifecycle.viewModelScope&#10;import com.tinhtx.player.domain.model.MediaItem&#10;import com.tinhtx.player.domain.model.MediaType&#10;import com.tinhtx.player.domain.model.PlaybackState&#10;import com.tinhtx.player.domain.usecase.PlayMediaUseCase&#10;import dagger.hilt.android.lifecycle.HiltViewModel&#10;import dagger.hilt.android.qualifiers.ApplicationContext&#10;import kotlinx.coroutines.flow.MutableStateFlow&#10;import kotlinx.coroutines.flow.asStateFlow&#10;import kotlinx.coroutines.launch&#10;import javax.inject.Inject&#10;&#10;@HiltViewModel&#10;class PlaybackViewModel @Inject constructor(&#10;    private val playMediaUseCase: PlayMediaUseCase,&#10;    @ApplicationContext private val context: Context&#10;) : ViewModel() {&#10;&#10;    private val _playbackState = MutableStateFlow(PlaybackState())&#10;    val playbackState = _playbackState.asStateFlow()&#10;&#10;    // Thm flag  check xem  init cha&#10;    private var isInitialized = false&#10;&#10;    private val stateReceiver = object : BroadcastReceiver() {&#10;        override fun onReceive(context: Context?, intent: Intent?) {&#10;            println(&quot;DEBUG: PlaybackViewModel received broadcast!&quot;)&#10;&#10;            val isPlaying = intent?.getBooleanExtra(&quot;isPlaying&quot;, false) ?: false&#10;            val mediaId = intent?.getStringExtra(&quot;mediaId&quot;) ?: &quot;&quot;&#10;            val title = intent?.getStringExtra(&quot;title&quot;) ?: &quot;&quot;&#10;            val artist = intent?.getStringExtra(&quot;artist&quot;) ?: &quot;&quot;&#10;            val albumArtUri = intent?.getStringExtra(&quot;albumArtUri&quot;) ?: &quot;&quot;&#10;            val position = intent?.getLongExtra(&quot;position&quot;, 0L) ?: 0L&#10;            val duration = intent?.getLongExtra(&quot;duration&quot;, 0L) ?: 0L&#10;            val progress = intent?.getFloatExtra(&quot;progress&quot;, 0f) ?: 0f&#10;&#10;            println(&quot;DEBUG: Received broadcast - mediaId: $mediaId, title: $title, isPlaying: $isPlaying&quot;)&#10;&#10;            // To MediaItem t broadcast data&#10;            val mediaItem = if (mediaId.isNotEmpty()) {&#10;                MediaItem(&#10;                    id = mediaId,&#10;                    title = title,&#10;                    artist = artist,&#10;                    album = &quot;Unknown Album&quot;,&#10;                    duration = duration,&#10;                    uri = &quot;content://media/external/audio/media/$mediaId&quot;,&#10;                    albumArtUri = albumArtUri.takeIf { it.isNotEmpty() },&#10;                    type = MediaType.AUDIO,&#10;                    isFavorite = false,&#10;                    displayName = &quot;$title.mp3&quot;,&#10;                    size = 5242880L,&#10;                    dateAdded = System.currentTimeMillis(),&#10;                    dateModified = System.currentTimeMillis(),&#10;                    mimeType = &quot;audio/mpeg&quot;,&#10;                    track = 1,&#10;                    year = 2024,&#10;                    genre = &quot;Pop&quot;,&#10;                    bitrate = 320000,&#10;                    sampleRate = 44100,&#10;                    path = &quot;/storage/emulated/0/Music/$title.mp3&quot;&#10;                )&#10;            } else null&#10;&#10;            println(&quot;DEBUG: Created MediaItem: ${mediaItem?.title}, currentItem before update: ${_playbackState.value.currentItem?.title}&quot;)&#10;&#10;            _playbackState.value = _playbackState.value.copy(&#10;                currentItem = mediaItem,&#10;                isPlaying = isPlaying,&#10;                playbackPosition = position,&#10;                duration = duration,&#10;                progress = progress&#10;            )&#10;&#10;            println(&quot;DEBUG: Updated playback state, currentItem after update: ${_playbackState.value.currentItem?.title}&quot;)&#10;        }&#10;    }&#10;&#10;    init {&#10;        println(&quot;DEBUG: PlaybackViewModel init - registering broadcast receiver&quot;)&#10;        registerBroadcastReceiver()&#10;        &#10;        // Request current state nu c MusicPlayerViewModel ang chy&#10;        requestCurrentPlaybackState()&#10;        &#10;        isInitialized = true&#10;        println(&quot;DEBUG: PlaybackViewModel initialized successfully&quot;)&#10;    }&#10;&#10;    private fun registerBroadcastReceiver() {&#10;        try {&#10;            if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.TIRAMISU) {&#10;                context.registerReceiver(&#10;                    stateReceiver,&#10;                    IntentFilter(&quot;PLAYBACK_STATE_UPDATE&quot;),&#10;                    Context.RECEIVER_NOT_EXPORTED&#10;                )&#10;            } else {&#10;                context.registerReceiver(&#10;                    stateReceiver,&#10;                    IntentFilter(&quot;PLAYBACK_STATE_UPDATE&quot;)&#10;                )&#10;            }&#10;            println(&quot;DEBUG: PlaybackViewModel broadcast receiver registered successfully&quot;)&#10;        } catch (e: Exception) {&#10;            println(&quot;DEBUG: Failed to register broadcast receiver: ${e.message}&quot;)&#10;        }&#10;    }&#10;&#10;    private fun requestCurrentPlaybackState() {&#10;        // Gi broadcast  request current state t MusicPlayerViewModel&#10;        val intent = Intent(&quot;REQUEST_PLAYBACK_STATE&quot;)&#10;        context.sendBroadcast(intent)&#10;        println(&quot;DEBUG: Requested current playback state&quot;)&#10;    }&#10;&#10;    fun play(mediaItem: MediaItem) {&#10;        viewModelScope.launch {&#10;            playMediaUseCase.playMediaItem(mediaItem)&#10;            _playbackState.value = _playbackState.value.copy(&#10;                currentItem = mediaItem,&#10;                isPlaying = true,&#10;                progress = 0f&#10;            )&#10;        }&#10;    }&#10;&#10;    fun togglePlayPause() {&#10;        val current = _playbackState.value&#10;        _playbackState.value = current.copy(isPlaying = !current.isPlaying)&#10;    }&#10;&#10;    fun stop() {&#10;        _playbackState.value = PlaybackState()&#10;    }&#10;&#10;    fun updateProgress(position: Long, duration: Long) {&#10;        val progress = if (duration &gt; 0) position.toFloat() / duration else 0f&#10;        _playbackState.value = _playbackState.value.copy(&#10;            playbackPosition = position,&#10;            duration = duration,&#10;            progress = progress&#10;        )&#10;    }&#10;&#10;    fun loadAndPlayMediaItem(mediaId: String) {&#10;        viewModelScope.launch {&#10;            try {&#10;                // Gi s c cch ly MediaItem t mediaId&#10;                // Tm thi to MediaItem dummy  test&#10;                val mediaItem = createDummyMediaItem(mediaId)&#10;                play(mediaItem)&#10;            } catch (e: Exception) {&#10;                println(&quot;Error loading media: ${e.message}&quot;)&#10;            }&#10;        }&#10;    }&#10;&#10;    private fun createDummyMediaItem(mediaId: String): MediaItem {&#10;        return MediaItem(&#10;            id = mediaId,&#10;            title = &quot;Sample Song&quot;,&#10;            artist = &quot;Sample Artist&quot;,&#10;            album = &quot;Sample Album&quot;,&#10;            duration = 240000L, // 4 minutes&#10;            uri = &quot;content://media/external/audio/media/$mediaId&quot;,&#10;            albumArtUri = null,&#10;            type = MediaType.AUDIO,&#10;            isFavorite = false,&#10;            displayName = &quot;Sample Song.mp3&quot;,&#10;            size = 5242880L,&#10;            dateAdded = System.currentTimeMillis(),&#10;            dateModified = System.currentTimeMillis(),&#10;            mimeType = &quot;audio/mpeg&quot;,&#10;            track = 1,&#10;            year = 2024,&#10;            genre = &quot;Pop&quot;,&#10;            bitrate = 320000,&#10;            sampleRate = 44100,&#10;            path = &quot;/storage/emulated/0/Music/sample.mp3&quot;&#10;        )&#10;    }&#10;&#10;    override fun onCleared() {&#10;        context.unregisterReceiver(stateReceiver)&#10;        super.onCleared()&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/presentation/src/main/java/com/tinhtx/player/presentation/screen/search/SearchScreen.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/presentation/src/main/java/com/tinhtx/player/presentation/screen/search/SearchScreen.kt" />
              <option name="originalContent" value="// presentation/src/main/kotlin/com/tinhtx/player/screen/search/SearchScreen.kt&#10;package com.tinhtx.player.presentation.screen.search&#10;&#10;import androidx.compose.foundation.layout.Arrangement&#10;import androidx.compose.foundation.layout.Box&#10;import androidx.compose.foundation.layout.Column&#10;import androidx.compose.foundation.layout.PaddingValues&#10;import androidx.compose.foundation.layout.Row&#10;import androidx.compose.foundation.layout.Spacer&#10;import androidx.compose.foundation.layout.fillMaxSize&#10;import androidx.compose.foundation.layout.fillMaxWidth&#10;import androidx.compose.foundation.layout.height&#10;import androidx.compose.foundation.layout.padding&#10;import androidx.compose.foundation.layout.size&#10;import androidx.compose.foundation.layout.width&#10;import androidx.compose.foundation.lazy.LazyColumn&#10;import androidx.compose.foundation.lazy.LazyRow&#10;import androidx.compose.foundation.lazy.items&#10;import androidx.compose.material.icons.Icons&#10;import androidx.compose.material.icons.filled.ArrowBack&#10;import androidx.compose.material.icons.filled.Clear&#10;import androidx.compose.material.icons.filled.History&#10;import androidx.compose.material.icons.filled.MusicNote&#10;import androidx.compose.material.icons.filled.Search&#10;import androidx.compose.material.icons.filled.Videocam&#10;import androidx.compose.material3.Card&#10;import androidx.compose.material3.CardDefaults&#10;import androidx.compose.material3.CircularProgressIndicator&#10;import androidx.compose.material3.ExperimentalMaterial3Api&#10;import androidx.compose.material3.FilterChip&#10;import androidx.compose.material3.Icon&#10;import androidx.compose.material3.IconButton&#10;import androidx.compose.material3.MaterialTheme&#10;import androidx.compose.material3.Scaffold&#10;import androidx.compose.material3.Text&#10;import androidx.compose.material3.TopAppBar&#10;import androidx.compose.material3.TopAppBarDefaults&#10;import androidx.compose.runtime.Composable&#10;import androidx.compose.runtime.LaunchedEffect&#10;import androidx.compose.runtime.collectAsState&#10;import androidx.compose.runtime.getValue&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.text.font.FontWeight&#10;import androidx.compose.ui.text.style.TextAlign&#10;import androidx.compose.ui.unit.dp&#10;import androidx.hilt.navigation.compose.hiltViewModel&#10;import com.tinhtx.player.core.common.Resource&#10;import com.tinhtx.player.domain.model.MediaType&#10;import com.tinhtx.player.domain.model.UserPreferences&#10;import com.tinhtx.player.presentation.animation.FallingLeavesAnimation&#10;import com.tinhtx.player.presentation.animation.WaterDropAnimation&#10;import com.tinhtx.player.presentation.component.common.MediaItemCard&#10;import com.tinhtx.player.presentation.component.common.SearchBar&#10;&#10;@OptIn(ExperimentalMaterial3Api::class)&#10;@Composable&#10;fun SearchScreen(&#10;    onNavigateBack: () -&gt; Unit,&#10;    onNavigateToPlayer: (String) -&gt; Unit,&#10;    viewModel: SearchViewModel = hiltViewModel()&#10;) {&#10;    val uiState by viewModel.uiState.collectAsState()&#10;    val userPreferences by viewModel.userPreferences.collectAsState()&#10;&#10;    LaunchedEffect(Unit) {&#10;        viewModel.loadSearchHistory()&#10;    }&#10;&#10;    Scaffold(&#10;        topBar = {&#10;            TopAppBar(&#10;                title = { Text(&quot;Tm Kim&quot;) },&#10;                navigationIcon = {&#10;                    IconButton(onClick = onNavigateBack) {&#10;                        Icon(Icons.Default.ArrowBack, contentDescription = &quot;Quay li&quot;)&#10;                    }&#10;                },&#10;                colors = TopAppBarDefaults.topAppBarColors(&#10;                    containerColor = MaterialTheme.colorScheme.surface&#10;                )&#10;            )&#10;        }&#10;    ) { paddingValues -&gt;&#10;        Column(&#10;            modifier = Modifier&#10;                .fillMaxSize()&#10;                .padding(paddingValues)&#10;                .padding(horizontal = 16.dp)&#10;        ) {&#10;            Spacer(modifier = Modifier.height(16.dp))&#10;&#10;            // Search Bar&#10;            WaterDropAnimation(&#10;                visible = true,&#10;                ageGroup = userPreferences.ageGroup&#10;            ) {&#10;                SearchBar(&#10;                    query = uiState.searchQuery,&#10;                    onQueryChange = viewModel::onSearchQueryChange,&#10;                    onSearchClick = { viewModel.performSearch() },&#10;                    placeholder = &quot;Tm kim bi ht, ngh s, album...&quot;,&#10;                    modifier = Modifier.fillMaxWidth()&#10;                )&#10;            }&#10;&#10;            Spacer(modifier = Modifier.height(16.dp))&#10;&#10;            // Filter Chips&#10;            FallingLeavesAnimation(&#10;                visible = true,&#10;                ageGroup = userPreferences.ageGroup&#10;            ) {&#10;                LazyRow(&#10;                    horizontalArrangement = Arrangement.spacedBy(8.dp),&#10;                    contentPadding = PaddingValues(horizontal = 4.dp)&#10;                ) {&#10;                    item {&#10;                        FilterChip(&#10;                            selected = uiState.selectedFilter == null,&#10;                            onClick = { viewModel.setFilter(null) },&#10;                            label = { Text(&quot;Tt c&quot;) },&#10;                            leadingIcon = {&#10;                                Icon(&#10;                                    Icons.Default.Search,&#10;                                    contentDescription = null,&#10;                                    modifier = Modifier.size(16.dp)&#10;                                )&#10;                            }&#10;                        )&#10;                    }&#10;                    item {&#10;                        FilterChip(&#10;                            selected = uiState.selectedFilter == MediaType.AUDIO,&#10;                            onClick = { viewModel.setFilter(MediaType.AUDIO) },&#10;                            label = { Text(&quot;Nhc&quot;) },&#10;                            leadingIcon = {&#10;                                Icon(&#10;                                    Icons.Default.MusicNote,&#10;                                    contentDescription = null,&#10;                                    modifier = Modifier.size(16.dp)&#10;                                )&#10;                            }&#10;                        )&#10;                    }&#10;                    item {&#10;                        FilterChip(&#10;                            selected = uiState.selectedFilter == MediaType.VIDEO,&#10;                            onClick = { viewModel.setFilter(MediaType.VIDEO) },&#10;                            label = { Text(&quot;Video&quot;) },&#10;                            leadingIcon = {&#10;                                Icon(&#10;                                    Icons.Default.Videocam,&#10;                                    contentDescription = null,&#10;                                    modifier = Modifier.size(16.dp)&#10;                                )&#10;                            }&#10;                        )&#10;                    }&#10;                }&#10;            }&#10;&#10;            Spacer(modifier = Modifier.height(16.dp))&#10;&#10;            // Content&#10;            when {&#10;                uiState.searchQuery.isEmpty() -&gt; {&#10;                    // Search History &amp; Suggestions&#10;                    SearchHistorySection(&#10;                        searchHistory = uiState.searchHistory,&#10;                        onHistoryItemClick = { viewModel.onSearchQueryChange(it) },&#10;                        onClearHistory = { viewModel.clearSearchHistory() },&#10;                        userPreferences = userPreferences&#10;                    )&#10;                }&#10;&#10;                uiState.searchResults is Resource.Loading -&gt; {&#10;                    Box(&#10;                        modifier = Modifier.fillMaxSize(),&#10;                        contentAlignment = Alignment.Center&#10;                    ) {&#10;                        Column(&#10;                            horizontalAlignment = Alignment.CenterHorizontally&#10;                        ) {&#10;                            CircularProgressIndicator(&#10;                                color = MaterialTheme.colorScheme.primary&#10;                            )&#10;                            Spacer(modifier = Modifier.height(16.dp))&#10;                            Text(&#10;                                text = &quot;ang tm kim...&quot;,&#10;                                style = MaterialTheme.typography.bodyMedium,&#10;                                color = MaterialTheme.colorScheme.onSurface.copy(alpha = 0.7f)&#10;                            )&#10;                        }&#10;                    }&#10;                }&#10;&#10;                uiState.searchResults is Resource.Success -&gt; {&#10;                    val results = uiState.searchResults.data ?: emptyList()&#10;                    if (results.isEmpty()) {&#10;                        // Empty State&#10;                        Box(&#10;                            modifier = Modifier.fillMaxSize(),&#10;                            contentAlignment = Alignment.Center&#10;                        ) {&#10;                            Column(&#10;                                horizontalAlignment = Alignment.CenterHorizontally&#10;                            ) {&#10;                                Icon(&#10;                                    Icons.Default.Search,&#10;                                    contentDescription = null,&#10;                                    modifier = Modifier.size(64.dp),&#10;                                    tint = MaterialTheme.colorScheme.onSurface.copy(alpha = 0.4f)&#10;                                )&#10;                                Spacer(modifier = Modifier.height(16.dp))&#10;                                Text(&#10;                                    text = &quot;Khng tm thy kt qu&quot;,&#10;                                    style = MaterialTheme.typography.titleMedium,&#10;                                    color = MaterialTheme.colorScheme.onSurface.copy(alpha = 0.7f)&#10;                                )&#10;                                Text(&#10;                                    text = &quot;Hy th t kha khc&quot;,&#10;                                    style = MaterialTheme.typography.bodyMedium,&#10;                                    color = MaterialTheme.colorScheme.onSurface.copy(alpha = 0.5f)&#10;                                )&#10;                            }&#10;                        }&#10;                    } else {&#10;                        // Search Results&#10;                        LazyColumn(&#10;                            verticalArrangement = Arrangement.spacedBy(8.dp),&#10;                            contentPadding = PaddingValues(vertical = 8.dp)&#10;                        ) {&#10;                            item {&#10;                                Text(&#10;                                    text = &quot;Kt qu (${results.size})&quot;,&#10;                                    style = MaterialTheme.typography.titleMedium,&#10;                                    fontWeight = FontWeight.Bold,&#10;                                    modifier = Modifier.padding(vertical = 8.dp)&#10;                                )&#10;                            }&#10;&#10;                            items(&#10;                                items = results,&#10;                                key = { it.id }&#10;                            ) { mediaItem -&gt;&#10;                                WaterDropAnimation(&#10;                                    visible = true,&#10;                                    ageGroup = userPreferences.ageGroup&#10;                                ) {&#10;                                    MediaItemCard(&#10;                                        mediaItem = mediaItem,&#10;                                        onClick = {&#10;                                            viewModel.addToHistory(uiState.searchQuery)&#10;                                            onNavigateToPlayer(mediaItem.id)&#10;                                        },&#10;                                        onFavoriteClick = { viewModel.toggleFavorite(mediaItem.id) },&#10;                                        onMoreClick = { viewModel.showMediaOptions(mediaItem.id) },&#10;                                        ageGroup = userPreferences.ageGroup&#10;                                    )&#10;                                }&#10;                            }&#10;                        }&#10;                    }&#10;                }&#10;&#10;                uiState.searchResults is Resource.Error -&gt; {&#10;                    Box(&#10;                        modifier = Modifier.fillMaxSize(),&#10;                        contentAlignment = Alignment.Center&#10;                    ) {&#10;                        Column(&#10;                            horizontalAlignment = Alignment.CenterHorizontally&#10;                        ) {&#10;                            Text(&#10;                                text = &quot; xy ra li&quot;,&#10;                                style = MaterialTheme.typography.titleMedium,&#10;                                color = MaterialTheme.colorScheme.error&#10;                            )&#10;                            Text(&#10;                                text = uiState.searchResults.message ?: &quot;Li khng xc nh&quot;,&#10;                                style = MaterialTheme.typography.bodyMedium,&#10;                                color = MaterialTheme.colorScheme.onSurface.copy(alpha = 0.7f),&#10;                                textAlign = TextAlign.Center&#10;                            )&#10;                        }&#10;                    }&#10;                }&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun SearchHistorySection(&#10;    searchHistory: List&lt;String&gt;,&#10;    onHistoryItemClick: (String) -&gt; Unit,&#10;    onClearHistory: () -&gt; Unit,&#10;    userPreferences: UserPreferences&#10;) {&#10;    if (searchHistory.isNotEmpty()) {&#10;        Column {&#10;            Row(&#10;                modifier = Modifier.fillMaxWidth(),&#10;                horizontalArrangement = Arrangement.SpaceBetween,&#10;                verticalAlignment = Alignment.CenterVertically&#10;            ) {&#10;                Text(&#10;                    text = &quot;Tm kim gn y&quot;,&#10;                    style = MaterialTheme.typography.titleMedium,&#10;                    fontWeight = FontWeight.Bold&#10;                )&#10;&#10;                IconButton(onClick = onClearHistory) {&#10;                    Icon(&#10;                        Icons.Default.Clear,&#10;                        contentDescription = &quot;Xa lch s&quot;,&#10;                        modifier = Modifier.size(20.dp)&#10;                    )&#10;                }&#10;            }&#10;&#10;            Spacer(modifier = Modifier.height(8.dp))&#10;&#10;            LazyColumn(&#10;                verticalArrangement = Arrangement.spacedBy(4.dp)&#10;            ) {&#10;                items(searchHistory) { query -&gt;&#10;                    Card(&#10;                        onClick = { onHistoryItemClick(query) },&#10;                        colors = CardDefaults.cardColors(&#10;                            containerColor = MaterialTheme.colorScheme.surfaceVariant.copy(alpha = 0.5f)&#10;                        ),&#10;                        modifier = Modifier.fillMaxWidth()&#10;                    ) {&#10;                        Row(&#10;                            modifier = Modifier&#10;                                .fillMaxWidth()&#10;                                .padding(12.dp),&#10;                            verticalAlignment = Alignment.CenterVertically&#10;                        ) {&#10;                            Icon(&#10;                                Icons.Default.History,&#10;                                contentDescription = null,&#10;                                modifier = Modifier.size(16.dp),&#10;                                tint = MaterialTheme.colorScheme.onSurface.copy(alpha = 0.6f)&#10;                            )&#10;                            Spacer(modifier = Modifier.width(12.dp))&#10;                            Text(&#10;                                text = query,&#10;                                style = MaterialTheme.typography.bodyMedium,&#10;                                modifier = Modifier.weight(1f)&#10;                            )&#10;                        }&#10;                    }&#10;                }&#10;            }&#10;        }&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="// presentation/src/main/kotlin/com/tinhtx/player/screen/search/SearchScreen.kt&#10;package com.tinhtx.player.presentation.screen.search&#10;&#10;import androidx.compose.foundation.layout.Arrangement&#10;import androidx.compose.foundation.layout.Box&#10;import androidx.compose.foundation.layout.Column&#10;import androidx.compose.foundation.layout.PaddingValues&#10;import androidx.compose.foundation.layout.Row&#10;import androidx.compose.foundation.layout.Spacer&#10;import androidx.compose.foundation.layout.fillMaxSize&#10;import androidx.compose.foundation.layout.fillMaxWidth&#10;import androidx.compose.foundation.layout.height&#10;import androidx.compose.foundation.layout.padding&#10;import androidx.compose.foundation.layout.size&#10;import androidx.compose.foundation.layout.width&#10;import androidx.compose.foundation.lazy.LazyColumn&#10;import androidx.compose.foundation.lazy.LazyRow&#10;import androidx.compose.foundation.lazy.items&#10;import androidx.compose.material.icons.Icons&#10;import androidx.compose.material.icons.filled.ArrowBack&#10;import androidx.compose.material.icons.filled.Clear&#10;import androidx.compose.material.icons.filled.History&#10;import androidx.compose.material.icons.filled.MusicNote&#10;import androidx.compose.material.icons.filled.Search&#10;import androidx.compose.material.icons.filled.Videocam&#10;import androidx.compose.material3.Card&#10;import androidx.compose.material3.CardDefaults&#10;import androidx.compose.material3.CircularProgressIndicator&#10;import androidx.compose.material3.ExperimentalMaterial3Api&#10;import androidx.compose.material3.FilterChip&#10;import androidx.compose.material3.Icon&#10;import androidx.compose.material3.IconButton&#10;import androidx.compose.material3.MaterialTheme&#10;import androidx.compose.material3.Scaffold&#10;import androidx.compose.material3.Text&#10;import androidx.compose.material3.TopAppBar&#10;import androidx.compose.material3.TopAppBarDefaults&#10;import androidx.compose.runtime.Composable&#10;import androidx.compose.runtime.LaunchedEffect&#10;import androidx.compose.runtime.collectAsState&#10;import androidx.compose.runtime.getValue&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.text.font.FontWeight&#10;import androidx.compose.ui.text.style.TextAlign&#10;import androidx.compose.ui.unit.dp&#10;import androidx.hilt.navigation.compose.hiltViewModel&#10;import com.tinhtx.player.core.common.Resource&#10;import com.tinhtx.player.domain.model.MediaType&#10;import com.tinhtx.player.domain.model.UserPreferences&#10;import com.tinhtx.player.presentation.animation.FallingLeavesAnimation&#10;import com.tinhtx.player.presentation.animation.WaterDropAnimation&#10;import com.tinhtx.player.presentation.component.common.MediaItemCard&#10;import com.tinhtx.player.presentation.component.common.SearchBar&#10;&#10;@OptIn(ExperimentalMaterial3Api::class)&#10;@Composable&#10;fun SearchScreen(&#10;    onNavigateBack: () -&gt; Unit,&#10;    onNavigateToPlayer: (String) -&gt; Unit,&#10;    viewModel: SearchViewModel = hiltViewModel()&#10;) {&#10;    val uiState by viewModel.uiState.collectAsState()&#10;    val userPreferences by viewModel.userPreferences.collectAsState()&#10;&#10;    LaunchedEffect(Unit) {&#10;        viewModel.loadSearchHistory()&#10;    }&#10;&#10;    Column(&#10;        modifier = Modifier.fillMaxSize()&#10;    ) {&#10;        // Top Bar as composable - khng dng Scaffold&#10;        TopAppBar(&#10;            title = { Text(&quot;Tm Kim&quot;) },&#10;            navigationIcon = {&#10;                IconButton(onClick = onNavigateBack) {&#10;                    Icon(Icons.Default.ArrowBack, contentDescription = &quot;Quay li&quot;)&#10;                }&#10;            },&#10;            colors = TopAppBarDefaults.topAppBarColors(&#10;                containerColor = MaterialTheme.colorScheme.surface&#10;            )&#10;        )&#10;&#10;        Column(&#10;            modifier = Modifier&#10;                .fillMaxSize()&#10;                .padding(horizontal = 16.dp)&#10;        ) {&#10;            Spacer(modifier = Modifier.height(16.dp))&#10;&#10;            // Search Bar&#10;            WaterDropAnimation(&#10;                visible = true,&#10;                ageGroup = userPreferences.ageGroup&#10;            ) {&#10;                SearchBar(&#10;                    query = uiState.searchQuery,&#10;                    onQueryChange = viewModel::onSearchQueryChange,&#10;                    onSearchClick = { viewModel.performSearch() },&#10;                    placeholder = &quot;Tm kim nhc, video...&quot;,&#10;                    modifier = Modifier.fillMaxWidth()&#10;                )&#10;            }&#10;&#10;            Spacer(modifier = Modifier.height(16.dp))&#10;&#10;            // Filter Chips&#10;            FallingLeavesAnimation(&#10;                visible = true,&#10;                ageGroup = userPreferences.ageGroup&#10;            ) {&#10;                LazyRow(&#10;                    horizontalArrangement = Arrangement.spacedBy(8.dp),&#10;                    contentPadding = PaddingValues(vertical = 8.dp)&#10;                ) {&#10;                    items(MediaType.values()) { mediaType -&gt;&#10;                        FilterChip(&#10;                            onClick = { viewModel.onFilterChange(mediaType) },&#10;                            label = {&#10;                                Row(verticalAlignment = Alignment.CenterVertically) {&#10;                                    Icon(&#10;                                        imageVector = when (mediaType) {&#10;                                            MediaType.AUDIO -&gt; Icons.Default.MusicNote&#10;                                            MediaType.VIDEO -&gt; Icons.Default.Videocam&#10;                                        },&#10;                                        contentDescription = null,&#10;                                        modifier = Modifier.size(16.dp)&#10;                                    )&#10;                                    Spacer(modifier = Modifier.width(4.dp))&#10;                                    Text(&#10;                                        text = when (mediaType) {&#10;                                            MediaType.AUDIO -&gt; &quot;m nhc&quot;&#10;                                            MediaType.VIDEO -&gt; &quot;Video&quot;&#10;                                        }&#10;                                    )&#10;                                }&#10;                            },&#10;                            selected = uiState.selectedMediaType == mediaType&#10;                        )&#10;                    }&#10;                }&#10;            }&#10;&#10;            Spacer(modifier = Modifier.height(16.dp))&#10;&#10;            // Search Results or History&#10;            when {&#10;                uiState.searchQuery.isBlank() -&gt; {&#10;                    SearchHistoryContent(&#10;                        searchHistory = uiState.searchHistory,&#10;                        onHistoryClick = viewModel::onSearchQueryChange,&#10;                        onClearHistory = viewModel::clearSearchHistory,&#10;                        userPreferences = userPreferences&#10;                    )&#10;                }&#10;                uiState.isSearching -&gt; {&#10;                    Box(&#10;                        modifier = Modifier.fillMaxSize(),&#10;                        contentAlignment = Alignment.Center&#10;                    ) {&#10;                        CircularProgressIndicator()&#10;                    }&#10;                }&#10;                else -&gt; {&#10;                    SearchResultsContent(&#10;                        searchResults = uiState.searchResults,&#10;                        onItemClick = onNavigateToPlayer,&#10;                        userPreferences = userPreferences&#10;                    )&#10;                }&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun SearchHistoryContent(&#10;    searchHistory: List&lt;String&gt;,&#10;    onHistoryClick: (String) -&gt; Unit,&#10;    onClearHistory: () -&gt; Unit,&#10;    userPreferences: UserPreferences&#10;) {&#10;    if (searchHistory.isNotEmpty()) {&#10;        Column {&#10;            Row(&#10;                modifier = Modifier.fillMaxWidth(),&#10;                horizontalArrangement = Arrangement.SpaceBetween,&#10;                verticalAlignment = Alignment.CenterVertically&#10;            ) {&#10;                Text(&#10;                    text = &quot;Tm kim gn y&quot;,&#10;                    style = MaterialTheme.typography.titleMedium,&#10;                    fontWeight = FontWeight.Bold&#10;                )&#10;&#10;                IconButton(onClick = onClearHistory) {&#10;                    Icon(&#10;                        Icons.Default.Clear,&#10;                        contentDescription = &quot;Xa lch s&quot;,&#10;                        modifier = Modifier.size(20.dp)&#10;                    )&#10;                }&#10;            }&#10;&#10;            Spacer(modifier = Modifier.height(8.dp))&#10;&#10;            LazyColumn(&#10;                verticalArrangement = Arrangement.spacedBy(4.dp)&#10;            ) {&#10;                items(searchHistory) { query -&gt;&#10;                    Card(&#10;                        onClick = { onHistoryClick(query) },&#10;                        colors = CardDefaults.cardColors(&#10;                            containerColor = MaterialTheme.colorScheme.surfaceVariant.copy(alpha = 0.5f)&#10;                        ),&#10;                        modifier = Modifier.fillMaxWidth()&#10;                    ) {&#10;                        Row(&#10;                            modifier = Modifier&#10;                                .fillMaxWidth()&#10;                                .padding(12.dp),&#10;                            verticalAlignment = Alignment.CenterVertically&#10;                        ) {&#10;                            Icon(&#10;                                Icons.Default.History,&#10;                                contentDescription = null,&#10;                                modifier = Modifier.size(16.dp),&#10;                                tint = MaterialTheme.colorScheme.onSurface.copy(alpha = 0.6f)&#10;                            )&#10;                            Spacer(modifier = Modifier.width(12.dp))&#10;                            Text(&#10;                                text = query,&#10;                                style = MaterialTheme.typography.bodyMedium,&#10;                                modifier = Modifier.weight(1f)&#10;                            )&#10;                        }&#10;                    }&#10;                }&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun SearchResultsContent(&#10;    searchResults: Resource&lt;List&lt;MediaItem&gt;&gt;,&#10;    onItemClick: (String) -&gt; Unit,&#10;    userPreferences: UserPreferences&#10;) {&#10;    when (searchResults) {&#10;        is Resource.Success -&gt; {&#10;            val results = searchResults.data ?: emptyList()&#10;            if (results.isEmpty()) {&#10;                // Empty State&#10;                Box(&#10;                    modifier = Modifier.fillMaxSize(),&#10;                    contentAlignment = Alignment.Center&#10;                ) {&#10;                    Column(&#10;                        horizontalAlignment = Alignment.CenterHorizontally&#10;                    ) {&#10;                        Icon(&#10;                            Icons.Default.Search,&#10;                            contentDescription = null,&#10;                            modifier = Modifier.size(64.dp),&#10;                            tint = MaterialTheme.colorScheme.onSurface.copy(alpha = 0.4f)&#10;                        )&#10;                        Spacer(modifier = Modifier.height(16.dp))&#10;                        Text(&#10;                            text = &quot;Khng tm thy kt qu&quot;,&#10;                            style = MaterialTheme.typography.titleMedium,&#10;                            color = MaterialTheme.colorScheme.onSurface.copy(alpha = 0.7f)&#10;                        )&#10;                        Text(&#10;                            text = &quot;Hy th t kha khc&quot;,&#10;                            style = MaterialTheme.typography.bodyMedium,&#10;                            color = MaterialTheme.colorScheme.onSurface.copy(alpha = 0.5f)&#10;                        )&#10;                    }&#10;                }&#10;            } else {&#10;                // Search Results&#10;                LazyColumn(&#10;                    verticalArrangement = Arrangement.spacedBy(8.dp),&#10;                    contentPadding = PaddingValues(vertical = 8.dp)&#10;                ) {&#10;                    item {&#10;                        Text(&#10;                            text = &quot;Kt qu (${results.size})&quot;,&#10;                            style = MaterialTheme.typography.titleMedium,&#10;                            fontWeight = FontWeight.Bold,&#10;                            modifier = Modifier.padding(vertical = 8.dp)&#10;                        )&#10;                    }&#10;&#10;                    items(&#10;                        items = results,&#10;                        key = { it.id }&#10;                    ) { mediaItem -&gt;&#10;                        WaterDropAnimation(&#10;                            visible = true,&#10;                            ageGroup = userPreferences.ageGroup&#10;                        ) {&#10;                            MediaItemCard(&#10;                                mediaItem = mediaItem,&#10;                                onClick = {&#10;                                    viewModel.addToHistory(uiState.searchQuery)&#10;                                    onItemClick(mediaItem.id)&#10;                                },&#10;                                onFavoriteClick = { viewModel.toggleFavorite(mediaItem.id) },&#10;                                onMoreClick = { viewModel.showMediaOptions(mediaItem.id) },&#10;                                ageGroup = userPreferences.ageGroup&#10;                            )&#10;                        }&#10;                    }&#10;                }&#10;            }&#10;        }&#10;&#10;        is Resource.Error -&gt; {&#10;            Box(&#10;                modifier = Modifier.fillMaxSize(),&#10;                contentAlignment = Alignment.Center&#10;            ) {&#10;                Column(&#10;                    horizontalAlignment = Alignment.CenterHorizontally&#10;                ) {&#10;                    Text(&#10;                        text = &quot; xy ra li&quot;,&#10;                        style = MaterialTheme.typography.titleMedium,&#10;                        color = MaterialTheme.colorScheme.error&#10;                    )&#10;                    Text(&#10;                        text = searchResults.message ?: &quot;Li khng xc nh&quot;,&#10;                        style = MaterialTheme.typography.bodyMedium,&#10;                        color = MaterialTheme.colorScheme.onSurface.copy(alpha = 0.7f),&#10;                        textAlign = TextAlign.Center&#10;                    )&#10;                }&#10;            }&#10;        }&#10;&#10;        Resource.Loading -&gt; {&#10;            Box(&#10;                modifier = Modifier.fillMaxSize(),&#10;                contentAlignment = Alignment.Center&#10;            ) {&#10;                CircularProgressIndicator()&#10;            }&#10;        }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/presentation/src/main/kotlin/com/tinhtx/player/component/common/MediaItemCard.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/presentation/src/main/kotlin/com/tinhtx/player/component/common/MediaItemCard.kt" />
              <option name="updatedContent" value="package com.tinhtx.player.component.common&#10;&#10;import androidx.compose.foundation.layout.*&#10;import androidx.compose.foundation.shape.RoundedCornerShape&#10;import androidx.compose.material3.*&#10;import androidx.compose.runtime.Composable&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.draw.clip&#10;import androidx.compose.ui.layout.ContentScale&#10;import androidx.compose.ui.text.style.TextOverflow&#10;import androidx.compose.ui.unit.dp&#10;import coil.compose.AsyncImage&#10;import com.tinhtx.player.model.MediaItem&#10;&#10;@OptIn(ExperimentalMaterial3Api::class)&#10;@Composable&#10;fun MediaItemCard(&#10;    mediaItem: MediaItem,&#10;    onClick: (MediaItem) -&gt; Unit,&#10;    modifier: Modifier = Modifier&#10;) {&#10;    Card(&#10;        onClick = { onClick(mediaItem) },&#10;        modifier = modifier&#10;            .fillMaxWidth()&#10;            .height(80.dp),&#10;        colors = CardDefaults.cardColors(&#10;            containerColor = MaterialTheme.colorScheme.surface&#10;        )&#10;    ) {&#10;        Row(&#10;            modifier = Modifier&#10;                .fillMaxSize()&#10;                .padding(12.dp),&#10;            verticalAlignment = Alignment.CenterVertically&#10;        ) {&#10;            // Album artwork&#10;            AsyncImage(&#10;                model = mediaItem.artworkUri,&#10;                contentDescription = &quot;Album artwork&quot;,&#10;                modifier = Modifier&#10;                    .size(56.dp)&#10;                    .clip(RoundedCornerShape(8.dp)),&#10;                contentScale = ContentScale.Crop&#10;            )&#10;            &#10;            Spacer(modifier = Modifier.width(12.dp))&#10;            &#10;            // Media info&#10;            Column(&#10;                modifier = Modifier.weight(1f)&#10;            ) {&#10;                Text(&#10;                    text = mediaItem.title,&#10;                    style = MaterialTheme.typography.titleSmall,&#10;                    color = MaterialTheme.colorScheme.onSurface,&#10;                    maxLines = 1,&#10;                    overflow = TextOverflow.Ellipsis&#10;                )&#10;                &#10;                Text(&#10;                    text = &quot;${mediaItem.artist}  ${mediaItem.album}&quot;,&#10;                    style = MaterialTheme.typography.bodyMedium,&#10;                    color = MaterialTheme.colorScheme.onSurface.copy(alpha = 0.7f),&#10;                    maxLines = 1,&#10;                    overflow = TextOverflow.Ellipsis&#10;                )&#10;            }&#10;            &#10;            // Duration&#10;            Text(&#10;                text = formatDuration(mediaItem.duration),&#10;                style = MaterialTheme.typography.bodySmall,&#10;                color = MaterialTheme.colorScheme.onSurface.copy(alpha = 0.5f)&#10;            )&#10;        }&#10;    }&#10;}&#10;&#10;private fun formatDuration(duration: Long): String {&#10;    val minutes = duration / 1000 / 60&#10;    val seconds = (duration / 1000) % 60&#10;    return String.format(&quot;%d:%02d&quot;, minutes, seconds)&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/presentation/src/main/kotlin/com/tinhtx/player/component/common/PermissionHandler.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/presentation/src/main/kotlin/com/tinhtx/player/component/common/PermissionHandler.kt" />
              <option name="updatedContent" value="package com.tinhtx.player.component.common&#10;&#10;import androidx.compose.foundation.layout.*&#10;import androidx.compose.material3.*&#10;import androidx.compose.runtime.*&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.platform.LocalContext&#10;import androidx.compose.ui.text.style.TextAlign&#10;import androidx.compose.ui.unit.dp&#10;import androidx.activity.compose.rememberLauncherForActivityResult&#10;import androidx.activity.result.contract.ActivityResultContracts&#10;import com.tinhtx.player.util.PermissionUtils&#10;&#10;@Composable&#10;fun PermissionHandler(&#10;    onPermissionsGranted: () -&gt; Unit,&#10;    onPermissionsDenied: () -&gt; Unit,&#10;    modifier: Modifier = Modifier&#10;) {&#10;    val context = LocalContext.current&#10;    var showRationale by remember { mutableStateOf(false) }&#10;    &#10;    val permissionLauncher = rememberLauncherForActivityResult(&#10;        contract = ActivityResultContracts.RequestMultiplePermissions()&#10;    ) { permissions -&gt;&#10;        val allGranted = permissions.values.all { it }&#10;        if (allGranted) {&#10;            onPermissionsGranted()&#10;        } else {&#10;            showRationale = true&#10;            onPermissionsDenied()&#10;        }&#10;    }&#10;    &#10;    LaunchedEffect(Unit) {&#10;        if (PermissionUtils.hasRequiredPermissions(context)) {&#10;            onPermissionsGranted()&#10;        } else {&#10;            permissionLauncher.launch(PermissionUtils.REQUIRED_PERMISSIONS)&#10;        }&#10;    }&#10;    &#10;    if (showRationale) {&#10;        Card(&#10;            modifier = modifier&#10;                .fillMaxWidth()&#10;                .padding(16.dp),&#10;            colors = CardDefaults.cardColors(&#10;                containerColor = MaterialTheme.colorScheme.errorContainer&#10;            )&#10;        ) {&#10;            Column(&#10;                modifier = Modifier&#10;                    .fillMaxWidth()&#10;                    .padding(16.dp),&#10;                horizontalAlignment = Alignment.CenterHorizontally&#10;            ) {&#10;                Text(&#10;                    text = &quot;Storage Permission Required&quot;,&#10;                    style = MaterialTheme.typography.titleMedium,&#10;                    color = MaterialTheme.colorScheme.onErrorContainer,&#10;                    textAlign = TextAlign.Center&#10;                )&#10;                &#10;                Spacer(modifier = Modifier.height(8.dp))&#10;                &#10;                Text(&#10;                    text = &quot;This app needs access to your device storage to play music and videos. Please grant the permission to continue.&quot;,&#10;                    style = MaterialTheme.typography.bodyMedium,&#10;                    color = MaterialTheme.colorScheme.onErrorContainer,&#10;                    textAlign = TextAlign.Center&#10;                )&#10;                &#10;                Spacer(modifier = Modifier.height(16.dp))&#10;                &#10;                Button(&#10;                    onClick = {&#10;                        permissionLauncher.launch(PermissionUtils.REQUIRED_PERMISSIONS)&#10;                        showRationale = false&#10;                    },&#10;                    colors = ButtonDefaults.buttonColors(&#10;                        containerColor = MaterialTheme.colorScheme.primary&#10;                    )&#10;                ) {&#10;                    Text(&quot;Grant Permission&quot;)&#10;                }&#10;            }&#10;        }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/presentation/src/main/kotlin/com/tinhtx/player/component/common/SearchBar.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/presentation/src/main/kotlin/com/tinhtx/player/component/common/SearchBar.kt" />
              <option name="updatedContent" value="package com.tinhtx.player.component.common&#10;&#10;import androidx.compose.foundation.layout.*&#10;import androidx.compose.foundation.text.KeyboardActions&#10;import androidx.compose.foundation.text.KeyboardOptions&#10;import androidx.compose.material.icons.Icons&#10;import androidx.compose.material.icons.filled.Clear&#10;import androidx.compose.material.icons.filled.Search&#10;import androidx.compose.material3.*&#10;import androidx.compose.runtime.*&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.platform.LocalSoftwareKeyboardController&#10;import androidx.compose.ui.text.input.ImeAction&#10;import androidx.compose.ui.unit.dp&#10;&#10;@OptIn(ExperimentalMaterial3Api::class)&#10;@Composable&#10;fun SearchBar(&#10;    query: String,&#10;    onQueryChange: (String) -&gt; Unit,&#10;    onSearch: (String) -&gt; Unit,&#10;    placeholder: String = &quot;Search music...&quot;,&#10;    modifier: Modifier = Modifier&#10;) {&#10;    val keyboardController = LocalSoftwareKeyboardController.current&#10;    &#10;    OutlinedTextField(&#10;        value = query,&#10;        onValueChange = onQueryChange,&#10;        placeholder = {&#10;            Text(&#10;                text = placeholder,&#10;                style = MaterialTheme.typography.bodyMedium&#10;            )&#10;        },&#10;        leadingIcon = {&#10;            Icon(&#10;                imageVector = Icons.Default.Search,&#10;                contentDescription = &quot;Search&quot;,&#10;                tint = MaterialTheme.colorScheme.onSurface.copy(alpha = 0.6f)&#10;            )&#10;        },&#10;        trailingIcon = {&#10;            if (query.isNotEmpty()) {&#10;                IconButton(&#10;                    onClick = { onQueryChange(&quot;&quot;) }&#10;                ) {&#10;                    Icon(&#10;                        imageVector = Icons.Default.Clear,&#10;                        contentDescription = &quot;Clear&quot;,&#10;                        tint = MaterialTheme.colorScheme.onSurface.copy(alpha = 0.6f)&#10;                    )&#10;                }&#10;            }&#10;        },&#10;        keyboardOptions = KeyboardOptions(&#10;            imeAction = ImeAction.Search&#10;        ),&#10;        keyboardActions = KeyboardActions(&#10;            onSearch = {&#10;                onSearch(query)&#10;                keyboardController?.hide()&#10;            }&#10;        ),&#10;        singleLine = true,&#10;        modifier = modifier&#10;            .fillMaxWidth()&#10;            .padding(horizontal = 16.dp),&#10;        colors = OutlinedTextFieldDefaults.colors(&#10;            focusedBorderColor = MaterialTheme.colorScheme.primary,&#10;            unfocusedBorderColor = MaterialTheme.colorScheme.outline.copy(alpha = 0.5f)&#10;        )&#10;    )&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/presentation/src/main/kotlin/com/tinhtx/player/component/media/EqualizerComponents.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/presentation/src/main/kotlin/com/tinhtx/player/component/media/EqualizerComponents.kt" />
              <option name="updatedContent" value="package com.tinhtx.player.component.media&#10;&#10;import androidx.compose.foundation.layout.*&#10;import androidx.compose.foundation.shape.RoundedCornerShape&#10;import androidx.compose.material3.*&#10;import androidx.compose.runtime.*&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.draw.clip&#10;import androidx.compose.ui.unit.dp&#10;&#10;@Composable&#10;fun EqualizerComponents(&#10;    bassBoostLevel: Int,&#10;    virtualizerLevel: Int,&#10;    onBassBoostChange: (Int) -&gt; Unit,&#10;    onVirtualizerChange: (Int) -&gt; Unit,&#10;    modifier: Modifier = Modifier&#10;) {&#10;    Card(&#10;        modifier = modifier&#10;            .fillMaxWidth()&#10;            .padding(16.dp),&#10;        colors = CardDefaults.cardColors(&#10;            containerColor = MaterialTheme.colorScheme.surface&#10;        )&#10;    ) {&#10;        Column(&#10;            modifier = Modifier&#10;                .fillMaxWidth()&#10;                .padding(16.dp)&#10;        ) {&#10;            Text(&#10;                text = &quot;Audio Effects&quot;,&#10;                style = MaterialTheme.typography.titleMedium,&#10;                color = MaterialTheme.colorScheme.onSurface&#10;            )&#10;            &#10;            Spacer(modifier = Modifier.height(16.dp))&#10;            &#10;            // Bass Boost&#10;            Column {&#10;                Row(&#10;                    modifier = Modifier.fillMaxWidth(),&#10;                    horizontalArrangement = Arrangement.SpaceBetween,&#10;                    verticalAlignment = Alignment.CenterVertically&#10;                ) {&#10;                    Text(&#10;                        text = &quot;Bass Boost&quot;,&#10;                        style = MaterialTheme.typography.bodyMedium,&#10;                        color = MaterialTheme.colorScheme.onSurface&#10;                    )&#10;                    Text(&#10;                        text = &quot;$bassBoostLevel%&quot;,&#10;                        style = MaterialTheme.typography.bodySmall,&#10;                        color = MaterialTheme.colorScheme.onSurface.copy(alpha = 0.7f)&#10;                    )&#10;                }&#10;                &#10;                Slider(&#10;                    value = bassBoostLevel.toFloat(),&#10;                    onValueChange = { onBassBoostChange(it.toInt()) },&#10;                    valueRange = 0f..100f,&#10;                    modifier = Modifier.fillMaxWidth(),&#10;                    colors = SliderDefaults.colors(&#10;                        thumbColor = MaterialTheme.colorScheme.primary,&#10;                        activeTrackColor = MaterialTheme.colorScheme.primary&#10;                    )&#10;                )&#10;            }&#10;            &#10;            Spacer(modifier = Modifier.height(16.dp))&#10;            &#10;            // Virtualizer&#10;            Column {&#10;                Row(&#10;                    modifier = Modifier.fillMaxWidth(),&#10;                    horizontalArrangement = Arrangement.SpaceBetween,&#10;                    verticalAlignment = Alignment.CenterVertically&#10;                ) {&#10;                    Text(&#10;                        text = &quot;Virtualizer&quot;,&#10;                        style = MaterialTheme.typography.bodyMedium,&#10;                        color = MaterialTheme.colorScheme.onSurface&#10;                    )&#10;                    Text(&#10;                        text = &quot;$virtualizerLevel%&quot;,&#10;                        style = MaterialTheme.typography.bodySmall,&#10;                        color = MaterialTheme.colorScheme.onSurface.copy(alpha = 0.7f)&#10;                    )&#10;                }&#10;                &#10;                Slider(&#10;                    value = virtualizerLevel.toFloat(),&#10;                    onValueChange = { onVirtualizerChange(it.toInt()) },&#10;                    valueRange = 0f..100f,&#10;                    modifier = Modifier.fillMaxWidth(),&#10;                    colors = SliderDefaults.colors(&#10;                        thumbColor = MaterialTheme.colorScheme.primary,&#10;                        activeTrackColor = MaterialTheme.colorScheme.primary&#10;                    )&#10;                )&#10;            }&#10;        }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/presentation/src/main/kotlin/com/tinhtx/player/screen/main/HomeScreen.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/presentation/src/main/kotlin/com/tinhtx/player/screen/main/HomeScreen.kt" />
              <option name="updatedContent" value="package com.tinhtx.player.screen.main&#10;&#10;import androidx.compose.foundation.layout.*&#10;import androidx.compose.foundation.lazy.LazyColumn&#10;import androidx.compose.foundation.lazy.items&#10;import androidx.compose.material.icons.Icons&#10;import androidx.compose.material.icons.filled.Search&#10;import androidx.compose.material3.*&#10;import androidx.compose.runtime.*&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.unit.dp&#10;import androidx.hilt.navigation.compose.hiltViewModel&#10;import androidx.lifecycle.compose.collectAsStateWithLifecycle&#10;import com.tinhtx.player.common.Resource&#10;import com.tinhtx.player.component.common.MediaItemCard&#10;import com.tinhtx.player.component.common.PermissionHandler&#10;import com.tinhtx.player.model.MediaItem&#10;&#10;@OptIn(ExperimentalMaterial3Api::class)&#10;@Composable&#10;fun HomeScreen(&#10;    onNavigateToPlayer: (MediaItem) -&gt; Unit,&#10;    onNavigateToSearch: () -&gt; Unit,&#10;    modifier: Modifier = Modifier,&#10;    viewModel: HomeViewModel = hiltViewModel()&#10;) {&#10;    val uiState by viewModel.uiState.collectAsStateWithLifecycle()&#10;    var permissionsGranted by remember { mutableStateOf(false) }&#10;    &#10;    Column(modifier = modifier.fillMaxSize()) {&#10;        // Top App Bar&#10;        TopAppBar(&#10;            title = {&#10;                Text(&#10;                    text = &quot;TinhTX Player&quot;,&#10;                    style = MaterialTheme.typography.titleLarge&#10;                )&#10;            },&#10;            actions = {&#10;                IconButton(onClick = onNavigateToSearch) {&#10;                    Icon(&#10;                        imageVector = Icons.Default.Search,&#10;                        contentDescription = &quot;Search&quot;&#10;                    )&#10;                }&#10;            },&#10;            colors = TopAppBarDefaults.topAppBarColors(&#10;                containerColor = MaterialTheme.colorScheme.primary,&#10;                titleContentColor = MaterialTheme.colorScheme.onPrimary,&#10;                actionIconContentColor = MaterialTheme.colorScheme.onPrimary&#10;            )&#10;        )&#10;        &#10;        if (!permissionsGranted) {&#10;            PermissionHandler(&#10;                onPermissionsGranted = {&#10;                    permissionsGranted = true&#10;                    viewModel.loadMediaItems()&#10;                },&#10;                onPermissionsDenied = {&#10;                    // Handle permission denied&#10;                }&#10;            )&#10;        } else {&#10;            when (uiState) {&#10;                is HomeUiState.Loading -&gt; {&#10;                    Box(&#10;                        modifier = Modifier.fillMaxSize(),&#10;                        contentAlignment = Alignment.Center&#10;                    ) {&#10;                        CircularProgressIndicator()&#10;                    }&#10;                }&#10;                &#10;                is HomeUiState.Success -&gt; {&#10;                    LazyColumn(&#10;                        modifier = Modifier.fillMaxSize(),&#10;                        contentPadding = PaddingValues(16.dp),&#10;                        verticalArrangement = Arrangement.spacedBy(8.dp)&#10;                    ) {&#10;                        items(uiState.mediaItems) { mediaItem -&gt;&#10;                            MediaItemCard(&#10;                                mediaItem = mediaItem,&#10;                                onClick = onNavigateToPlayer&#10;                            )&#10;                        }&#10;                    }&#10;                }&#10;                &#10;                is HomeUiState.Error -&gt; {&#10;                    Box(&#10;                        modifier = Modifier.fillMaxSize(),&#10;                        contentAlignment = Alignment.Center&#10;                    ) {&#10;                        Text(&#10;                            text = uiState.message,&#10;                            style = MaterialTheme.typography.bodyLarge,&#10;                            color = MaterialTheme.colorScheme.error&#10;                        )&#10;                    }&#10;                }&#10;            }&#10;        }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/presentation/src/main/kotlin/com/tinhtx/player/screen/main/HomeViewModel.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/presentation/src/main/kotlin/com/tinhtx/player/screen/main/HomeViewModel.kt" />
              <option name="updatedContent" value="package com.tinhtx.player.screen.main&#10;&#10;import androidx.lifecycle.ViewModel&#10;import androidx.lifecycle.viewModelScope&#10;import com.tinhtx.player.common.Resource&#10;import com.tinhtx.player.model.MediaItem&#10;import com.tinhtx.player.usecase.GetMediaItemsUseCase&#10;import dagger.hilt.android.lifecycle.HiltViewModel&#10;import kotlinx.coroutines.flow.MutableStateFlow&#10;import kotlinx.coroutines.flow.StateFlow&#10;import kotlinx.coroutines.flow.asStateFlow&#10;import kotlinx.coroutines.launch&#10;import javax.inject.Inject&#10;&#10;@HiltViewModel&#10;class HomeViewModel @Inject constructor(&#10;    private val getMediaItemsUseCase: GetMediaItemsUseCase&#10;) : ViewModel() {&#10;&#10;    private val _uiState = MutableStateFlow&lt;HomeUiState&gt;(HomeUiState.Loading)&#10;    val uiState: StateFlow&lt;HomeUiState&gt; = _uiState.asStateFlow()&#10;&#10;    fun loadMediaItems() {&#10;        viewModelScope.launch {&#10;            getMediaItemsUseCase.getAllMediaItems().collect { resource -&gt;&#10;                _uiState.value = when (resource) {&#10;                    is Resource.Loading -&gt; HomeUiState.Loading&#10;                    is Resource.Success -&gt; {&#10;                        val mediaItems = resource.data ?: emptyList()&#10;                        HomeUiState.Success(mediaItems)&#10;                    }&#10;                    is Resource.Error -&gt; HomeUiState.Error(&#10;                        resource.message ?: &quot;Unknown error occurred&quot;&#10;                    )&#10;                }&#10;            }&#10;        }&#10;    }&#10;&#10;    fun refreshMediaItems() {&#10;        viewModelScope.launch {&#10;            getMediaItemsUseCase.refreshMediaLibrary()&#10;            loadMediaItems()&#10;        }&#10;    }&#10;}&#10;&#10;sealed class HomeUiState {&#10;    object Loading : HomeUiState()&#10;    data class Success(val mediaItems: List&lt;MediaItem&gt;) : HomeUiState()&#10;    data class Error(val message: String) : HomeUiState()&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/presentation/src/main/kotlin/com/tinhtx/player/screen/player/MusicPlayerScreen.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/presentation/src/main/kotlin/com/tinhtx/player/screen/player/MusicPlayerScreen.kt" />
              <option name="updatedContent" value="package com.tinhtx.player.screen.player&#10;&#10;import androidx.compose.foundation.layout.*&#10;import androidx.compose.foundation.shape.RoundedCornerShape&#10;import androidx.compose.material.icons.Icons&#10;import androidx.compose.material.icons.filled.*&#10;import androidx.compose.material3.*&#10;import androidx.compose.runtime.*&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.draw.clip&#10;import androidx.compose.ui.layout.ContentScale&#10;import androidx.compose.ui.text.style.TextAlign&#10;import androidx.compose.ui.text.style.TextOverflow&#10;import androidx.compose.ui.unit.dp&#10;import androidx.hilt.navigation.compose.hiltViewModel&#10;import androidx.lifecycle.compose.collectAsStateWithLifecycle&#10;import coil.compose.AsyncImage&#10;import com.tinhtx.player.common.formatDuration&#10;&#10;@Composable&#10;fun MusicPlayerScreen(&#10;    mediaId: String,&#10;    onNavigateBack: () -&gt; Unit,&#10;    modifier: Modifier = Modifier,&#10;    viewModel: MusicPlayerViewModel = hiltViewModel()&#10;) {&#10;    val uiState by viewModel.uiState.collectAsStateWithLifecycle()&#10;    &#10;    LaunchedEffect(mediaId) {&#10;        viewModel.loadMedia(mediaId)&#10;    }&#10;    &#10;    Column(&#10;        modifier = modifier&#10;            .fillMaxSize()&#10;            .padding(16.dp),&#10;        horizontalAlignment = Alignment.CenterHorizontally&#10;    ) {&#10;        // Back button&#10;        Row(&#10;            modifier = Modifier.fillMaxWidth(),&#10;            horizontalArrangement = Arrangement.Start&#10;        ) {&#10;            IconButton(onClick = onNavigateBack) {&#10;                Icon(&#10;                    imageVector = Icons.Default.ArrowBack,&#10;                    contentDescription = &quot;Back&quot;&#10;                )&#10;            }&#10;        }&#10;        &#10;        Spacer(modifier = Modifier.height(32.dp))&#10;        &#10;        // Album artwork&#10;        AsyncImage(&#10;            model = uiState.currentMedia?.artworkUri,&#10;            contentDescription = &quot;Album artwork&quot;,&#10;            modifier = Modifier&#10;                .size(300.dp)&#10;                .clip(RoundedCornerShape(16.dp)),&#10;            contentScale = ContentScale.Crop&#10;        )&#10;        &#10;        Spacer(modifier = Modifier.height(32.dp))&#10;        &#10;        // Song info&#10;        Column(&#10;            horizontalAlignment = Alignment.CenterHorizontally&#10;        ) {&#10;            Text(&#10;                text = uiState.currentMedia?.title ?: &quot;&quot;,&#10;                style = MaterialTheme.typography.titleLarge,&#10;                textAlign = TextAlign.Center,&#10;                maxLines = 2,&#10;                overflow = TextOverflow.Ellipsis&#10;            )&#10;            &#10;            Text(&#10;                text = uiState.currentMedia?.artist ?: &quot;&quot;,&#10;                style = MaterialTheme.typography.titleMedium,&#10;                color = MaterialTheme.colorScheme.onSurface.copy(alpha = 0.7f),&#10;                textAlign = TextAlign.Center,&#10;                maxLines = 1,&#10;                overflow = TextOverflow.Ellipsis&#10;            )&#10;        }&#10;        &#10;        Spacer(modifier = Modifier.height(32.dp))&#10;        &#10;        // Progress bar&#10;        Column {&#10;            Slider(&#10;                value = uiState.currentPosition.toFloat(),&#10;                onValueChange = { viewModel.seekTo(it.toLong()) },&#10;                valueRange = 0f..(uiState.currentMedia?.duration?.toFloat() ?: 0f),&#10;                modifier = Modifier.fillMaxWidth()&#10;            )&#10;            &#10;            Row(&#10;                modifier = Modifier.fillMaxWidth(),&#10;                horizontalArrangement = Arrangement.SpaceBetween&#10;            ) {&#10;                Text(&#10;                    text = uiState.currentPosition.formatDuration(),&#10;                    style = MaterialTheme.typography.bodySmall&#10;                )&#10;                Text(&#10;                    text = (uiState.currentMedia?.duration ?: 0L).formatDuration(),&#10;                    style = MaterialTheme.typography.bodySmall&#10;                )&#10;            }&#10;        }&#10;        &#10;        Spacer(modifier = Modifier.height(32.dp))&#10;        &#10;        // Control buttons&#10;        Row(&#10;            horizontalArrangement = Arrangement.spacedBy(16.dp),&#10;            verticalAlignment = Alignment.CenterVertically&#10;        ) {&#10;            IconButton(onClick = { viewModel.skipToPrevious() }) {&#10;                Icon(&#10;                    imageVector = Icons.Default.SkipPrevious,&#10;                    contentDescription = &quot;Previous&quot;,&#10;                    modifier = Modifier.size(32.dp)&#10;                )&#10;            }&#10;            &#10;            FloatingActionButton(&#10;                onClick = { viewModel.togglePlayPause() },&#10;                modifier = Modifier.size(64.dp)&#10;            ) {&#10;                Icon(&#10;                    imageVector = if (uiState.isPlaying) Icons.Default.Pause else Icons.Default.PlayArrow,&#10;                    contentDescription = if (uiState.isPlaying) &quot;Pause&quot; else &quot;Play&quot;,&#10;                    modifier = Modifier.size(32.dp)&#10;                )&#10;            }&#10;            &#10;            IconButton(onClick = { viewModel.skipToNext() }) {&#10;                Icon(&#10;                    imageVector = Icons.Default.SkipNext,&#10;                    contentDescription = &quot;Next&quot;,&#10;                    modifier = Modifier.size(32.dp)&#10;                )&#10;            }&#10;        }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/presentation/src/main/kotlin/com/tinhtx/player/screen/player/MusicPlayerViewModel.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/presentation/src/main/kotlin/com/tinhtx/player/screen/player/MusicPlayerViewModel.kt" />
              <option name="updatedContent" value="package com.tinhtx.player.screen.player&#10;&#10;import androidx.lifecycle.ViewModel&#10;import androidx.lifecycle.viewModelScope&#10;import com.tinhtx.player.model.MediaItem&#10;import com.tinhtx.player.usecase.GetMediaItemsUseCase&#10;import com.tinhtx.player.usecase.PlayMediaUseCase&#10;import dagger.hilt.android.lifecycle.HiltViewModel&#10;import kotlinx.coroutines.flow.MutableStateFlow&#10;import kotlinx.coroutines.flow.StateFlow&#10;import kotlinx.coroutines.flow.asStateFlow&#10;import kotlinx.coroutines.launch&#10;import javax.inject.Inject&#10;&#10;@HiltViewModel&#10;class MusicPlayerViewModel @Inject constructor(&#10;    private val getMediaItemsUseCase: GetMediaItemsUseCase,&#10;    private val playMediaUseCase: PlayMediaUseCase&#10;) : ViewModel() {&#10;&#10;    private val _uiState = MutableStateFlow(MusicPlayerUiState())&#10;    val uiState: StateFlow&lt;MusicPlayerUiState&gt; = _uiState.asStateFlow()&#10;&#10;    fun loadMedia(mediaId: String) {&#10;        viewModelScope.launch {&#10;            getMediaItemsUseCase.getMediaItemById(mediaId).collect { resource -&gt;&#10;                resource.data?.let { mediaItem -&gt;&#10;                    _uiState.value = _uiState.value.copy(currentMedia = mediaItem)&#10;                }&#10;            }&#10;        }&#10;    }&#10;&#10;    fun togglePlayPause() {&#10;        viewModelScope.launch {&#10;            val currentMedia = _uiState.value.currentMedia ?: return@launch&#10;            &#10;            if (_uiState.value.isPlaying) {&#10;                playMediaUseCase.pauseMedia()&#10;                _uiState.value = _uiState.value.copy(isPlaying = false)&#10;            } else {&#10;                playMediaUseCase.playMedia(currentMedia)&#10;                _uiState.value = _uiState.value.copy(isPlaying = true)&#10;            }&#10;        }&#10;    }&#10;&#10;    fun seekTo(position: Long) {&#10;        viewModelScope.launch {&#10;            playMediaUseCase.seekTo(position)&#10;            _uiState.value = _uiState.value.copy(currentPosition = position)&#10;        }&#10;    }&#10;&#10;    fun skipToNext() {&#10;        viewModelScope.launch {&#10;            playMediaUseCase.skipToNext()&#10;        }&#10;    }&#10;&#10;    fun skipToPrevious() {&#10;        viewModelScope.launch {&#10;            playMediaUseCase.skipToPrevious()&#10;        }&#10;    }&#10;}&#10;&#10;data class MusicPlayerUiState(&#10;    val currentMedia: MediaItem? = null,&#10;    val isPlaying: Boolean = false,&#10;    val currentPosition: Long = 0L,&#10;    val bufferedPosition: Long = 0L&#10;)" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/presentation/src/main/kotlin/com/tinhtx/player/screen/player/VideoPlayerScreen.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/presentation/src/main/kotlin/com/tinhtx/player/screen/player/VideoPlayerScreen.kt" />
              <option name="updatedContent" value="package com.tinhtx.player.screen.player&#10;&#10;import androidx.compose.foundation.background&#10;import androidx.compose.foundation.layout.*&#10;import androidx.compose.material.icons.Icons&#10;import androidx.compose.material.icons.filled.*&#10;import androidx.compose.material3.*&#10;import androidx.compose.runtime.*&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.graphics.Color&#10;import androidx.compose.ui.platform.LocalConfiguration&#10;import androidx.compose.ui.unit.dp&#10;import androidx.compose.ui.viewinterop.AndroidView&#10;import androidx.hilt.navigation.compose.hiltViewModel&#10;import androidx.lifecycle.compose.collectAsStateWithLifecycle&#10;import androidx.media3.ui.PlayerView&#10;&#10;@Composable&#10;fun VideoPlayerScreen(&#10;    mediaId: String,&#10;    onNavigateBack: () -&gt; Unit,&#10;    modifier: Modifier = Modifier,&#10;    viewModel: VideoPlayerViewModel = hiltViewModel()&#10;) {&#10;    val uiState by viewModel.uiState.collectAsStateWithLifecycle()&#10;    val configuration = LocalConfiguration.current&#10;    val isLandscape = configuration.orientation == android.content.res.Configuration.ORIENTATION_LANDSCAPE&#10;    &#10;    LaunchedEffect(mediaId) {&#10;        viewModel.loadVideo(mediaId)&#10;    }&#10;    &#10;    Box(&#10;        modifier = modifier&#10;            .fillMaxSize()&#10;            .background(Color.Black)&#10;    ) {&#10;        // Video player view&#10;        AndroidView(&#10;            factory = { context -&gt;&#10;                PlayerView(context).apply {&#10;                    useController = !isLandscape&#10;                    player = viewModel.exoPlayer&#10;                }&#10;            },&#10;            modifier = Modifier.fillMaxSize()&#10;        )&#10;        &#10;        // Custom controls overlay (only in landscape)&#10;        if (isLandscape) {&#10;            VideoControls(&#10;                isPlaying = uiState.isPlaying,&#10;                currentPosition = uiState.currentPosition,&#10;                duration = uiState.currentVideo?.duration ?: 0L,&#10;                onPlayPause = { viewModel.togglePlayPause() },&#10;                onSeek = { viewModel.seekTo(it) },&#10;                onBack = onNavigateBack,&#10;                modifier = Modifier.align(Alignment.BottomCenter)&#10;            )&#10;        } else {&#10;            // Portrait mode back button&#10;            IconButton(&#10;                onClick = onNavigateBack,&#10;                modifier = Modifier&#10;                    .align(Alignment.TopStart)&#10;                    .padding(16.dp)&#10;            ) {&#10;                Icon(&#10;                    imageVector = Icons.Default.ArrowBack,&#10;                    contentDescription = &quot;Back&quot;,&#10;                    tint = Color.White&#10;                )&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun VideoControls(&#10;    isPlaying: Boolean,&#10;    currentPosition: Long,&#10;    duration: Long,&#10;    onPlayPause: () -&gt; Unit,&#10;    onSeek: (Long) -&gt; Unit,&#10;    onBack: () -&gt; Unit,&#10;    modifier: Modifier = Modifier&#10;) {&#10;    Column(&#10;        modifier = modifier&#10;            .fillMaxWidth()&#10;            .background(Color.Black.copy(alpha = 0.7f))&#10;            .padding(16.dp)&#10;    ) {&#10;        // Progress bar&#10;        Slider(&#10;            value = currentPosition.toFloat(),&#10;            onValueChange = { onSeek(it.toLong()) },&#10;            valueRange = 0f..duration.toFloat(),&#10;            modifier = Modifier.fillMaxWidth(),&#10;            colors = SliderDefaults.colors(&#10;                thumbColor = Color.White,&#10;                activeTrackColor = Color.White&#10;            )&#10;        )&#10;        &#10;        // Control buttons&#10;        Row(&#10;            modifier = Modifier.fillMaxWidth(),&#10;            horizontalArrangement = Arrangement.SpaceBetween,&#10;            verticalAlignment = Alignment.CenterVertically&#10;        ) {&#10;            IconButton(onClick = onBack) {&#10;                Icon(&#10;                    imageVector = Icons.Default.ArrowBack,&#10;                    contentDescription = &quot;Back&quot;,&#10;                    tint = Color.White&#10;                )&#10;            }&#10;            &#10;            IconButton(onClick = onPlayPause) {&#10;                Icon(&#10;                    imageVector = if (isPlaying) Icons.Default.Pause else Icons.Default.PlayArrow,&#10;                    contentDescription = if (isPlaying) &quot;Pause&quot; else &quot;Play&quot;,&#10;                    tint = Color.White,&#10;                    modifier = Modifier.size(32.dp)&#10;                )&#10;            }&#10;            &#10;            Spacer(modifier = Modifier.width(48.dp)) // Balance the layout&#10;        }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/presentation/src/main/kotlin/com/tinhtx/player/screen/player/VideoPlayerViewModel.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/presentation/src/main/kotlin/com/tinhtx/player/screen/player/VideoPlayerViewModel.kt" />
              <option name="updatedContent" value="package com.tinhtx.player.screen.player&#10;&#10;import androidx.lifecycle.ViewModel&#10;import androidx.lifecycle.viewModelScope&#10;import androidx.media3.exoplayer.ExoPlayer&#10;import com.tinhtx.player.model.MediaItem&#10;import com.tinhtx.player.usecase.GetMediaItemsUseCase&#10;import com.tinhtx.player.usecase.PlayMediaUseCase&#10;import dagger.hilt.android.lifecycle.HiltViewModel&#10;import kotlinx.coroutines.flow.MutableStateFlow&#10;import kotlinx.coroutines.flow.StateFlow&#10;import kotlinx.coroutines.flow.asStateFlow&#10;import kotlinx.coroutines.launch&#10;import javax.inject.Inject&#10;&#10;@HiltViewModel&#10;class VideoPlayerViewModel @Inject constructor(&#10;    private val getMediaItemsUseCase: GetMediaItemsUseCase,&#10;    private val playMediaUseCase: PlayMediaUseCase,&#10;    val exoPlayer: ExoPlayer&#10;) : ViewModel() {&#10;&#10;    private val _uiState = MutableStateFlow(VideoPlayerUiState())&#10;    val uiState: StateFlow&lt;VideoPlayerUiState&gt; = _uiState.asStateFlow()&#10;&#10;    fun loadVideo(mediaId: String) {&#10;        viewModelScope.launch {&#10;            getMediaItemsUseCase.getMediaItemById(mediaId).collect { resource -&gt;&#10;                resource.data?.let { mediaItem -&gt;&#10;                    _uiState.value = _uiState.value.copy(currentVideo = mediaItem)&#10;                    // Load video into ExoPlayer&#10;                    playMediaUseCase.playMedia(mediaItem)&#10;                }&#10;            }&#10;        }&#10;    }&#10;&#10;    fun togglePlayPause() {&#10;        viewModelScope.launch {&#10;            if (_uiState.value.isPlaying) {&#10;                playMediaUseCase.pauseMedia()&#10;                _uiState.value = _uiState.value.copy(isPlaying = false)&#10;            } else {&#10;                val currentVideo = _uiState.value.currentVideo ?: return@launch&#10;                playMediaUseCase.playMedia(currentVideo)&#10;                _uiState.value = _uiState.value.copy(isPlaying = true)&#10;            }&#10;        }&#10;    }&#10;&#10;    fun seekTo(position: Long) {&#10;        viewModelScope.launch {&#10;            playMediaUseCase.seekTo(position)&#10;            _uiState.value = _uiState.value.copy(currentPosition = position)&#10;        }&#10;    }&#10;&#10;    override fun onCleared() {&#10;        super.onCleared()&#10;        exoPlayer.release()&#10;    }&#10;}&#10;&#10;data class VideoPlayerUiState(&#10;    val currentVideo: MediaItem? = null,&#10;    val isPlaying: Boolean = false,&#10;    val currentPosition: Long = 0L,&#10;    val bufferedPosition: Long = 0L&#10;)" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/presentation/src/main/kotlin/com/tinhtx/player/theme/Color.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/presentation/src/main/kotlin/com/tinhtx/player/theme/Color.kt" />
              <option name="updatedContent" value="package com.tinhtx.player.theme&#10;&#10;import androidx.compose.ui.graphics.Color&#10;&#10;val Purple80 = Color(0xFFD0BCFF)&#10;val PurpleGrey80 = Color(0xFFCCC2DC)&#10;val Pink80 = Color(0xFFEFB8C8)&#10;&#10;val Purple40 = Color(0xFF6650a4)&#10;val PurpleGrey40 = Color(0xFF625b71)&#10;val Pink40 = Color(0xFF7D5260)&#10;&#10;// Custom colors for music player&#10;val PlayerPrimary = Color(0xFF1DB954)&#10;val PlayerSecondary = Color(0xFF1ED760)&#10;val PlayerBackground = Color(0xFF121212)&#10;val PlayerSurface = Color(0xFF181818)&#10;val PlayerOnSurface = Color(0xFFFFFFFF)&#10;val PlayerAccent = Color(0xFFFF6B35)&#10;&#10;// Dark theme colors&#10;val DarkPrimary = Color(0xFF1DB954)&#10;val DarkOnPrimary = Color(0xFF000000)&#10;val DarkSecondary = Color(0xFF1ED760)&#10;val DarkBackground = Color(0xFF121212)&#10;val DarkSurface = Color(0xFF181818)&#10;val DarkOnSurface = Color(0xFFFFFFFF)&#10;&#10;// Light theme colors&#10;val LightPrimary = Color(0xFF1DB954)&#10;val LightOnPrimary = Color(0xFFFFFFFF)&#10;val LightSecondary = Color(0xFF1ED760)&#10;val LightBackground = Color(0xFFFFFFFF)&#10;val LightSurface = Color(0xFFF5F5F5)&#10;val LightOnSurface = Color(0xFF000000)" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/presentation/src/main/kotlin/com/tinhtx/player/theme/Shape.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/presentation/src/main/kotlin/com/tinhtx/player/theme/Shape.kt" />
              <option name="updatedContent" value="package com.tinhtx.player.theme&#10;&#10;import androidx.compose.foundation.shape.RoundedCornerShape&#10;import androidx.compose.material3.Shapes&#10;import androidx.compose.ui.unit.dp&#10;&#10;val Shapes = Shapes(&#10;    small = RoundedCornerShape(4.dp),&#10;    medium = RoundedCornerShape(8.dp),&#10;    large = RoundedCornerShape(16.dp),&#10;    extraLarge = RoundedCornerShape(24.dp)&#10;)" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/presentation/src/main/kotlin/com/tinhtx/player/theme/Theme.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/presentation/src/main/kotlin/com/tinhtx/player/theme/Theme.kt" />
              <option name="updatedContent" value="package com.tinhtx.player.theme&#10;&#10;import android.app.Activity&#10;import android.os.Build&#10;import androidx.compose.foundation.isSystemInDarkTheme&#10;import androidx.compose.material3.MaterialTheme&#10;import androidx.compose.material3.darkColorScheme&#10;import androidx.compose.material3.dynamicDarkColorScheme&#10;import androidx.compose.material3.dynamicLightColorScheme&#10;import androidx.compose.material3.lightColorScheme&#10;import androidx.compose.runtime.Composable&#10;import androidx.compose.runtime.SideEffect&#10;import androidx.compose.ui.graphics.toArgb&#10;import androidx.compose.ui.platform.LocalContext&#10;import androidx.compose.ui.platform.LocalView&#10;import androidx.core.view.WindowCompat&#10;&#10;private val DarkColorScheme = darkColorScheme(&#10;    primary = DarkPrimary,&#10;    onPrimary = DarkOnPrimary,&#10;    secondary = DarkSecondary,&#10;    background = DarkBackground,&#10;    surface = DarkSurface,&#10;    onSurface = DarkOnSurface&#10;)&#10;&#10;private val LightColorScheme = lightColorScheme(&#10;    primary = LightPrimary,&#10;    onPrimary = LightOnPrimary,&#10;    secondary = LightSecondary,&#10;    background = LightBackground,&#10;    surface = LightSurface,&#10;    onSurface = LightOnSurface&#10;)&#10;&#10;@Composable&#10;fun TinhTXPlayerTheme(&#10;    darkTheme: Boolean = isSystemInDarkTheme(),&#10;    dynamicColor: Boolean = true,&#10;    content: @Composable () -&gt; Unit&#10;) {&#10;    val colorScheme = when {&#10;        dynamicColor &amp;&amp; Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.S -&gt; {&#10;            val context = LocalContext.current&#10;            if (darkTheme) dynamicDarkColorScheme(context) else dynamicLightColorScheme(context)&#10;        }&#10;        darkTheme -&gt; DarkColorScheme&#10;        else -&gt; LightColorScheme&#10;    }&#10;    &#10;    val view = LocalView.current&#10;    if (!view.isInEditMode) {&#10;        SideEffect {&#10;            val window = (view.context as Activity).window&#10;            window.statusBarColor = colorScheme.primary.toArgb()&#10;            WindowCompat.getInsetsController(window, view).isAppearanceLightStatusBars = darkTheme&#10;        }&#10;    }&#10;&#10;    MaterialTheme(&#10;        colorScheme = colorScheme,&#10;        typography = Typography,&#10;        shapes = Shapes,&#10;        content = content&#10;    )&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/presentation/src/main/kotlin/com/tinhtx/player/theme/Type.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/presentation/src/main/kotlin/com/tinhtx/player/theme/Type.kt" />
              <option name="updatedContent" value="package com.tinhtx.player.theme&#10;&#10;import androidx.compose.material3.Typography&#10;import androidx.compose.ui.text.TextStyle&#10;import androidx.compose.ui.text.font.FontFamily&#10;import androidx.compose.ui.text.font.FontWeight&#10;import androidx.compose.ui.unit.sp&#10;&#10;// Set of Material typography styles to start with&#10;val Typography = Typography(&#10;    bodyLarge = TextStyle(&#10;        fontFamily = FontFamily.Default,&#10;        fontWeight = FontWeight.Normal,&#10;        fontSize = 16.sp,&#10;        lineHeight = 24.sp,&#10;        letterSpacing = 0.5.sp&#10;    ),&#10;    titleLarge = TextStyle(&#10;        fontFamily = FontFamily.Default,&#10;        fontWeight = FontWeight.Bold,&#10;        fontSize = 22.sp,&#10;        lineHeight = 28.sp,&#10;        letterSpacing = 0.sp&#10;    ),&#10;    titleMedium = TextStyle(&#10;        fontFamily = FontFamily.Default,&#10;        fontWeight = FontWeight.SemiBold,&#10;        fontSize = 18.sp,&#10;        lineHeight = 24.sp,&#10;        letterSpacing = 0.sp&#10;    ),&#10;    titleSmall = TextStyle(&#10;        fontFamily = FontFamily.Default,&#10;        fontWeight = FontWeight.Medium,&#10;        fontSize = 16.sp,&#10;        lineHeight = 20.sp,&#10;        letterSpacing = 0.1.sp&#10;    ),&#10;    bodyMedium = TextStyle(&#10;        fontFamily = FontFamily.Default,&#10;        fontWeight = FontWeight.Normal,&#10;        fontSize = 14.sp,&#10;        lineHeight = 20.sp,&#10;        letterSpacing = 0.25.sp&#10;    ),&#10;    bodySmall = TextStyle(&#10;        fontFamily = FontFamily.Default,&#10;        fontWeight = FontWeight.Normal,&#10;        fontSize = 12.sp,&#10;        lineHeight = 16.sp,&#10;        letterSpacing = 0.4.sp&#10;    ),&#10;    labelLarge = TextStyle(&#10;        fontFamily = FontFamily.Default,&#10;        fontWeight = FontWeight.Medium,&#10;        fontSize = 14.sp,&#10;        lineHeight = 20.sp,&#10;        letterSpacing = 0.1.sp&#10;    )&#10;)" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>